
      INTEGER :: NSYMCALL=0
      LOGICAL CHANGEDE, EXCHANGEACCEPT, EXCHANGE, FLAG 
      LOGICAL CHIRALFAIL,AMIDEFAIL,GOODSTRUCTURE, LOGDUMMY, DISTOK, ATOMINGROUP(NATOMS)
      CHARACTER FNAME*9
      CHARACTER (LEN= 3)  ISTR
      CHARACTER (LEN=20) QUENCHNUM, QUNAME, DUMMYCHAR

      COMMON /MYPOT/ POTEL
      COMMON /TOT/ NQTOT
      COMMON /Q4C/ QSTART, QFINISH
    
!  EPREV saves the previous energy in the Markov chain.
!  EBEST and JBEST record the lowest energy since the last reseeding and the
!  step it was attained at. BESTCOORDS contains the corresponding coordinates.

      ! subroutine
      INTEGER NSTEPS
      DOUBLE PRECISION :: SCALEFAC, SCREENC(NATOMS,3)
      ! local
      INTEGER NFAIL, NFAILT, NSUCCESS, NSUCCESST, NQTOT
      INTEGER ITERATIONS,JACCPREV,BRUN,QDONE,JBEST,NDONE,NRMS,I,J,NTOT,ISTAT
      DOUBLE PRECISION, DIMENSION(NATOMS,3) ::  GRAD,SAVECOORDS,BESTCOORDS,TEMPCOORDS,RCOORDS,RCOORDSO
      DOUBLE PRECISION, DIMENSION(NATOMS) :: RVAT, RVATO
      DOUBLE PRECISION ::       EBEST,RMSD,EPPREV,TIME,ELASTSYM,EPSSAVE,POTEL,DPRAND

      JACCPREV=0
      NQTOT=0

      NSUCCESS=0
      NFAIL=0
      NSUCCESST=0
      NFAILT=0


