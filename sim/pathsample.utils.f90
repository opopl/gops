MODULE UTILS
     IMPLICIT NONE
     CONTAINS

     SUBROUTINE OPENIOSTAT(I,FNAME,SUBRID)
          IMPLICIT NONE
          
          INTEGER,INTENT(IN) :: I
          CHARACTER(LEN=*),INTENT(IN) :: FNAME
          CHARACTER(LEN=*),INTENT(IN),OPTIONAL :: SUBRID

          IF (I/=0) THEN
               PRINT *, 'ERROR WHILE OPENING FILE "'//TRIM(ADJUSTL(FNAME))//'"'
               IF (PRESENT(SUBRID)) PRINT *, 'STOP IN '//TRIM(ADJUSTL(SUBRID))
               STOP
          ENDIF
     END SUBROUTINE OPENIOSTAT
END MODULE UTILS
