!   GMIN: A PROGRAM FOR FINDING GLOBAL MINIMA
!   COPYRIGHT (C) 1999-2006 DAVID J. WALES
!   THIS FILE IS PART OF GMIN.
!
!   GMIN IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
!   IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
!   THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
!   (AT YOUR OPTION) ANY LATER VERSION.
!
!   GMIN IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
!   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
!   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE
!   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.
!
!   YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
!   ALONG WITH THIS PROGRAM; IF NOT, WRITE TO THE FREE SOFTWARE
!   FOUNDATION, INC., 59 TEMPLE PLACE, SUITE 330, BOSTON, MA  02111-1307  USA
!
!  ENERGY AND GRADIENT FOR 1-D STEP LANDSCAPE WITH THREE MINIMA.
!
SUBROUTINE MODEL1(X,V,ENERGY,QE,QX)
USE COMMONS
IMPLICIT NONE
DOUBLE PRECISION ENERGY, X(3*NATOMS), DIST, V(3*NATOMS), QE, QX
DOUBLE PRECISION, PARAMETER :: EDGE=1.0D3
  
VT(1)=0.0D0
IF (X(1).LE.MSTART) THEN
   ENERGY=EDGE
   QE=ME1
   QX=(MBSTART1+MSTART)/2.0D0
ELSEIF (X(1).LE.MBSTART1) THEN
   ENERGY=ME1
   QE=ME1
   QX=(MBSTART1+MSTART)/2.0D0
ELSEIF (X(1).LE.MBFINISH1) THEN
   ENERGY=ME2+MBHEIGHT1
   IF (X(1).LE.(MBFINISH1+MBSTART1)/2.0D0) THEN
      QE=ME1
      QX=(MBSTART1+MSTART)/2.0D0
   ELSE
      QE=ME2
      QX=(MBSTART2+MBFINISH1)/2.0D0
   ENDIF
ELSEIF (X(1).LE.MBSTART2) THEN
   ENERGY=ME2
   QE=ME2
   QX=(MBSTART2+MBFINISH1)/2.0D0
ELSEIF (X(1).LE.MBFINISH2) THEN
   ENERGY=ME3+MBHEIGHT2
   IF (X(1).LE.(MBFINISH1+MBSTART1)/2.0D0) THEN
      QE=ME2
      QX=(MBSTART2+MBFINISH1)/2.0D0
   ELSE
      QE=ME3
      QX=(MFINISH+MBFINISH2)/2.0D0
   ENDIF
ELSEIF (X(1).LE.MFINISH) THEN
   ENERGY=ME3
   QE=ME3
   QX=(MFINISH+MBFINISH2)/2.0D0
ELSE
   ENERGY=EDGE
   QE=ME3
   QX=(MFINISH+MBFINISH2)/2.0D0
ENDIF

! PRINT '(A,4F10.1)','X,E,QE,QX=',X(1),ENERGY,QE,QX

RETURN
END
