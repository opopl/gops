C   GMIN: A program for finding global minima
C   Copyright (C) 1999-2006 David J. Wales
C   This file is part of GMIN.
C
C   GMIN is free software; you can redistribute it and/or modify
C   it under the terms of the GNU General Public License as published by
C   the Free Software Foundation; either version 2 of the License, or
C   (at your option) any later version.
C
C   GMIN is distributed in the hope that it will be useful,
C   but WITHOUT ANY WARRANTY; without even the implied warranty of
C   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
C   GNU General Public License for more details.
C
C   You should have received a copy of the GNU General Public License
C   along with this program; if not, write to the Free Software
C   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
C
      SUBROUTINE WEN(X,GRAD,ENERGY,GTEST,NATOMS)
      IMPLICIT NONE
      INTEGER J1, L, NATOMS
      DOUBLE PRECISION X(3*NATOMS), GRAD(3*NATOMS), ENERGY, XX
      LOGICAL GTEST

      XX=X(1)
      L=3

C     DO J1=1,1001
C        XX=(J1-1)/1000.0D0
      IF (L.EQ.3) THEN
      ENERGY=-1.283802610490316*exp(-4050.000000000000000000000*(-0.9814814814814814814814814814815 + xx)**2) - 
     -  1.184929036002902*exp(-1012.5000000000000000000000*(-0.9444444444444444444444444444444 + xx)**2) - 
     -  0.3798136541956604*exp(-4050.000000000000000000000*(-0.9074074074074074074074074074074 + xx)**2) - 
     -  0.977259343526189*exp(-253.12500000000000000000000*(-0.8333333333333333333333333333333 + xx)**2) - 
     -  1.180861260168487*exp(-4050.000000000000000000000*(-0.7592592592592592592592592592593 + xx)**2) - 
     -  0.937893803251299*exp(-1012.5000000000000000000000*(-0.7222222222222222222222222222222 + xx)**2) - 
     -  1.604371723402417*exp(-4050.000000000000000000000*(-0.6851851851851851851851851851852 + xx)**2) - 
     -  0.6686926778600344*exp(-63.28125000000000000000000*
     -     (-0.50000000000000000000000000000000 + xx)**2) - 
     -  1.474711840240298*exp(-4050.000000000000000000000*(-0.31481481481481481481481481481481 + xx)**2) - 
     -  1.46021450483741*exp(-1012.5000000000000000000000*(-0.27777777777777777777777777777778 + xx)**2) - 
     -  1.12428930296268*exp(-4050.000000000000000000000*(-0.24074074074074074074074074074074 + xx)**2) - 
     -  1.038999840358682*exp(-253.12500000000000000000000*
     -     (-0.16666666666666666666666666666667 + xx)**2) - 
     -  0.2455062092445232*exp(-4050.000000000000000000000*
     -     (-0.09259259259259259259259259259259 + xx)**2) - 
     -  0.1947409222328628*exp(-1012.5000000000000000000000*
     -     (-0.055555555555555555555555555555556 + xx)**2) - 
     -  1.892751965408141*exp(-4050.000000000000000000000*(-0.018518518518518518518518518518519 + xx)**2)
      IF (GTEST) GRAD(1)=10398.80114497156*(-0.9814814814814814814814815 + xx)*
     -   exp(-4050.000000000000000000000*(-0.9814814814814814814814814814815 + xx)**2) + 
     -  2399.481297905877*(-0.9444444444444444444444444 + xx)*
     -   exp(-1012.5000000000000000000000*(-0.9444444444444444444444444444444 + xx)**2) + 
     -  3076.490598984849*(-0.9074074074074074074074074 + xx)*
     -   exp(-4050.000000000000000000000*(-0.9074074074074074074074074074074 + xx)**2) + 
     -  494.7375426601332*(-0.8333333333333333333333333 + xx)*
     -   exp(-253.12500000000000000000000*(-0.8333333333333333333333333333333 + xx)**2) + 
     -  9564.97620736475*(-0.7592592592592592592592593 + xx)*
     -   exp(-4050.000000000000000000000*(-0.7592592592592592592592592592593 + xx)**2) + 
     -  1899.234951583881*(-0.7222222222222222222222222 + xx)*
     -   exp(-1012.5000000000000000000000*(-0.7222222222222222222222222222222 + xx)**2) + 
     -  12995.41095955958*(-0.6851851851851851851851852 + xx)*
     -   exp(-4050.000000000000000000000*(-0.6851851851851851851851851851852 + xx)**2) + 
     -  84.6314170416606*(-0.5000000000000000000000000 + xx)*
     -   exp(-63.28125000000000000000000*(-0.50000000000000000000000000000000 + xx)**2) + 
     -  11945.16590594641*(-0.31481481481481481481481481 + xx)*
     -   exp(-4050.000000000000000000000*(-0.31481481481481481481481481481481 + xx)**2) + 
     -  2956.934372295755*(-0.27777777777777777777777778 + xx)*
     -   exp(-1012.5000000000000000000000*(-0.27777777777777777777777777777778 + xx)**2) + 
     -  9106.74335399771*(-0.24074074074074074074074074 + xx)*
     -   exp(-4050.000000000000000000000*(-0.24074074074074074074074074074074 + xx)**2) + 
     -  525.9936691815831*(-0.16666666666666666666666667 + xx)*
     -   exp(-253.12500000000000000000000*(-0.16666666666666666666666666666667 + xx)**2) + 
     -  1988.600294880638*(-0.09259259259259259259259259 + xx)*
     -   exp(-4050.000000000000000000000*(-0.09259259259259259259259259259259 + xx)**2) + 
     -  394.3503675215473*(-0.05555555555555555555555556 + xx)*
     -   exp(-1012.5000000000000000000000*(-0.055555555555555555555555555555556 + xx)**2) + 
     -  15331.29091980594*(-0.018518518518518518518518519 + xx)*
     -   exp(-4050.000000000000000000000*(-0.018518518518518518518518518518519 + xx)**2)
      ELSE
         ENERGY=-0.4568496173259325*exp(-12800.*(-0.993827160493827 + xx)**2) - 
     -  1.283802610490316*exp(-3200.*(-0.981481481481482 + xx)**2) - 
     -  1.184929036002902*exp(-800.*(-0.944444444444444 + xx)**2) - 
     -  0.815312591540615*exp(-12800.*(-0.919753086419753 + xx)**2) - 
     -  0.3798136541956604*exp(-3200.*(-0.907407407407407 + xx)**2) - 
     -  0.3771912596603463*exp(-12800.*(-0.895061728395062 + xx)**2) - 
     -  2.025061170320328*exp(-12800.*(-0.845679012345679 + xx)**2) - 
     -  0.977259343526189*exp(-200.*(-0.833333333333333 + xx)**2) - 
     -  2.308301236080467*exp(-12800.*(-0.7716049382716049 + xx)**2) - 
     -  1.180861260168487*exp(-3200.*(-0.7592592592592593 + xx)**2) - 
     -  1.049113987900484*exp(-12800.*(-0.7469135802469136 + xx)**2) - 
     -  0.937893803251299*exp(-800.*(-0.7222222222222222 + xx)**2) - 
     -  0.6554915053490677*exp(-12800.*(-0.6975308641975308 + xx)**2) - 
     -  1.604371723402417*exp(-3200.*(-0.6851851851851852 + xx)**2) - 
     -  0.6814739506491945*exp(-12800.*(-0.6728395061728394 + xx)**2) - 
     -  0.6686926778600344*exp(-50.*(-0.5 + xx)**2) - 
     -  1.775604641405055*exp(-12800.*(-0.3271604938271605 + xx)**2) - 
     -  1.474711840240298*exp(-3200.*(-0.3148148148148148 + xx)**2) - 
     -  0.6370043011010363*exp(-12800.*(-0.3024691358024691 + xx)**2) - 
     -  1.46021450483741*exp(-800.*(-0.2777777777777777 + xx)**2) - 
     -  2.288041988405792*exp(-12800.*(-0.2530864197530864 + xx)**2) - 
     -  1.12428930296268*exp(-3200.*(-0.2407407407407407 + xx)**2) - 
     -  2.308192391333468*exp(-12800.*(-0.228395061728395 + xx)**2) - 
     -  1.038999840358682*exp(-200.*(-0.1666666666666666 + xx)**2) - 
     -  2.086024179616805*exp(-12800.*(-0.1049382716049382 + xx)**2) - 
     -  0.2455062092445232*exp(-3200.*(-0.0925925925925926 + xx)**2) - 
     -  0.3919346929879097*exp(-12800.*(-0.0802469135802469 + xx)**2) - 
     -  0.1947409222328628*exp(-800.*(-0.05555555555555555 + xx)**2) - 
     -  2.042799775544758*exp(-12800.*(-0.03086419753086419 + xx)**2) - 
     -  1.892751965408141*exp(-3200.*(-0.01851851851851851 + xx)**2) - 
     -  1.366109767411788*exp(-12800.*(-0.006172839506172839 + xx)**2)
      IF (GTEST) GRAD(1)=11695.35020354387*(-0.993827160493827 + xx)*exp(-12800.*(-0.993827160493827 + xx)**2) + 
     -  8216.33670713803*(-0.981481481481482 + xx)*exp(-3200.*(-0.981481481481482 + xx)**2) + 
     -  1895.886457604644*(-0.944444444444444 + xx)*exp(-800.*(-0.944444444444444 + xx)**2) + 
     -  20872.00234343973*(-0.919753086419753 + xx)*exp(-12800.*(-0.919753086419753 + xx)**2) + 
     -  2430.807386852226*(-0.907407407407407 + xx)*exp(-3200.*(-0.907407407407407 + xx)**2) + 
     -  9656.09624730486*(-0.895061728395062 + xx)*exp(-12800.*(-0.895061728395062 + xx)**2) + 
     -  51841.56596020041*(-0.845679012345679 + xx)*exp(-12800.*(-0.845679012345679 + xx)**2) + 
     -  390.9037374104756*(-0.833333333333333 + xx)*exp(-200.*(-0.833333333333333 + xx)**2) + 
     -  59092.51164365999*(-0.7716049382716049 + xx)*exp(-12800.*(-0.7716049382716049 + xx)**2) + 
     -  7557.512065078322*(-0.7592592592592593 + xx)*exp(-3200.*(-0.7592592592592593 + xx)**2) + 
     -  26857.31809025239*(-0.7469135802469136 + xx)*exp(-12800.*(-0.7469135802469136 + xx)**2) + 
     -  1500.630085202079*(-0.7222222222222222 + xx)*exp(-800.*(-0.7222222222222222 + xx)**2) + 
     -  16780.58253693613*(-0.6975308641975308 + xx)*exp(-12800.*(-0.6975308641975308 + xx)**2) + 
     -  10267.97902977547*(-0.6851851851851852 + xx)*exp(-3200.*(-0.6851851851851852 + xx)**2) + 
     -  17445.73313661938*(-0.6728395061728394 + xx)*exp(-12800.*(-0.6728395061728394 + xx)**2) + 
     -  66.86926778600344*(-0.5 + xx)*exp(-50.*(-0.5 + xx)**2) + 
     -  45455.47881996943*(-0.3271604938271605 + xx)*exp(-12800.*(-0.3271604938271605 + xx)**2) + 
     -  9438.15577753791*(-0.3148148148148148 + xx)*exp(-3200.*(-0.3148148148148148 + xx)**2) + 
     -  16307.31010818653*(-0.3024691358024691 + xx)*exp(-12800.*(-0.3024691358024691 + xx)**2) + 
     -  2336.343207739856*(-0.2777777777777777 + xx)*exp(-800.*(-0.2777777777777777 + xx)**2) + 
     -  58573.87490318829*(-0.2530864197530864 + xx)*exp(-12800.*(-0.2530864197530864 + xx)**2) + 
     -  7195.451538961156*(-0.2407407407407407 + xx)*exp(-3200.*(-0.2407407407407407 + xx)**2) + 
     -  59089.72521813679*(-0.228395061728395 + xx)*exp(-12800.*(-0.228395061728395 + xx)**2) + 
     -  415.5999361434731*(-0.1666666666666666 + xx)*exp(-200.*(-0.1666666666666666 + xx)**2) + 
     -  53402.2189981902*(-0.1049382716049382 + xx)*exp(-12800.*(-0.1049382716049382 + xx)**2) + 
     -  1571.239739164948*(-0.0925925925925926 + xx)*exp(-3200.*(-0.0925925925925926 + xx)**2) + 
     -  10033.52814049048*(-0.0802469135802469 + xx)*exp(-12800.*(-0.0802469135802469 + xx)**2) + 
     -  311.5854755725806*(-0.05555555555555555 + xx)*exp(-800.*(-0.05555555555555555 + xx)**2) + 
     -  52295.67425394582*(-0.03086419753086419 + xx)*exp(-12800.*(-0.03086419753086419 + xx)**2) + 
     -  12113.6125786121*(-0.01851851851851851 + xx)*exp(-3200.*(-0.01851851851851851 + xx)**2) + 
     -  34972.41004574178*(-0.006172839506172839 + xx)*exp(-12800.*(-0.006172839506172839 + xx)**2)
      ENDIF
C     WRITE(*,'(A,3F20.10)') 'XX,ENERGY,GRAD=',XX,ENERGY,GRAD(1)
C     ENDDO
C     STOP

      RETURN
      END 
