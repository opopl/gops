      MODULE AMHGLOBALS
      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD ARRAYSIZE.INC INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

        IMPLICIT NONE
        SAVE

C     MAXSIZ IS THE MAXIMUM NUMBER OF AMINO ACID RESIDUES

         INTEGER MAXSIZ
         PARAMETER (MAXSIZ=80)

C     MAXCNT IS THE MAXIMUM NUMBER OF (I,J)
C     INTERACTIONS

        INTEGER MAXCNT
        PARAMETER(MAXCNT=(MAXSIZ**2-MAXSIZ)/2)
C       PARAMETER(MAXCNT=31250)
C       PARAMETER(MAXCNT=7022)
        INTEGER MAX_WELL
        PARAMETER(MAX_WELL=10)

      INTEGER MAX_LETTERS
      PARAMETER (MAX_LETTERS=21)

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD HEAD INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

      INTEGER MAXMEM
      PARAMETER(MAXMEM=40)

      INTEGER MAXPRO
      PARAMETER(MAXPRO=1)

C     MAXRES IS THE MAXIMUM NUMBER OF AMINO ACID RESIDUES
C     FOR A DATABASE PROTEIN

      INTEGER MAXRES
      PARAMETER(MAXRES=650)

C     MAXCRD IS THE MAXIMUM NUMBER OF COORDINATE TYPES;

      INTEGER MAXCRD
      PARAMETER(MAXCRD=3)

C     MAXTAB IS THE MAXIMUM NUMBER OF TABLES, I.E.,
C     THE NUMBER OF PAIRWISE IXNS;

      INTEGER MAXTAB
      PARAMETER(MAXTAB=4)

C     MULTIPLE SEQ  + PARTIAL CONSTRAINING
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

      LOGICAL CYCLIC,SS_A,SS_B
      INTEGER NUM_FOLDON_A,NUM_FOLDON_B,CONST_MODE, TOTALSSNORM
      INTEGER FOLDSTRT_MIN_A(MAXRES),FOLDSTRT_MAX_A(MAXRES)
      INTEGER FOLDSTRT_MIN_B(MAXRES),FOLDSTRT_MAX_B(MAXRES)
      INTEGER SS_PATTERN_A(MAXRES), SS_PATTERN_B(MAXRES)
!         INTEGER SS_ALPHA(MAXRES), SS_BETA(MAXRES)
!         INTEGER SA_ALPHA(MAXRES), SA_BETA(MAXRES)
 
      DOUBLE PRECISION SS_DIST(500,500,MAXTAB)

C     SWITCH FOR AVERAGING FORCE TABLE OVER SEQUENCES

      LOGICAL AVE_SEQ,TARG_CONS, MEM_CONS,AVE_SEQ_HB
      LOGICAL SSWEIGHT,AVE_SEQ_AMW, AVE_SEQ_AMC
      INTEGER MAXSEQ,NUMSEQ,NUMSEQ_HB,NUMSEQ_AMW
      INTEGER NUMSEQ_AMC
      PARAMETER (MAXSEQ=2)
      
      INTEGER TGSEQUENCES(MAXRES,MAXSEQ)
      INTEGER TGSEQUENCES_HB(MAXRES,MAXSEQ)
      INTEGER TGSEQUENCES_AMW(MAXRES,MAXSEQ)
      INTEGER TGSEQUENCES_AMC(MAXRES,MAXSEQ)

      DOUBLE PRECISION APS(MAXRES,MAXRES)

       CHARACTER HOMLFL(MAXSEQ)*5
CCCC  MCP

      DOUBLE PRECISION X_INT(MAXRES*3*3)
      DOUBLE PRECISION X_MCP(MAXRES*3*3) 
      DOUBLE PRECISION E_TEMP, E_HARM_SPRINGS

CCCC   GO CONTACT

      LOGICAL GO_CON
      DOUBLE PRECISION    GO_CON_DIST

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD ADDITIONS INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

      LOGICAL ALPHA_C_OF_N,AB_C_OF_N_OLD,AB_C_OF_N_NEW,QUENCH
      LOGICAL BETA_C_OF_N,DIST_CUT
      INTEGER NQUENCH

C     OXSCL IS SCALING CONSTANT FOR OXYGEN POTENTIAL

      DOUBLE PRECISION OXSCL

C     HBSCL IS THE SCALE FACTOR FOR HBONDS

        DOUBLE PRECISION HBSCL(17)
        DOUBLE PRECISION SIGMA_H,SIGMA_NO,HO_ZERO,NO_ZERO
        DOUBLE PRECISION :: ANTI_NHB(20,20,2),ANTI_HB(20,20,2),
     *                  PARA_HB(20,20,2),PARA_ONE(20),ANTI_ONE(20)

C     LAMDAR IS A SCALE FACTOR FOR INCORRECT 
C     MEMORIES

        DOUBLE PRECISION LAMBDAR

C     CHRLSCL IS THE SCALING PARAMETER FOR CHIRAL FORCES

      DOUBLE PRECISION CHRLSCL

C     SCALING PARAMETERS FOR RAMACHONDRIAN PLOTS

      DOUBLE PRECISION RAMASCL

C     SCALING PARAMETERS FOR OXYGEN EXCLUDED VOLUME

      DOUBLE PRECISION OEXCLDSCL

C     C-C EXCLUDED VOLUME DISTANCE ARRAY

      DOUBLE PRECISION CCEV_DIST(1:MAXCNT,1:MAXTAB),OOEV_DIST(1:MAXCNT)

C       FLAG FOR SEC-SETRUC DEPENDENDENT GAMMA IS SS CLASS

        LOGICAL FOUR_PLUS
C     OTHER FLAGS CONTROLLING ENCODING USED
C     I_IGNORE_CHAIN_DIRN SAYS ENCODING DOESN'T DEPEND ON CHAIN DIRECTION 
C     MISMATCH SAYS ENCODING DOESN'T DEPEND ON WHAT MEMORY PROTEIN PAIR
C     IS IF THE IDENTITIES ARE NOT IDENTICAL TO THE TARGET PAIR (IE THEY ARE MISMATCHED)

        LOGICAL I_IGNORE_CHAIN_DIRN,MISMATCH

C     FLAG AND SCLE FACTOR FOR BIASING THE  FUNNEL
C TEMP OLD 
!      LOGICAL I_QBIAS,I_BIAS_NATIVE
!      INTEGER N_QBIAS,I_Q_FORMAT
!      DOUBLE PRECISION QBIASPOLY(1:100),
!      DOUBLE PRECISION          WIDTH_QEXP,Q0,Q_WEIGHT,Q_CLIP
!      INTEGER N_Q_ANNEAL


      INTEGER N_DIVS_MAX
      PARAMETER (N_DIVS_MAX=1000)
      LOGICAL IBIASGAUSS,IBIASPOLY,I_QBIAS_A,I_BIAS_NATIVE_A
      LOGICAL CON_LOCAL_A, CON_LOCAL_B
      INTEGER CON_LOCAL_A_CUT, CON_LOCAL_B_CUT
      INTEGER NBIASPOLY,N_QBIAS_A,I_Q_FORMAT_A
      DOUBLE PRECISION BIAS_WEIGHT,BIAS_AV,BIAS_VAR,BIAS_PREFACTOR,
     *           BIASPOLY(1:100),QBIASPOLY_A(1:100),
     *           WIDTH_QEXP_A,Q0_A,Q_WEIGHT_A,Q_CLIP_A,
     *           Q0_SAFE_A, Q0_SAFE_B,
     *           Q0_INC_A,Q0_INC_B,QVALUE_A,QVALUE_B
      INTEGER N_Q_ANNEAL_A,N_Q_ANNEAL_B

       DOUBLE PRECISION DEL_R_A(1:MAXSIZ),
     *           Q_IJ_A(0:N_DIVS_MAX,MAXSIZ),
     *          DQ_DR_IJ_A(1:N_DIVS_MAX,1:MAXSIZ)

      LOGICAL I_QBIAS_B,I_BIAS_NATIVE_B
      INTEGER N_QBIAS_B,I_Q_FORMAT_B
      DOUBLE PRECISION   QBIASPOLY_B(1:100)
      DOUBLE PRECISION        WIDTH_QEXP_B, Q0_B,Q_WEIGHT_B,Q_CLIP_B

      INTEGER SEGLIST_A(MAXRES), SEGLIST_B(MAXRES),
     *        NUMCONST_A,I_IXN_QBIAS_B(MAXRES,MAXRES),
     *        NUMCONST_B,I_IXN_QBIAS_A(MAXRES,MAXRES)

       DOUBLE PRECISION DEL_R_B(1:MAXSIZ),
     *           Q_IJ_B(0:N_DIVS_MAX,MAXSIZ),
     *          DQ_DR_IJ_B(1:N_DIVS_MAX,1:MAXSIZ)

C     FLAG AND PARAMETERS FOR |I-J| DEPENDENT 'CONTACT ORDER' INTERACTION
      LOGICAL I_CONTACT_ORDER
      INTEGER N_CONTACT_ORDER_TERMS
      INTEGER, PARAMETER:: MAX_CONTACT_ORDER_TERMS=5
      INTEGER I_CONTACT_ORDER_MIN(MAX_CONTACT_ORDER_TERMS),
     *        I_CONTACT_ORDER_MAX(MAX_CONTACT_ORDER_TERMS)
      DOUBLE PRECISION R_MIN_CONTACT_ORDER(MAX_CONTACT_ORDER_TERMS),
     *     R_MAX_CONTACT_ORDER(MAX_CONTACT_ORDER_TERMS)
      DOUBLE PRECISION GAMMA_CONTACT_ORDER(MAX_CONTACT_ORDER_TERMS,3)
C     GAP, 03/23/04, THE MINIMUM SEPARATION + 1 FOR THE INTERACTIONS IN THE CONTACT CLASS
      INTEGER, PARAMETER:: CUTOFF_CONT_LOW=13

C     FLAG AND PARAMETERS FOR RADIUS OF GYRATION FORCE

      LOGICAL I_RG_COREY
      DOUBLE PRECISION RG_BOUNDS(2)
      LOGICAL I_RG_BIAS
      INTEGER N_RG_BIAS
      DOUBLE PRECISION RG_BIASPOLY(1:100)
      DOUBLE PRECISION RG_SHIFT
      DOUBLE PRECISION RG_SCL

      LOGICAL I_RG_GARYK, I_RG_FIRST
      DOUBLE PRECISION D_RG, T_RG, DELR_RG, M_RG, KAPPA_RG

      DOUBLE PRECISION TARG_DIST(MAXCNT,MAXTAB)
!      DOUBLE PRECISION DQ_DR_IJ(1:N_DIVS_MAX,1:MAXSIZ)
!    E DOUBLE PRECISION DEL_R(1:MAXSIZ), Q_IJ(0:N_DIVS_MAX,MAXSIZ)

      DOUBLE PRECISION NGOMB
      LOGICAL IGOMB

C ISCLTAB IS SWITCH FOR SCLTAB SUBROUTINE
      LOGICAL ISCLTAB
C ICLASSWEIGHT ALLOWS (RATHER SNEAKY) SCALING OF GAMMAS BY CLASS
      LOGICAL ICLASSWEIGHT

C SOME VARIABLES FOR NON-ADDITIVE CONTACT POTENTIAL

      LOGICAL :: I_NON_ADD_CONTACT
      INTEGER, PARAMETER:: NGAMMA_NON_ADD=32
      INTEGER CLASS_OF_RES_2(MAXSIZ),SORT_NON_ADD(2,2,2,2,2),
     *   CLASS_2(20)
      DOUBLE PRECISION :: GAMMA_NON_ADD(NGAMMA_NON_ADD)

C VARIABLES FOR PARALLEL/ANTI-PARALLEL CONTACT POTENTIAL

      LOGICAL:: I_CON_P_AP
      INTEGER:: I_DIFF_P_AP,I_ATOM_P_AP
       DOUBLE PRECISION :: WEIGHT_P_AP(3),R_CUT_P_AP

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD POTENT INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC


C     PARAMETER FILE FOR POTENTIAL

C     NUMMEM IS THE NUMBER OF PROTEIN MEMORIES 
C     USED IN THE POTENTIAL

      INTEGER NUMMEM

C     NUMPRO IS THE NUMBER OF ENSEMBLE PROTEINS 
 
      INTEGER NUMPRO
C     NMRES IS THE ACTUAL PROTEIN SIZE USED

      INTEGER NMRES

C     I_RAMA IS THE FLAG FOR RAMA POTENTIAL
C     (0=OFF 1=ON (NEW) 2=ON (OLD)

       INTEGER I_RAMA

C     HBOND IS THE HBOND FLAG FOR HBONDS

        LOGICAL HBOND,I_HBOND_EASTWOOD,I_HBOND_CZONG

C     OXEXCLDV IS THE FLAG FOR OXYGEN-OXYGEN EXCLUDED VOLUME

        LOGICAL OXEXCLDV
        DOUBLE PRECISION O_EXVMIN,O_EXVMINS(1:4)   !SEP WHERE O-O EV COMES ON

C     NUMCRD IS THE NUMBER OF COORDINATE TYPES

      INTEGER NUMCRD,NUMTAB

C     CHARGE SWITCHES

      LOGICAL I_ALT_PROX,I_3RD_IS_CONTACT,GLY_CON
      INTEGER N_LETTERS,MIN_SEQ_SEP,NUM_WELL,N_LETTERS_CON
      DOUBLE PRECISION ALT_PROX_CUT

C     MAXR IS THE GRID RESOLUTION OF THE FORCE LOOKUP TABLE

      INTEGER MAXR,MAXS
      PARAMETER(MAXR=400)

C     SRPLR IS  REL WEIGHTS OF SHORT-MED-LONG RANGE ENERGY IF ICLASSWEIGHT=TRUE

      DOUBLE PRECISION SRPLR(3)

C     ERES IS THE TARGET ENERGY/RESIDUE

      DOUBLE PRECISION ERES

C     MINMR AND MAXMR PARTITION THE PROTEIN
C     INTO SHORT- MED- AND LONG-RANGE IXNS
C     THE MEDIUM RANGE CLASS GOES FROM MINMR--MAXMR INCLUSIVE

      INTEGER MINMR,MAXMR

C     DELTA IS USED IN DETERMINING THE RANGE
C     OF THE UPPER AND LOWER BOUNDS FOR THE MEMORY
C     DISTANCES (THE SQUARE-WELL HALF WIDTH)

      DOUBLE PRECISION DELTA,DELTE

C     RCUT IS THE MAXIMUM IXN DISTANCE
C     SR CUT IS DIVISION BETWEEN SR/LR INTS (IN SPACE) 

      DOUBLE PRECISION RCUT,RCUTAMH,SRCUT

C     IF IEXCLD, THEN TURN ON EXCLUDED-VOLUME PENALTY

      LOGICAL IEXCLD

      LOGICAL IEXCLD_GAMMA,IEXCLD_BETA
      INTEGER I_TYPE_EV_GAMMA
      DOUBLE PRECISION PEXCLD_GAMMA
      DOUBLE PRECISION EXVMIN_GAMMA(MAXSIZ,MAXSIZ)
      DOUBLE PRECISION C_OF_M_DIST(MAXSIZ)

C     REXCLD IS THE MINIMUM ALLOWED DISTANCE 
C     BETWEEN RESIDUES
C     PEXCLD IS THE PENALTY ASSOCIATED W/ VIOLATING THE SELF-
C     AVOIDING CUTOFF, REXCLD

      DOUBLE PRECISION PEXCLD

C     EXVMIN IS WHERE C-C EXCLUDED VOL STARTS (IN ANGSTROMS)
C     AND EXVMINS IS WHERE C-C EXCLUDED VOL STARTS (IN ANGSTROMS) FOR |I-J|<5

      DOUBLE PRECISION EXVMIN,EXVMINS,EXVMINS_BETA(1:4)

C     IF WELSCL, THEN SCALE WELL-WIDTHS BY |I-J|;
C     OTHERWISE, SCALE BY RIJ

      LOGICAL WELSCL

C     MAXSEC IS THE MAXIMUM NUMBER OF SECONDARY
C     STRUCTURES OF ANY GIVEN TYPE FOR A GIVEN PROTEIN

      INTEGER MAXSEC
      PARAMETER(MAXSEC=30)

C     MAXMOV IS THE MAXIMUM NUMBER OF QUENCH STRUCTURES

      INTEGER MAXMOV
      PARAMETER(MAXMOV=1)

C     TIMSTP IS THE TIMESTEP FOR THE VERLET ALGORITHM

      DOUBLE PRECISION TIMSTP

C     TOLSHK IS THE MAXIMUM DEVIATION ALLOWED FOR EACH CONSTRAINT

      DOUBLE PRECISION TOLSHK

C PROTEIN NAME  PROTNM
      CHARACTER PROTNM(0:MAXMEM)*6

C     FLAGS FOR RANDOM INTERACTIONS

      LOGICAL RAN_FORCE,RAN_FILE,ALLOW_NEG
      DOUBLE PRECISION  R_RAN,S_RAN
      INTEGER RAN_MIN_SEQ_DIST

      INTEGER ILONG(MAXCNT,2,MAXTAB),
     *        NUMLNG(0:MAXSIZ,MAXTAB),IRES(MAXSIZ),
     *        SA(MAXRES),
     *        TARPRE(MAXRES,MAXTAB),MEMPRE(MAXRES,MAXTAB),
     *        JRES(MAXRES),
     *        CRDIXN(MAXTAB,2)

      INTEGER IXN_FROM_SITE(MAXSIZ,MAXSIZ,MAXTAB)

 
      DOUBLE PRECISION VPOTNT(0:MAXR+1,MAXCNT,MAXTAB),
     *     AMH_GSE,
     *     RINC(MAXCNT,MAXTAB),
     *     RINCINV(MAXCNT,MAXTAB),
     *     RINCSQ(MAXCNT,MAXTAB),
     *     FORSE(0:MAXR+1,MAXCNT,MAXTAB),
     *     DELTZ(MAXCNT,MAXTAB),SHYDRO(MAXRES,2,MAXTAB),
     *     YWORK(MAXRES,3,MAXCRD),
     *     HYDSEQ(MAXRES,2,MAXTAB),
     *     QCHRG(21,21,20,20,MAX_WELL+2),
     *     QCHRG2(21,21,20,20,2,2)

C++ JOHAN
!          DOUBLE PRECISION ALTGAMMA(20,20,MAX_WELL)
C-- JOHAN
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD UTILITY INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

C        CHARACTER*10 NAME_A(100000)

C     INCLUDE FILE FOR SEEDS,
C     INPUT_AMH-OUTPUT FILES, DO LOOP

C     --- WORK SPACE ---

      INTEGER IWORK(MAXCNT)

      DOUBLE PRECISION WORK1(MAXCNT),WORK2(MAXCNT),WORK3(MAXCNT),
     *     WORK4(MAXCNT),WORK6(MAXCNT),WORK8(MAXCNT)

C     --- I/O TAPES ---

      INTEGER IMEMRI,IPROLST,IPROLSTSCL,IRAN,OARCHV,OCONV,OECORR,IMAT,
     *        ISS_BIAS,IHBOND,IMOVIEIN,IGAMMA,ITARGSEQS,IHOMOL,
     *        OMOVI,OMOVISEG,SO,INPUT_AMH,IEVGAMMA,IEVBETA,ICON,IMEM_CONS,
     *        OHDRGN,ORAMA,OOXY,OCHIRAL,OAMH,OREP,
     *        OAMHSR,OAMHLR,ORAN,OCCEV,OOEV,OAMHMR,
     *        OBIAS_RG,OKE,IBIASFILE,OHDRGN_S,
     *        OHDRGN_M,OHDRGN_L,OHDRGN_SEQ,ONONADD,OCON_P_AP,PDB,
     *        OPE_PLUS_KE,OPE_NO_BIAS,OPE_WITH_BIAS,OPE_BACKBONE,OPE_BACKBONE_NORAMA,
     *        OOBIASSEGA,OOBIASSEGB,OHARMSPRING,
     *        OVGASPOT,OVSCLTAB,IPHI,ICONTACTS,
     *        ISS_STRUCT,ITARG_SEQ

C     --- SEEDS ---

C     ISEED_AMH(4) ARE THE SEEDS USED FOR THE RANDOM NUMBER GENERATORS

      INTEGER ISEED_AMH(4)

C     --- DO LOOP INDICIES ---

      INTEGER I502,I503,I505,I507,
     *        I508,I509,I511,I512,I513,I514,I515,
     *        I516,I518,I521,I523,I525,I526,I527,I528,
     *        I540
C     --- IMPLIED DO LOOP INDICIES ---

      INTEGER I1,I2

C     --- DIAGNOSTIC FLAGS ---

      LOGICAL IDIGNS

C     --- AMINO ACID ABBREVIATIONS --

      CHARACTER AMINOA(21)*3

      DOUBLE PRECISION HYDSCL(0:21,2),HRDRAD(0:21,2),EQDIST(5)

C     SET UP MAPPING FROM SEQUENCE ID TO AMINO ACID RESIDUE

      DATA (AMINOA(I1),I1=1,21)/'ALA','ARG','ASN','ASP',
     *                          'CYS','GLN','GLU','GLY',
     *                          'HIS','ILE','LEU','LYS',
     *                          'MET','PHE','PRO','SER',
     *                          'THR','TRP','TYR','VAL',
     *                          'INI'/

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC             OLD PARAM.S INCLUDE FILE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

C     INCMOV IS THE INCREMENT FOR THE NUMBER OF 
C     STRUCTURES TO BE SAVED FIXED T

      INTEGER INCMOV

C     NMDIF IS GREATER THAN MXTEMP/INCMOV

      INTEGER NMDIF
      PARAMETER(NMDIF=2001)

C     T1-T5 ARE THE CUTOFF POINTS IN THE TEMPERATURE-ANNEALING
C     SCHEDULE

      DOUBLE PRECISION T1,T2,T3,T4,T5
 
C     IT1-IT5 ARE THEN NUMBER OF T GRID POINTS ALLOCATED TO EACH
C     OF THE INTERVALS [T1,T2], [T2,T3],...

      INTEGER IT1,IT2,IT3,IT4,IT5

C     MXTEMP IS THE NUMBER OF TEMPERATURE GRID POINTS

      INTEGER MXTEMP,NMTEMP
      PARAMETER(MXTEMP=12001)

      INTEGER NMSTEP

C     SET HIERARCHY PARAMETERS:

C     MXLEVL IS THE MAXIMUM NUMBER OF HIERARCHY LEVELS
C     MXSCT IS THE MAXIMUM NUMBER OF DIVISIONS PER LEVEL       

      INTEGER MXLEVL,MXSCT
      PARAMETER(MXLEVL=5,MXSCT=5)

C     LENFUN IS THE MAXIMUM PROTEIN SEGMENT LENGTH 
C     CONSIDERED PER LEVEL

      INTEGER LENFUN
      PARAMETER(LENFUN=155)

C     IF ICTEMP, THEN THE MINIMIZATION IS PERFORMED AT A 
C     CONSTANT TEMPERATURE, CTEMP

      LOGICAL ICTEMP
      DOUBLE PRECISION CTEMP

!     IF I_V_TEST PRINT OUT TEST POTENTIALS BETWEEN 2 SITES
!     IN GASPOT, AND AGAIN IN SCLTAB

      LOGICAL I_V_TEST
      INTEGER TEST_SITE(2)

C     IF IRESRT, THEN READ IN PREVIOUSLY GENERATED
C     PROTEINS USED FOR RESTARTING PROGRAM OR ANALYSIS

      LOGICAL IRESRT



C     IF MOVANAL, THEN ANALYSE MOVIE STRUCTURES ONLY

      LOGICAL MOVANAL

      LOGICAL KNOWN

C     I_ETIM=T IF WANT TO OUTPUT ENERGIES EVERY I_ETIM_STEP TIMESTEPS
      LOGICAL I_ETIM
      INTEGER I_ETIM_STEP


      INTEGER ITGRD(4)
 
      DOUBLE PRECISION TEMTUR(MXTEMP),TEMTUR_QUENCH(MAXMOV,MAXMOV),TEMGRD(5),
     *     BONDLN(MAXSIZ,MAXCRD),TARGET(MAXSIZ,3,MAXCRD),
     *     PRCORD(MAXSIZ,3,MAXPRO,MAXCRD),
     *     ZRCORD(MAXSIZ,3,MAXPRO,MAXCRD),
     *     AVEP(MAXPRO,2,50),
     *     QUENCH_CRD(MAXSIZ,3,MAXPRO,MAXCRD,MAXMOV)

      DOUBLE PRECISION AVEPP(MAXPRO,2,50)

! DISTANCE CUT-OFFS FOR CONTACT POTENTIAL
! R(1) IS CLOSEST RANGE WELL
      DOUBLE PRECISION R_MIN(1:MAX_WELL),R_MAX(1:MAX_WELL)

! VARIABLES FOR REPLICA FORCE

      LOGICAL I_REP,I_REP_LAMBDA_UNIFORM
      DOUBLE PRECISION REP_PHI_EXP(MAXSIZ),REP_LAMBDA(MAXSIZ),
     *   REP_CUT_OFF,REP_TOL
      INTEGER N_REP_CON(MAXSIZ),REP_CON_2_RES(MAXSIZ,MAXSIZ)

      END MODULE AMHGLOBALS
