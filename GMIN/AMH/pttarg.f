
C     --------------------- PTTARG ----------------------
 
      SUBROUTINE PTTARG(MAXSIZ,NMRES,NUMCRD,TARGET,
     *                  MAXRES,YWORK,IRES,JRES,SHYDRO,
     *                  HYDSEQ,TARPRE,MEMPRE,BONDLN,
     *                  OARCHV,PASSI)

C     ---------------------------------------------------

C     PTTARG COPIES THE TARGET COORDINATES, CODED 
C            SEQUENCE, HYDROPHOBICITY PROFILE
C            SECONDARY STRUCTURE PREDICTIONS INTO
C            ARRAYS RESERVED FOR TARGET; THE NEAREST-
C            NEIGHBOR DISTANCES BETWEEN ALPHA-CARBONS
C            AND THE DISTANCE BETWEEN THE ALPHA- AND
C            BETA-CARBON OF THE SAME RESIDUE ARE 
C            ALSO COMPUTED

C     ARGUMENTS:

C        MAXSIZ- MAXIMUM NUMBER OF PROTEIN RESIDUES (I)
C        NMRES - ACTUAL NUMBER OF RESIDUES (I)
C        NUMCRD- NUMBER OF COORDINATE TYPES (I)
C        TARGET- TARGET PROTEIN COORDINATES (O)
C        MAXRES- MAXIMUM PROTEIN DATABASE LENGTH (I)
C        YWORK - TARGET COORDINATES (I)
C        IRES  - TARGET CODED SEQUENCE (O)
C        JRES  - TARGET CODED SEQUENCE (I)
C        SHYDRO- TARGET HYDROPHOBICITY PROFILE (O)
C        HYDSEQ- TARGET HYDROPHOBICITY PROFILE (I)
C        TARPRE- TARGET SECONDARY STRUCTURE PROFILE (O)
C        MEMPRE- TARGET SECONDARY STRUCTURE PROFILE (I)
C        BONDLN- BOND LENGHTS FOR TARGET COORDINATES;
C                BOND I IS THE BOND BETWEEN RESIDUES I-1
C                AND I (O)
C        OARCHV- ARCHIVE/DIAGNOSTIC OUTPUT FILE (I)
C        PASSI - TRUE ON FIRST CALL TO PTTARG (I)

C     ---------------------------------------------------

C     SET REQUIRED PARAMETERS

      IMPLICIT NONE

C     ARGUMENT DECLARATIONS:

         LOGICAL PASSI

         INTEGER MAXSIZ,NMRES,IRES(MAXSIZ),JRES(MAXSIZ),
     *           TARPRE(MAXSIZ),MEMPRE(MAXSIZ),OARCHV,NUMCRD,MAXRES

         DOUBLE PRECISION TARGET(MAXSIZ,3,NUMCRD),HYDSEQ(MAXRES,2),
     *      YWORK(MAXRES,3,NUMCRD),SHYDRO(MAXSIZ,2),BONDLN(MAXSIZ,NUMCRD)

C     INTERNAL VARIABLES:

         INTEGER INDX1,INDX2,INDX3,INDX4,ISUM,IISUM

C        --- DO LOOP INDICES ---

         INTEGER I1,I500,I_COORD,I_AXIS,I_RES,I505,I510,I511

C     --------------------- BEGIN -----------------------

C     --- DIAGNOSTICS ---

C     ECHO SCALAR INPUT ARGUMENTS

C      WRITE(OARCHV,100)MAXSIZ,NMRES
C  100 FORMAT('PTTARG:MAXSIZ ',I3,' NMRES ',I3)

C     --- END DIAGNOSTICS ---

C     COPY COORDINATES,

      DO 502 I_COORD=1,NUMCRD
         DO 503 I_AXIS=1,3
            DO 504 I_RES=1,NMRES
               TARGET(I_RES,I_AXIS,I_COORD)=YWORK(I_RES,I_AXIS,I_COORD)
  504       CONTINUE
  503    CONTINUE
  502 CONTINUE

C     COPY CODED SEQUENCE, H PROFILE AND
C     SECONDARY STRUCTURE PROFILE

      DO 500 I500=1,NMRES

         IRES(I500)=JRES(I500)
         SHYDRO(I500,1)=HYDSEQ(I500,1)
         SHYDRO(I500,2)=HYDSEQ(I500,2)
         TARPRE(I500)=MEMPRE(I500)

  500 CONTINUE

C     PRINT TARGET H PROFILE

      IF( PASSI )THEN
         INDX2=10
         INDX1=INT( FLOAT(NMRES)/FLOAT(INDX2) ) + 1
C         WRITE(OARCHV,712)
C  712    FORMAT(/'HYDROPHOBICITY PROFILE AND ROW SUM ')
         IISUM=0
         DO 510 I510=1,INDX1
            INDX4=(I510-1)*INDX2 + 1
            IF( INDX1.EQ.I510 )THEN
               INDX3=NMRES
            ELSE
               INDX3=INDX4 + INDX2 - 1
            ENDIF
            ISUM=0
            DO 511 I511=INDX4,INDX3
               ISUM=ISUM + INT(SHYDRO(I511,1))
  511       CONTINUE
            IISUM=IISUM + ISUM
C            WRITE(OARCHV,711)(INT(SHYDRO(I1,1)),I1=INDX4,INDX3),
C     *                        ISUM
  711       FORMAT(11(I3,1X))
  510    CONTINUE
C         WRITE(OARCHV,713)IISUM
C  713    FORMAT('NET H ',I3)
      ENDIF

C     --- DIAGNOSTICS ---

C     ECHO H PROFILE AND CODED PRIMARY SEQUENCE

C      WRITE(OARCHV,107)PROT,NMRES
C  107 FORMAT(/'TARGET ',A4,' RESIDUES ',I3)
C      DO 504 I_RES=1,NMRS
C         WRITE(OARCHV,108)I_RES,HYDSCL(IRES(I_RES)),
C     *                    (SHYDRO(I_RES,I1),I1=1,2)
C  108    FORMAT(I3,3(1X,F7.2))
C  504 CONTINUE

C     --- END DIAGNOSTICS ---

C      SET BOND LENGTHS FOR ALPHA(I+1)-ALPHA(I) AND
C      ALPHA(I)-BETA(I)

      DO 505 I505=1,NMRES
             BONDLN(I505,1)=3.8004D0
             BONDLN(I505,2)=1.54D0
             BONDLN(I505,3)=2.42677D0
  505 CONTINUE
      BONDLN(1,1)=0.0D0

C     SET GLYCINE ALPHA-BETA BOND

      DO 512 I_RES=1,NMRES
         IF( JRES(I_RES).EQ.8 )
     *      BONDLN(I_RES,2)=0.0D0
  512 CONTINUE

C     --- DIAGNOSTICS ---
C
C      IF( PASSI )THEN
C         WRITE(OARCHV,110)
C  110    FORMAT(/'PTTARG:SITE      BONDLN',22X,
C     *           'COORDINATES')
C         DO 509 I509=1,MIN(NMRES,109)
C
C            WRITE(OARCHV,109)I509,BONDLN(I509,1),
C     *                       (TARGET(I509,I1,1),I1=1,3)
C  109       FORMAT(/8X,I3,1X,4(1X,1PE10.3))
C
C            WRITE(OARCHV,111)BONDLN(I509,2),
C     *                       (TARGET(I509,I1,2),I1=1,3)
C  111       FORMAT(12X,4(1X,1PE10.3))
C  509    CONTINUE
C      ENDIF
C
C     --- END DIAGNOSTICS ---

C     ---------------------- DONE -----------------------

      RETURN
      END
