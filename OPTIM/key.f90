MODULE KEY
      IMPLICIT NONE
      SAVE


      INTEGER :: NSUMMARY, NADM, MSTEPS, BFGSSTEPS, NSTEPS, NVALUES, NVECTORS, EFSTEPS, NFREEZE, HINDEX, &
     &        FIXAFTER, NBOXTS, NREPELTS, REPELFROM, BHSTEPS, BHSTEPSMIN, KADJUSTFRQ, GUPTATYPE, &
     &        NDIIA, NINTV, NGRADIENTS, NZERO, NPOWER, NBFGSMAX1, NBFGSMAX2, MNBFGSMAX1, MNBFGSMAX2, PVSTEPS, &
     &        NEVL, NEVS, NHCHECK, NHUP=0, NSTHUP, INTHUP, XMUL, NSTEPMIN, LSYS, MUPDATE, XMUPDATE, &
     &        MMUPDATE, NEBMUPDATE, INTMUPDATE, FILTH, FILTH2, NFAILMAX, NPERMGROUP, GCIMAGE, GCSTEPS, GCUPDATE, GCSEED, &
     &        NUSEEV, PATHSDSTEPS, HMNEVS, HMNEVL, HMNSTEPS, HMNBFGSMAX1, HMNBFGSMAX2, &
     &        BBRM, BBRSTEPS, NORDER, NSECDIAG, STOCKMAXSPIN, BISECTSTEPS, BISECTMAXATTEMPTS, NEBRESEEDINT, NREPULSIVE, &
     &        NNREPULSIVE, NEBRESEEDPOW1, NEBRESEEDPOW2, NCONSTRAINT, NENDHESS, ACKLANDID, RBATOMSMAX, &
     &        TIPID, PAHID, NCARBON, NTSITES, NRBGROUP, INTIMAGE, DUMPINTXYZFREQ, DUMPINTEOSFREQ, &
     &        NRBTRIES, REDOTSIM, REDOBFGSSTEPS, RPIMAGES, RPDOF, SDOXYGEN, SDHYDROGEN, SDCHARGE, BOWMANPES, &
     &        INTCONSEP, PATOM1, PATOM2, INTREPSEP, NCONSTRAINTON, CPREPSEP, CPCONSEP, &
     &        NCPREPULSIVE, NCPCONSTRAINT, MAXCONUSE, INTCONSTEPS, INTRELSTEPS, INTSTEPS1, INTLJSTEPS, &
     &        NTRAPPOW, MAXINTIMAGE

      LOGICAL :: DTEST, MASST, RTEST, EFSTEPST, VECTORST, SUMMARYT, DUMPV, FREEZE, GRADSQ, &
     &        PGRAD, VALUEST, ADMT, BFGSMINT, BFGSTST, CHECKINDEX, TOSI, CONTAINER, DEBUG, &
     &        GAUSSIAN, CADPAC, PRESSURE, FTEST, DCHECK, CP2K, DFTP, CPMD, CPMDC, FREEZERES, DF1T, &
     &        VARIABLES, FIELDT, OHT, IHT, TDT, D5HT, TWOENDS, PV, FRACTIONAL, BLNT, HYBRIDMINT, &
     &        INDEXT, LANCZOST, NOSHIFT, GAMESSUS, GAMESSUK, PVTS, RIGIDBODY, CASTEP, ONETEP, &
     &        BFGSSTEP, BULKT, HUPDATE, NOHESS, READV, NOIT, THOMSONT, SIO2T, SIO2C6T, BISECTT, BISECTDEBUG, &
     &        TOSIC6, TOSIPOL, FIXIMAGE, DFTBT, CHECKCONT, SHIFTED, READSP, DUMPSP, NOFRQS, &
     &        ALLSTEPS, ALLVECTORS, MWVECTORS, WELCH, BINARY, AMBER, READHESS, MOVIE, NORESET, TWOD, &
     &        DOUBLET, REOPT, PARALLEL, LINEMIN, FIXD, KEEPINDEX, BSMIN, PRINTPTS, RKMIN, REPELTST,&
     &        REPEL,UNRST, NATBT, ANGLEAXIS, DUMPALLPATHS, GOT, REOPTIMISEENDPOINTS, DUMPDATAT, MORPHT, PERMDIST, &
     &        GREATCIRCLET, DESMDEBUG, GROWSTRINGT, FREEZENODEST, STOCKT, BHINTERPT, BHDEBUG, CHRIGIDT, PERMDISTINIT, &
     &        BBRSDMT, AMBERT, NABT, DUMPSTRUCTURES, ORDERPARAMT, BHINTERPUSELOWEST, STOCKSPIN, LOWESTFRQT, &
     &        RBAAT, DBPT, DBPTDT, LWOTPT, GBT, GBDT, MSSTOCKT, NCAPT, NTIPT, PAHAT, PATCHYDT, PYGT, RADIFT, UNIAXT, STOCKAAT, &
     &        EFIELDT, BHCHECKENERGYT, REDUCEDBONDLENGTHT, CBT, CLOSESTALIGNMENT, NEBRESEEDT, ADDREPT, INTCONSTRAINTT, &
     &        LOCALPERMDIST, DOCROSSCHECK, REDOKADD, REDOPATH1, REDOPATH2, ANGLEAXIS2, &
     &        RINGPOLYMERT, SDT, BOWMANT, PULLT, RBSYMT, CONPOTT, GRAD4T, RPCYCLICT, RPFIXT, CHECKCONINT, &
     &        QSPCFWT, QTIP4PFT, CFUSIONT, DUMPINTXYZ, DUMPINTEOS, INTLJT, INTTST, EYTRAPT

     LOGICAL :: MACHINE=.FALSE., NEBMIND=.TRUE.

      DOUBLE PRECISION :: TRAD, RESIZE, JZ, PUSHOFF, TOLD, TOLE, PCUT, DAMP, RADIUS, TWOEVAL, PVCONV, PVTOL, &
     &        OMEGA, GALPHA, MALPHA1, FOH, FIH, FTD, FD5H, T12FAC, PRESS, MAXERISE, RK_R, RK_THETA, &
     &        CONVU, CONVR, SYMCUT, MXSTP, GFRACTION, CEIG, REPELPUSH, XMAXERISE, GCCONV, NEBK, &
     &        MFRACTION1, MFRACTION2, MALPHA2, ACCLAN, SHIFTLAN, CUTLAN, GMAX, EVCUT, NEBDGUESS, INTDGUESS,  &
     &        MINMAX, MAXMAX, C6PP, C6MM, C6PM, PUSHCUT, MAXBFGS, MAXXBFGS, MAXMBFGS, MAXNEBBFGS, MAXINTBFGS, &
     &        APP, AMM, APM, XQP,XQM, ALPHAP, ALPHAM, PHIG, SHIFTV, SHIFTL(6), DGUESS, XDGUESS, TIMELIMIT, TSTART, &
     &        INTEPSILON, FRAMEEDIFF, MORPHERISE, MORPHEMAX, MORPHMXSTP, MAXTSENERGY, MAXBARRIER, GCMXSTP, GCSCALE, &
     &        FREEZETOL, DESMAXEJUMP, DESMAXAVGE, STOCKMU, STOCKLAMBDA, EDIFFTOL, GEOMDIFFTOL, DNEBSWITCH, &
     &        BHACCREJ, BHSTEPSIZE, BHCONV, BHTEMP, BHDISTTHRESH, BHMAXENERGY, BHK, DIJKSTRALOCAL, KADJUSTFRAC, KADJUSTTOL, &
     &        BHSFRAC, HMCEIG, HMMXSTP, HMEVMAX, BBRGAM, BBREPS, BBRSIGMA1, BBRSIGMA2, BBRALPHA, BBRCONV, STOCKZTOL, &
     &        GBKAPPA, GBKAPPRM, GBMU, GBNU, GBSIGNOT, GBEPSNOT, GBCHI, GBCHIPRM, &
     &        PYA1(3), PYA2(3), PYSIGNOT, PYEPSNOT, NEBKINITIAL, NEBKFINAL, NEBFACTOR, &
     &        DBEPSBB, DBEPSAB, DBSIGBB, DBSIGAB, DBPMU, MAXMAXBARRIER, &
     &        RHOCC0, RHOCC10, RHOCC20,  RHOHH0, RHOHH10, RHOHH20, RHOCH0, RHOC10H, RHOCH10, RHOC20H, RHOCH20, &
     &        ALPHACC, ALPHAHH, ALPHACH, DC6CC, DC6HH, DC6CH, KKJ, CCKJ,        &
     &        LPDGEOMDIFFTOL, INTCONFRAC, MAXCONE, INTRMSTOL, BFGSTSTOL, &
     &        BISECTMAXENERGY, BISECTMINDIST, BLFACTOR, NEBRESEEDEMAX, NEBRESEEDBMAX, NEBRESEEDDEL1, &
     &        NEBRESEEDDEL2, INTCONSTRAINTTOL, INTCONSTRAINTDEL, RBCUTOFF, INTCONSTRAINTREP, INTCONSTRAINREPCUT, &
     &        REDOK, REDOFRAC, D1INIT, D2INIT, REDOE1, REDOE2, RPBETA, REPCON, PFORCE, &
     &        CPCONSTRAINTTOL, CPCONSTRAINTDEL, CPCONSTRAINTREP, CPCONSTRAINREPCUT, CPCONFRAC, &
     &        INTLJTOL, INTLJDEL, INTLJEPS, IMSEPMIN, IMSEPMAX, TRAPK

!     SF344
      DOUBLE PRECISION :: PCUTOFF,PYA11(3),PYA21(3),PYA12(3),PYA22(3),PEPSILON1(3),PSCALEFAC1(2),PSCALEFAC2(2), &
     &                     PEPSILONATTR(2),PSIGMAATTR(2), PYOVERLAPTHRESH, LJSITECOORDS(3)
 
      DOUBLE PRECISION, ALLOCATABLE :: VT(:), PYA1BIN(:,:),PYA2BIN(:,:)
      LOGICAL          :: LJSITE,BLJSITE,LJSITEATTR,PYBINARYT,PARAMONOVPBCX,PARAMONOVPBCY,PARAMONOVPBCZ,PARAMONOVCUTOFF
      LOGICAL          :: PYGPERIODICT,ELLIPSOIDT,LJSITECOORDST,REALIGNXYZ
      INTEGER          :: MAXINTERACTIONS,PYBINARYTYPE1,MYUNIT
      DOUBLE PRECISION :: GBANISOTROPYR, GBWELLDEPTHR
!     CHRIS
!     MCP
      LOGICAL :: AMHT
      CHARACTER(LEN=3) :: RES_TYPE_ALA='ALA'
      CHARACTER(LEN=5) :: TARFL
      CHARACTER(LEN=120) :: CASTEPJOB, CP2KJOB, ONETEPJOB
      CHARACTER(LEN=5) :: RPSYSTEM

      INTEGER :: SEQ(500),NUMGLY
      DOUBLE PRECISION :: FINCORD(150,3,3,3)
      INTEGER :: NRES_AMH_TEMP 
     
      INTEGER PROCNT, FINNMRSS, FINNUMCRR, FINNUMPRR, FINNQUENCH

      CHARACTER(LEN=80) :: SYS, FILTHSTR, BOWMANDIR
      CHARACTER(LEN=20) :: EDITIT
      CHARACTER(LEN=4) :: NPROC
      CHARACTER(LEN=2) :: HMMETHOD
      CHARACTER(200) :: CPMD_COMMAND
      LOGICAL :: SCORE_QUEUE
      DOUBLE PRECISION :: EFIELD  ! ELECTRIC FIELD, EFIELD, IN THE Z-DIRECTION
      DOUBLE PRECISION :: COLDFUSIONLIMIT

      LOGICAL, ALLOCATABLE, DIMENSION(:) :: FROZEN, FROZENRES  !  MXATMS
      INTEGER, ALLOCATABLE :: NPERMSIZE(:), PERMGROUP(:), ORDERNUM(:)
      INTEGER, ALLOCATABLE :: NSETS(:)
      INTEGER, ALLOCATABLE :: SETS(:,:)
      DOUBLE PRECISION, ALLOCATABLE, DIMENSION(:) :: CHARGE  !  3*MXATMS
      DOUBLE PRECISION, ALLOCATABLE, DIMENSION(:,:) :: REPELTS  !  3*MXATMS,100
      DOUBLE PRECISION ,ALLOCATABLE :: LJREP_BLN(:,:), LJATT_BLN(:,:), A_BLN(:), B_BLN(:), C_BLN(:), D_BLN(:)
      CHARACTER(LEN=1), ALLOCATABLE :: BEADLETTER(:), BLNSSTRUCT(:)
      CHARACTER(LEN=4), ALLOCATABLE :: WHICHORDER(:)
      INTEGER :: NREPMAX=10, NCPREPMAX=10
      INTEGER :: INTCONMAX=10, NCPCONMAX=10
      DOUBLE PRECISION, ALLOCATABLE :: EPSALPHA(:), DISTREF(:)
      DOUBLE PRECISION, ALLOCATABLE :: CPDISTREF(:)
      DOUBLE PRECISION, ALLOCATABLE :: MIN1REDO(:), MIN2REDO(:)
      DOUBLE PRECISION, ALLOCATABLE :: CONDISTREF(:), CONDISTREFLOCAL(:), CONDISTREFON(:), CONDISTREFLOCALON(:)
      DOUBLE PRECISION, ALLOCATABLE :: CPCONDISTREF(:)
      LOGICAL, ALLOCATABLE :: CONACTIVE(:)
      LOGICAL, ALLOCATABLE :: ATOMACTIVE(:)
      INTEGER, ALLOCATABLE :: NITSTART(:)
      DOUBLE PRECISION, ALLOCATABLE :: RPMASSES(:), XMINA(:), XMINB(:)
      DOUBLE PRECISION, ALLOCATABLE :: RBOPS(:,:)
      DOUBLE PRECISION, ALLOCATABLE :: SAVES(:), SAVEF(:)
!     LOGICAL, ALLOCATABLE :: CONTEST(:,:)
      INTEGER, ALLOCATABLE :: ORDERI(:), ORDERJ(:), REPPOW(:)
      INTEGER, ALLOCATABLE :: CONI(:), CONJ(:), CONION(:), CONJON(:)
      INTEGER, ALLOCATABLE :: REPI(:), REPJ(:)
      INTEGER, ALLOCATABLE :: CPCONI(:), CPCONJ(:)
      INTEGER, ALLOCATABLE :: CPREPI(:), CPREPJ(:)
      DOUBLE PRECISION, ALLOCATABLE :: REPCUT(:), NREPCUT(:), CPREPCUT(:)
      INTEGER, ALLOCATABLE :: NREPI(:), NREPJ(:)
      INTEGER, ALLOCATABLE :: BESTPERM(:)
      INTEGER, ALLOCATABLE :: RBGROUP(:), RBNINGROUP(:)
END MODULE KEY
