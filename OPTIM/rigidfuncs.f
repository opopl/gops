C   OPTIM: A PROGRAM FOR OPTIMIZING GEOMETRIES AND CALCULATING REACTION PATHWAYS
C   COPYRIGHT (C) 1999-2006 DAVID J. WALES
C   THIS FILE IS PART OF OPTIM.
C
C   OPTIM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C   IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C   THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C   (AT YOUR OPTION) ANY LATER VERSION.
C
C   OPTIM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
C   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE
C   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C   YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C   ALONG WITH THIS PROGRAM; IF NOT, WRITE TO THE FREE SOFTWARE
C   FOUNDATION, INC., 59 TEMPLE PLACE, SUITE 330, BOSTON, MA  02111-1307  USA
C
C
C DERIVATIVES OF R(I,J) WITH RESPECT TO RIGID BODY COORDINATES OF TWO
C MOLECULES X1,Y1,Z1,N1,L1,M1 AND X2,Y2,Z2,L2,M2,N2.
C P(I) = (P1X,P1Y,P1Z), P(J)=(P2X,P2Y,P2Z) ARE THE SITE CORDINATES IN
C THE REFERENCE GEOMETRY FOR THE MOLECULE AT THE ORIGIN AND RDIST IS THE INVERSE
C ACTUAL DISTANCE BETWEEN THE TWO SITES IN QUESTION.
C
C THIS SHOULD ENABLE RIGID BODY SYSTEMS TO BE CODED IN A
C STRAIGHTFORWARD, SYSTEMATIC WAY.
C

! #######################################################################################################

! WRAPPER FUNCTION FOR THE RIGID BODY FIRST DERIVATIVES
! COORDNO RUNS FROM 1 TO 12, WITH 1 SPECIFYING DRIJ/DX1, 2 SPECIFYING DRIJ/DY1 ETC

      FUNCTION DRIJDXRB(COORDNO,
     1                  P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       IMPLICIT NONE

       DOUBLE PRECISION :: DRIJDXRB
       INTEGER :: COORDNO
       DOUBLE PRECISION :: P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R 
       DOUBLE PRECISION :: C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22

! EXTERNAL FUNCTIONS
       
       DOUBLE PRECISION :: D1,D2,D3,D4,D5,D6,D7,D8,D9,DA,DB,DC

       SELECT CASE (COORDNO)
          CASE (1)
             DRIJDXRB = D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (2)
             DRIJDXRB = D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)      
          CASE (3)
             DRIJDXRB = D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (4)
             DRIJDXRB = D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (5)
             DRIJDXRB = D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             DRIJDXRB = D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             DRIJDXRB = D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             DRIJDXRB = D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             DRIJDXRB = D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             DRIJDXRB = DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             DRIJDXRB = DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             DRIJDXRB = DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE COORDINATE INDEX PASSED TO DRIJDXRB'
             STOP

       END SELECT

       RETURN
            
      END FUNCTION DRIJDXRB

! #######################################################################################################

! WRAPPER FUNCTION FOR THE RIGID BODY SECOND DERIVATIVES
! COORDNO`S RUN FROM 1 TO 12, WITH 1 SPECIFYING DRIJ/DX1, 2 SPECIFYING DRIJ/DY1 ETC

      FUNCTION D2RIJDXRB1DXRB2(COORDNO1,COORDNO2,
     1                    P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       IMPLICIT NONE

       DOUBLE PRECISION :: D2RIJDXRB1DXRB2
       INTEGER :: COORDNO1,COORDNO2
       DOUBLE PRECISION :: P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R 
       DOUBLE PRECISION :: C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22

! LOCAL VARIABLES

       INTEGER :: FIRSTCOORD, SECONDCOORD

! EXTERNAL FUNCTIONS

       DOUBLE PRECISION :: DD11,DD12,DD13,DD14,DD15,DD16,DD17,DD18,DD19,DD1A,DD1B,DD1C
       DOUBLE PRECISION :: DD22,DD23,DD24,DD25,DD26,DD27,DD28,DD29,DD2A,DD2B,DD2C
       DOUBLE PRECISION :: DD33,DD34,DD35,DD36,DD37,DD38,DD39,DD3A,DD3B,DD3C
       DOUBLE PRECISION :: DD44,DD45,DD46,DD47,DD48,DD49,DD4A,DD4B,DD4C      
       DOUBLE PRECISION :: DD55,DD56,DD57,DD58,DD59,DD5A,DD5B,DD5C 
       DOUBLE PRECISION :: DD66,DD67,DD68,DD69,DD6A,DD6B,DD6C
       DOUBLE PRECISION :: DD77,DD78,DD79,DD7A,DD7B,DD7C
       DOUBLE PRECISION :: DD88,DD89,DD8A,DD8B,DD8C
       DOUBLE PRECISION :: DD99,DD9A,DD9B,DD9C
       DOUBLE PRECISION :: DDAA,DDAB,DDAC
       DOUBLE PRECISION :: DDBB,DDBC
       DOUBLE PRECISION :: DDCC

       IF (COORDNO1.GT.COORDNO2) THEN
          FIRSTCOORD = COORDNO2
          SECONDCOORD = COORDNO1
       ELSE
          FIRSTCOORD = COORDNO1
          SECONDCOORD = COORDNO2          
       END IF

       SELECT CASE (FIRSTCOORD)
       CASE (1)
          SELECT CASE (SECONDCOORD)
          CASE (1)   
             D2RIJDXRB1DXRB2 = DD11(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (2)
             D2RIJDXRB1DXRB2 = DD12(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (3)
             D2RIJDXRB1DXRB2 = DD13(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (4)
             D2RIJDXRB1DXRB2 = DD14(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (5)
             D2RIJDXRB1DXRB2 = DD15(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD16(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD17(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD18(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD19(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD1A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD1B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD1C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (2)
          SELECT CASE (SECONDCOORD)
          CASE (2)
             D2RIJDXRB1DXRB2 = DD22(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (3)
             D2RIJDXRB1DXRB2 = DD23(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (4)
             D2RIJDXRB1DXRB2 = DD24(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (5)
             D2RIJDXRB1DXRB2 = DD25(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD26(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD27(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD28(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD29(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD2A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD2B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD2C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT
      
       CASE (3)
          SELECT CASE (SECONDCOORD)
          CASE (3)
             D2RIJDXRB1DXRB2 = DD33(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (4)
             D2RIJDXRB1DXRB2 = DD34(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (5)
             D2RIJDXRB1DXRB2 = DD35(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD36(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD37(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD38(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD39(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD3A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD3B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD3C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (4)
          SELECT CASE (SECONDCOORD)
          CASE (4)
             D2RIJDXRB1DXRB2 = DD44(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (5)
             D2RIJDXRB1DXRB2 = DD45(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD46(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD47(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD48(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD49(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD4A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD4B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD4C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (5)
          SELECT CASE (SECONDCOORD)
          CASE (5)
             D2RIJDXRB1DXRB2 = DD55(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD56(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD57(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD58(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD59(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD5A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD5B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD5C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (6)
          SELECT CASE (SECONDCOORD)
          CASE (6)
             D2RIJDXRB1DXRB2 = DD66(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD67(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD68(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD69(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD6A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD6B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD6C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (7)
          SELECT CASE (SECONDCOORD)
          CASE (7)
             D2RIJDXRB1DXRB2 = DD77(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD78(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD79(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD7A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD7B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD7C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (8)
          SELECT CASE (SECONDCOORD)
          CASE (8)
             D2RIJDXRB1DXRB2 = DD88(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD89(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD8A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD8B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD8C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (9)
          SELECT CASE (SECONDCOORD)
          CASE (9)
             D2RIJDXRB1DXRB2 = DD99(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (10)
             D2RIJDXRB1DXRB2 = DD9A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DD9B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DD9C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (10)
          SELECT CASE (SECONDCOORD)
          CASE (10)
             D2RIJDXRB1DXRB2 = DDAA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (11)
             D2RIJDXRB1DXRB2 = DDAB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DDAC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (11)
          SELECT CASE (SECONDCOORD)
          CASE (11)
             D2RIJDXRB1DXRB2 = DDBB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE (12)
             D2RIJDXRB1DXRB2 = DDBC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE (12)
          SELECT CASE (SECONDCOORD)
          CASE (12)
             D2RIJDXRB1DXRB2 = DDCC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,INV_R,
     1                              C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
          CASE DEFAULT
             PRINT *, 'OUT OF RANGE SECOND COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
             STOP
          END SELECT

       CASE DEFAULT
          PRINT *, 'OUT OF RANGE FIRST COORDINATE INDEX PASSED TO D2RIJDXRB1DXRB2'
          STOP
          
       END SELECT
       
       RETURN
            
      END FUNCTION D2RIJDXRB1DXRB2

! #######################################################################################################

! DRIJ/DX1

      DOUBLE PRECISION FUNCTION D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D1=
     @    RDIST*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + 
     @    M2*P2Z*S2 + X1 - X2)
      
      RETURN
      END

! DRIJ/DY1

      DOUBLE PRECISION FUNCTION D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D2 =
     @    RDIST*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + N2*P2X*S2 - 
     @    L2*P2Z*S2 + Y1 - Y2)

      RETURN
      END

! DRIJ/DZ1

      DOUBLE PRECISION FUNCTION D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D3=
     @    RDIST*(C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + 
     @    L2*P2Y*S2 + Z1 - Z2)

      RETURN
      END

! DRIJ/DL1

      DOUBLE PRECISION FUNCTION D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D4 =
     @      RDIST*((C3A1*(2*L1*P1X*(-1 + L12*RALPHA12) + 
     @            (M1*P1Y + N1*P1Z)*(-1 + 2*L12*RALPHA12)) + 
     @         (L1*L12*P1X + L12*M1*P1Y - L1*N1*P1Y + L1*M1*P1Z + L12*N1*P1Z)*
     @          RALPHA12*S1 + L1*(C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 - P1X*S1))*
     @       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     @         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
     @      (C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     @         C3A1*M1*(-P1X + 2*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
     @         (-(L1*P1Y) + P1Z + L1* (L1*M1*P1X + N1*P1X + M1**2*P1Y - L1*P1Z + M1*N1*P1Z)*RALPHA12)*
     @          S1)*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
     @      (-(C2A1*L1*(-(M1*P1X) + L1*P1Y)*RALPHA12) + 
     @         C3A1*N1*(-P1X + 2*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
     @         (-P1Y - L1*P1Z + L1*(-(M1*P1X) + L1*N1*P1X + L1*P1Y + M1*N1*P1Y + N1**2*P1Z)*RALPHA12)*S1)*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
     @         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

      RETURN
      END

! DRIJ/DM1

      DOUBLE PRECISION FUNCTION D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D5=
     @ RDIST*((-(C2A1*M1*(-(N1*P1Y) + M1*P1Z)*RALPHA12) + 
     @         C3A1*L1*(-P1Y + 2*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
     @         (-(M1*P1X) - P1Z + M1* (L1**2*P1X + L1*M1*P1Y - N1*P1Y + M1*P1Z + L1*N1*P1Z)*RALPHA12)*
     @          S1)*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     @         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (-(C3A1*(L1*P1X + 2*M1*P1Y + N1*P1Z)) + 
     @         C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     @         (-(M1*P1Y) + (L1*M12*P1X + M1*N1*P1X + M1*M12*P1Y - L1*M1*P1Z + 
     @               M12*N1*P1Z)*RALPHA12)*S1)*
     @       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     @         C3A1*N1*(-P1Y + 2*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
     @         (P1X - M1*(M1 - L1*N1)*P1X*RALPHA12 + 
     @            M1*((L1 + M1*N1)*P1Y*RALPHA12 + P1Z*(-1 + N1**2*RALPHA12)))*S1)*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
     @         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

      RETURN
      END

! DRIJ/DN1

      DOUBLE PRECISION FUNCTION D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D6=
     @ RDIST*((C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     @         C3A1*L1*(-P1Z + 2*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + (-(N1*P1X) + P1Y + N1*
     @             (L1**2*P1X + L1*M1*P1Y - N1*P1Y + M1*P1Z + L1*N1*P1Z)*RALPHA12)*
     @          S1)*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     @         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
     @      (-(C2A1*N1*(N1*P1X - L1*P1Z)*RALPHA12) + 
     @         C3A1*M1*(-P1Z + 2*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
     @         (-P1X - N1*P1Y + N1*(L1*M1*P1X + N1*P1X + M1**2*P1Y - L1*P1Z + 
     @               M1*N1*P1Z)*RALPHA12)*S1)*
     @       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
     @      (-(C3A1*(L1*P1X + M1*P1Y + 2*N1*P1Z)) + 
     @         C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     @         2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     @         (-(N1*P1Z) + (-(M1*N1*P1X) + L1*N12*P1X + L1*N1*P1Y + M1*N12*P1Y + 
     @               N1*N12*P1Z)*RALPHA12)*S1)*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
     @         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

      RETURN
      END

! DRIJ/DX2

      DOUBLE PRECISION FUNCTION D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D7=
     @   -RDIST*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + 
     @    M2*P2Z*S2 + X1 - X2)

      RETURN
      END

! DRIJ/DY2

      DOUBLE PRECISION FUNCTION D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D8=
     @   -RDIST*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + N2*P2X*S2 - 
     @    L2*P2Z*S2 + Y1 - Y2)

      RETURN
      END

! DRIJ/DZ2

      DOUBLE PRECISION FUNCTION D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      D9=
     @   -RDIST*(C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + 
     @    L2*P2Y*S2 + Z1 - Z2)

      RETURN
      END

! DRIJ/DL2

      DOUBLE PRECISION FUNCTION DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      DA=
     @         RDIST*((C3A2*(2*L2*P2X + M2*P2Y + N2*P2Z - 
     @            2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - 
     @         (L2*L22*P2X + L22*M2*P2Y - L2*N2*P2Y + L2*M2*P2Z + L22*N2*P2Z)*
     @          RALPHA22*S2 + L2*(-(C2A2*N2*P2Y*RALPHA22) + C2A2*M2*P2Z*RALPHA22 + 
     @            P2X*S2))*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - 
     @         C2A2*P2X + C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + 
     @         (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
     @      (-(C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22) + 
     @         C3A2*M2*(P2X - 2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - (-(L2*P2Y) + P2Z + L2*
     @             (L2*M2*P2X + N2*P2X + M2**2*P2Y - L2*P2Z + M2*N2*P2Z)*RALPHA22)*
     @          S2)*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
     @      (C2A2*L2*(-(M2*P2X) + L2*P2Y)*RALPHA22 + 
     @         C3A2*N2*(P2X - 2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @    (P2Y + L2*P2Z - L2*(-(M2*P2X) + L2*N2*P2X + L2*P2Y + M2*N2*P2Y + N2**2*P2Z)*RALPHA22)*S2)*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

      RETURN
      END

! DRIJ/DM2

      DOUBLE PRECISION FUNCTION DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      DB=
     @ RDIST*((C2A2*M2*(-(N2*P2Y) + M2*P2Z)*RALPHA22 + 
     @         C3A2*L2*(P2Y - 2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @         (M2*P2X + P2Z - M2*(L2**2*P2X + L2*M2*P2Y - N2*P2Y + M2*P2Z + L2*N2*P2Z)*RALPHA22)*S2)*
     @       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     @         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (C3A2*(L2*P2X + 2*M2*P2Y + N2*P2Z - 
     @            2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - 
     @         (L2*M22*P2X + M2*N2*P2X + M2*M22*P2Y - L2*M2*P2Z + M22*N2*P2Z)*
     @          RALPHA22*S2 + M2*(C2A2*(N2*P2X - L2*P2Z)*RALPHA22 + P2Y*S2))*
     @       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (-(C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22) + 
     @         C3A2*N2*(P2Y - 2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @         (-P2X + M2*P2Z - M2*(-(M2*P2X) + L2*N2*P2X + L2*P2Y + M2*N2*P2Y + 
     @               N2**2*P2Z)*RALPHA22)*S2)*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
     @         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

      RETURN
      END

! DRIJ/DN2

      DOUBLE PRECISION FUNCTION DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST

      DC=
     @ RDIST*((-(C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22) + 
     @         C3A2*L2*(P2Z - 2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @         (N2*P2X - P2Y - N2*(L2**2*P2X + L2*M2*P2Y - N2*P2Y + M2*P2Z + L2*N2*P2Z)*RALPHA22)*S2)*
     @       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     @         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     @         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (C2A2*N2*(N2*P2X - L2*P2Z)*RALPHA22 + 
     @         C3A2*M2*(P2Z - 2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @         (P2X + N2*P2Y - N2*(L2*M2*P2X + N2*P2X + M2**2*P2Y - L2*P2Z + M2*N2*P2Z)*RALPHA22)*S2)*
     @       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     @         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
     @         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (C3A2*(L2*P2X + M2*P2Y + 2*N2*P2Z - 
     @            2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
     @         (N2*(M2*P2X - L2*P2Y) - N22*(L2*P2X + M2*P2Y + N2*P2Z))*RALPHA22*
     @          S2 + N2*(-(C2A2*M2*P2X*RALPHA22) + C2A2*L2*P2Y*RALPHA22 + P2Z*S2))*
     @       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     @         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
     @         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

       RETURN
       END

! SECOND DERIVATIVES OF R(I,J) WITH RESPECT TO RIGID BODY COORDINATES.

       DOUBLE PRECISION FUNCTION DD11(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                                C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1

       DD11 = RDIST*(1.0D0 -
     1               D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

       RETURN
      END FUNCTION DD11

      DOUBLE PRECISION FUNCTION DD12(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D2

       DD12 = -RDIST *
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD12

      DOUBLE PRECISION FUNCTION DD13(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D3

       DD13 = -RDIST *
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD13

      DOUBLE PRECISION FUNCTION DD14(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D4

       DD14 = RDIST*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1        C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1        2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1        L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1        L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD14

      DOUBLE PRECISION FUNCTION DD15(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST      
       DOUBLE PRECISION D1, D5
       
       DD15 = RDIST*(-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1        2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - P1Z*S1 - 
     1        M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1        L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD15

      DOUBLE PRECISION FUNCTION DD16(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D6

       DD16 = RDIST*(-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1        2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + P1Y*S1 - 
     1        N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1        L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD16

      DOUBLE PRECISION FUNCTION DD17(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D7

       DD17 = -RDIST*(1.0D0 + 
     1                D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1                D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22))
      
       RETURN
      END FUNCTION DD17

      DOUBLE PRECISION FUNCTION DD18(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D8

       DD18 = -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD18

      DOUBLE PRECISION FUNCTION DD19(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, D9

       DD19 = -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD19

      DOUBLE PRECISION FUNCTION DD1A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, DA

       DD1A = RDIST*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1        C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1        2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1        L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1        L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD1A

      DOUBLE PRECISION FUNCTION DD1B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, DB

       DD1B = RDIST*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1        2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + P2Z*S2 + 
     1        M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1        L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD1B

      DOUBLE PRECISION FUNCTION DD1C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D1, DC

       DD1C = RDIST*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1        2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - P2Y*S2 + 
     1        N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1        L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) -
     1        D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD1C

      DOUBLE PRECISION FUNCTION DD22(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
      IMPLICIT NONE
      DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
      DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
      DOUBLE PRECISION D2

      DD22 = RDIST*(1.0D0 -
     1              D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                 C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

      RETURN
      END FUNCTION DD22

      DOUBLE PRECISION FUNCTION DD23(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D3

       DD23 = -RDIST *
     1        D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD23

      DOUBLE PRECISION FUNCTION DD24(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D4

      DD24 
     1 = RDIST*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + P1Z*S1 - 
     1 L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD24

      DOUBLE PRECISION FUNCTION DD25(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D5

      DD25  
     1 = RDIST*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1 C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1 M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD25

      DOUBLE PRECISION FUNCTION DD26(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D6

      DD26  
     1 = RDIST*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - N1*P1Y*S1 - 
     1 N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD26

      DOUBLE PRECISION FUNCTION DD27(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D7

       DD27 = -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD27

      DOUBLE PRECISION FUNCTION DD28(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D8

       DD28 = -RDIST*(1.0D0 + 
     1                D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1                D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22))
      
       RETURN
      END FUNCTION DD28

      DOUBLE PRECISION FUNCTION DD29(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, D9

       DD29 = -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD29

      DOUBLE PRECISION FUNCTION DD2A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, DA

      DD2A  
     1 = RDIST*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - P2Z*S2 + 
     1 L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD2A

      DOUBLE PRECISION FUNCTION DD2B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, DB

      DD2B  
     1 = RDIST*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1 C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1 M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD2B

      DOUBLE PRECISION FUNCTION DD2C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D2, DC

      DD2C  
     1 = RDIST*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + N2*P2Y*S2 + 
     1 N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD2C

      DOUBLE PRECISION FUNCTION DD33(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3

       DD33 = RDIST*(1.0D0 -
     1               D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

       RETURN
      END FUNCTION DD33

      DOUBLE PRECISION FUNCTION DD34(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D4

      DD34  
     1 = RDIST*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - L1*P1Z*S1 - 
     1 L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD34

      DOUBLE PRECISION FUNCTION DD35 (P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D5

      DD35  
     1 = RDIST*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - M1*P1Z*S1 - 
     1 M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD35

      DOUBLE PRECISION FUNCTION DD36(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D6

      DD36  
     1 = RDIST*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1 C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1 N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD36

      DOUBLE PRECISION FUNCTION DD37(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D7

       DD37 = -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD37

      DOUBLE PRECISION FUNCTION DD38(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D8

       DD38 = -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1         D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1            C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD38

      DOUBLE PRECISION FUNCTION DD39(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, D9

       DD39 = -RDIST*(1.0D0 + 
     1                D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1                D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                   C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22))
      
       RETURN
      END FUNCTION DD39

      DOUBLE PRECISION FUNCTION DD3A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, DA

      DD3A  
     1 = RDIST*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + L2*P2Z*S2 + 
     1 L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD3A

      DOUBLE PRECISION FUNCTION DD3B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, DB

      DD3B  
     1 = RDIST*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + M2*P2Z*S2 + 
     1 M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD3B

      DOUBLE PRECISION FUNCTION DD3C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D3, DC

      DD3C  
     1 = RDIST*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1 C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1 N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD3C

      DOUBLE PRECISION FUNCTION DD44(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4

      DD44  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1     C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1     2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1     L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1     L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1     2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1     P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1     L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1     2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1     L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1     L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-2*C3A1*P1X - (3*C2A1*L12*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*L12*P1X*RALPHA12 + 4*C3A1*L12*P1X*RALPHA12 + 
     1    C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    6*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
     1    (3*L12*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    3*L12*P1X*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
     1    L12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    3*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((-3*C2A1*L12*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    4*C3A1*L1*M1*P1X*RALPHA12 - C2A1*L12*P1Y*RALPHA12 + 
     1    2*C2A1*L1*P1Z*RALPHA12 + C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
     1    (3*L12*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    2*L1*M1*P1X*RALPHA12*S1 + L12*P1Y*RALPHA12*S1 - 
     1    2*L1*P1Z*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
     1    L12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((-3*C2A1*L12*(M1*P1X - L1*P1Y))*(RALPHA12**2) + 
     1    (C2A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    4*C3A1*L1*N1*P1X*RALPHA12 - 2*C2A1*L1*P1Y*RALPHA12 + 
     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*L12*P1Z*RALPHA12 + 
     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*L12*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - P1Z*S1 - 
     1    (5*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    2*L1*N1*P1X*RALPHA12*S1 + 2*L1*P1Y*RALPHA12*S1 - 
     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
     1    L12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + L12*P1Z*RALPHA12*S1 + 
     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD44

      DOUBLE PRECISION FUNCTION DD45(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, D5

      DD45  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*P1Y) - (3*C2A1*L1*M1*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*L1*M1*P1X*RALPHA12 + 2*C3A1*L1*M1*P1X*RALPHA12 + 
     1    2*C3A1*L12*P1Y*RALPHA12 - C2A1*L1*P1Z*RALPHA12 + 
     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*L1*M1*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    2*L1*M1*P1X*RALPHA12*S1 + L12*P1Y*RALPHA12*S1 + 
     1    L1*P1Z*RALPHA12*S1 - L1*M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(-(C3A1*P1X) - (3*C2A1*L1*M1*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    2*C3A1*M12*P1X*RALPHA12 - C2A1*L1*M1*P1Y*RALPHA12 + 
     1    2*C3A1*L1*M1*P1Y*RALPHA12 + C2A1*M1*P1Z*RALPHA12 + 
     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*L1*M1*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    M12*P1X*RALPHA12*S1 + 2*L1*M1*P1Y*RALPHA12*S1 - 
     1    M1*P1Z*RALPHA12*S1 - L1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((-3*C2A1*L1*M1*(M1*P1X - L1*P1Y))*(RALPHA12**2) + 
     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    C2A1*L1*P1X*RALPHA12 + 2*C3A1*M1*N1*P1X*RALPHA12 - 
     1    C2A1*M1*P1Y*RALPHA12 + 2*C3A1*L1*N1*P1Y*RALPHA12 - 
     1    C2A1*L1*M1*P1Z*RALPHA12 + 
     1    (3*L1*M1*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - 
     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) - 
     1    L1*P1X*RALPHA12*S1 + M1*N1*P1X*RALPHA12*S1 + M1*P1Y*RALPHA12*S1 + 
     1    L1*N1*P1Y*RALPHA12*S1 - L1*M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*M1*P1Z*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*RDIST

       RETURN
      END FUNCTION DD45

      DOUBLE PRECISION FUNCTION DD46(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, D6

      DD46  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*P1Z) - (3*C2A1*L1*N1*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*L1*N1*P1X*RALPHA12 + 2*C3A1*L1*N1*P1X*RALPHA12 + 
     1    C2A1*L1*P1Y*RALPHA12 + 2*C3A1*L12*P1Z*RALPHA12 + 
     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*L1*N1*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    2*L1*N1*P1X*RALPHA12*S1 - L1*P1Y*RALPHA12*S1 + 
     1    L12*P1Z*RALPHA12*S1 - L1*N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((-3*C2A1*L1*N1*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*L1*P1X*RALPHA12 + 2*C3A1*M1*N1*P1X*RALPHA12 - 
     1    C2A1*L1*N1*P1Y*RALPHA12 + 2*C3A1*L1*M1*P1Z*RALPHA12 + 
     1    C2A1*N1*P1Z*RALPHA12 + 
     1    (3*L1*N1*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    L1*P1X*RALPHA12*S1 + M1*N1*P1X*RALPHA12*S1 + 
     1    L1*N1*P1Y*RALPHA12*S1 + L1*M1*P1Z*RALPHA12*S1 - 
     1    N1*P1Z*RALPHA12*S1 - L1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*(-(C3A1*P1X) - (3*C2A1*L1*N1*(M1*P1X - L1*P1Y))*(RALPHA12**2) + 
     1    (C2A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    2*C3A1*N12*P1X*RALPHA12 - C2A1*N1*P1Y*RALPHA12 - 
     1    C2A1*L1*N1*P1Z*RALPHA12 + 2*C3A1*L1*N1*P1Z*RALPHA12 + 
     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*L1*N1*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - 
     1    (5*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    N12*P1X*RALPHA12*S1 + N1*P1Y*RALPHA12*S1 - 
     1    L1*N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 2*L1*N1*P1Z*RALPHA12*S1 + 
     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD46

      DOUBLE PRECISION FUNCTION DD47(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, D7

      DD47  
     1 = -(RDIST*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1 C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1 2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1 L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1 L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD47

      DOUBLE PRECISION FUNCTION DD48(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, D8

      DD48  
     1 = -(RDIST*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1 P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD48

      DOUBLE PRECISION FUNCTION DD49(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, D9

      DD49  
     1 = -(RDIST*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1 L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD49

      DOUBLE PRECISION FUNCTION DD4A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, DA

      DD4A  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD4A

      DOUBLE PRECISION FUNCTION DD4B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, DB

      DD4B  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD4B

      DOUBLE PRECISION FUNCTION DD4C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D4, DC

      DD4C  
     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD4C

      DOUBLE PRECISION FUNCTION DD55(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5

      DD55  
     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
     1     C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1     2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1     P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1     L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1     C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1     2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1     M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1     M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1     2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1     M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1     M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*((-3*C2A1*M12*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*M12*P1X*RALPHA12 + 4*C3A1*L1*M1*P1Y*RALPHA12 - 
     1    2*C2A1*M1*P1Z*RALPHA12 + C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
     1    (3*M12*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    M12*P1X*RALPHA12*S1 + 2*L1*M1*P1Y*RALPHA12*S1 + 
     1    2*M1*P1Z*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
     1    M12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(-2*C3A1*P1Y - (3*C2A1*M12*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*M1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*M1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*M12*P1Y*RALPHA12 + 4*C3A1*M12*P1Y*RALPHA12 + 
     1    C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    6*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
     1    (3*M12*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*M1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    3*M12*P1Y*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
     1    M12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    3*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((-3*C2A1*M12*(M1*P1X - L1*P1Y))*(RALPHA12**2) + 
     1    (C2A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    2*C2A1*M1*P1X*RALPHA12 + 4*C3A1*M1*N1*P1Y*RALPHA12 + 
     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*M12*P1Z*RALPHA12 + 
     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*M12*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - P1Z*S1 - 
     1    (5*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) - 
     1    2*M1*P1X*RALPHA12*S1 + 2*M1*N1*P1Y*RALPHA12*S1 - 
     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
     1    M12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + M12*P1Z*RALPHA12*S1 + 
     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD55

      DOUBLE PRECISION FUNCTION DD56(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, D6

      DD56  
     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
     1 2*((-3*C2A1*M1*N1*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*M1*N1*P1X*RALPHA12 + C2A1*M1*P1Y*RALPHA12 + 
     1    2*C3A1*L1*N1*P1Y*RALPHA12 + 2*C3A1*L1*M1*P1Z*RALPHA12 - 
     1    C2A1*N1*P1Z*RALPHA12 + 
     1    (3*M1*N1*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    M1*N1*P1X*RALPHA12*S1 - M1*P1Y*RALPHA12*S1 + 
     1    L1*N1*P1Y*RALPHA12*S1 + L1*M1*P1Z*RALPHA12*S1 + 
     1    N1*P1Z*RALPHA12*S1 - M1*N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(-(C3A1*P1Z) - (3*C2A1*M1*N1*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*M1*P1X*RALPHA12 - C2A1*M1*N1*P1Y*RALPHA12 + 
     1    2*C3A1*M1*N1*P1Y*RALPHA12 + 2*C3A1*M12*P1Z*RALPHA12 + 
     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*M1*N1*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    M1*P1X*RALPHA12*S1 + 2*M1*N1*P1Y*RALPHA12*S1 + 
     1    M12*P1Z*RALPHA12*S1 - M1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*(-(C3A1*P1Y) - (3*C2A1*M1*N1*(M1*P1X - L1*P1Y))*(RALPHA12**2) + 
     1    (C2A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    C2A1*N1*P1X*RALPHA12 + 2*C3A1*N12*P1Y*RALPHA12 - 
     1    C2A1*M1*N1*P1Z*RALPHA12 + 2*C3A1*M1*N1*P1Z*RALPHA12 + 
     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*M1*N1*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - 
     1    (5*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) - 
     1    N1*P1X*RALPHA12*S1 + N12*P1Y*RALPHA12*S1 - 
     1    M1*N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 2*M1*N1*P1Z*RALPHA12*S1 + 
     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD56

      DOUBLE PRECISION FUNCTION DD57(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, D7

      DD57  
     1 = -(RDIST*(-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1 P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD57

      DOUBLE PRECISION FUNCTION DD58(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, D8

      DD58  
     1 = -(RDIST*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1 C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1 M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD58

      DOUBLE PRECISION FUNCTION DD59(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, D9

      DD59  
     1 = -(RDIST*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1 M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD59

      DOUBLE PRECISION FUNCTION DD5A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, DA

      DD5A  
     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD5A

      DOUBLE PRECISION FUNCTION DD5B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, DB

      DD5B  
     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD5B

      DOUBLE PRECISION FUNCTION DD5C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D5, DC

      DD5C  
     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD5C

      DOUBLE PRECISION FUNCTION DD66(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6

      DD66  
     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
     1     C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1     2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1     P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1     L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1     2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1     N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1     M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1     C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1     2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1     N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1     N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
     1 2*((-3*C2A1*N12*(N1*P1Y - M1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    C2A1*N12*P1X*RALPHA12 + 2*C2A1*N1*P1Y*RALPHA12 + 
     1    4*C3A1*L1*N1*P1Z*RALPHA12 + C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
     1    (3*N12*(N1*P1Y - M1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    N12*P1X*RALPHA12*S1 - 2*N1*P1Y*RALPHA12*S1 + 
     1    2*L1*N1*P1Z*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
     1    N12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((-3*C2A1*N12*(-(N1*P1X) + L1*P1Z))*(RALPHA12**2) + 
     1    (C2A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    2*C2A1*N1*P1X*RALPHA12 - C2A1*N12*P1Y*RALPHA12 + 
     1    4*C3A1*M1*N1*P1Z*RALPHA12 + C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
     1    (3*N12*(-(N1*P1X) + L1*P1Z)*S1)*(RALPHA12**2) - 
     1    (5*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) + 
     1    2*N1*P1X*RALPHA12*S1 + N12*P1Y*RALPHA12*S1 + 
     1    2*M1*N1*P1Z*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
     1    N12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((-3*C2A1*N12*(M1*P1X - L1*P1Y))*(RALPHA12**2) - 2*C3A1*P1Z + 
     1    (C2A1*N1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) - 
     1    (8*C3A1*N1**3*(L1*P1X + M1*P1Y + N1*P1Z))*(RALPHA12**2) + 
     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*N12*P1Z*RALPHA12 + 
     1    4*C3A1*N12*P1Z*RALPHA12 + 
     1    6*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
     1    (3*N12*(M1*P1X - L1*P1Y)*S1)*(RALPHA12**2) - P1Z*S1 - 
     1    (5*N1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)*(RALPHA12**2) - 
     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
     1    N12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 3*N12*P1Z*RALPHA12*S1 + 
     1    3*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD66

      DOUBLE PRECISION FUNCTION DD67(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, D7

      DD67  
     1 = -(RDIST*(-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1 P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD67

      DOUBLE PRECISION FUNCTION DD68(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, D8

      DD68  
     1 = -(RDIST*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1 N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD68

      DOUBLE PRECISION FUNCTION DD69(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, D9

      DD69  
     1 = -(RDIST*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1 C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1 2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1 N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1 N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD69

      DOUBLE PRECISION FUNCTION DD6A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, DA

      DD6A  
     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD6A

      DOUBLE PRECISION FUNCTION DD6B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, DB

      DD6B  
     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD6B

      DOUBLE PRECISION FUNCTION DD6C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D6, DC

      DD6C  
     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD6C

      DOUBLE PRECISION FUNCTION DD77(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7

       DD77 = RDIST*(1.0D0 -
     1               D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

       RETURN
      END FUNCTION DD77

      DOUBLE PRECISION FUNCTION DD78(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7, D8

       DD78 = -RDIST *
     1        D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD78

      DOUBLE PRECISION FUNCTION DD79(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7, D9

       DD79 = -RDIST *
     1        D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD79

      DOUBLE PRECISION FUNCTION DD7A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7, DA

      DD7A  
     1 = -(RDIST*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1 C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1 2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1 L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1 L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD7A

      DOUBLE PRECISION FUNCTION DD7B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7, DB

      DD7B  
     1 = -(RDIST*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1 P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD7B

      DOUBLE PRECISION FUNCTION DD7C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D7, DC

      DD7C  
     1 = -(RDIST*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1 P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD7C

      DOUBLE PRECISION FUNCTION DD88(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D8

       DD88 = RDIST*(1.0D0 -
     1               D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

       RETURN
      END FUNCTION DD88

      DOUBLE PRECISION FUNCTION DD89(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D8, D9

       DD89 = -RDIST *
     1        D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1        D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1           C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

       RETURN
      END FUNCTION DD89

      DOUBLE PRECISION FUNCTION DD8A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D8, DA

      DD8A  
     1 = -(RDIST*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1 P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD8A

      DOUBLE PRECISION FUNCTION DD8B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D8, DB

      DD8B  
     1 = -(RDIST*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1 C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1 M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD8B
      
      DOUBLE PRECISION FUNCTION DD8C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D8, DC

      DD8C  
     1 = -(RDIST*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1 N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD8C

      DOUBLE PRECISION FUNCTION DD99(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D9

       DD99 = RDIST*(1.0D0 -
     1               D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)**2)

       RETURN
      END FUNCTION DD99

      DOUBLE PRECISION FUNCTION DD9A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D9, DA

      DD9A  
     1 = -(RDIST*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1 L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD9A

      DOUBLE PRECISION FUNCTION DD9B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D9, DB

      DD9B  
     1 = -(RDIST*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1 M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD9B

      DOUBLE PRECISION FUNCTION DD9C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION D9, DC

      DD9C  
     1 = -(RDIST*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1 C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1 2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1 N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1 N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DD9C

      DOUBLE PRECISION FUNCTION DDAA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DA

      DDAA  
     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1     C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1     2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1     L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1     L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1     2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1     P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1     L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1     2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1     L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1     L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(2*C3A2*P2X + (3*C2A2*L22*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*L22*P2X*RALPHA22 - 4*C3A2*L22*P2X*RALPHA22 - 
     1    C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    6*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
     1    (3*L22*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    3*L22*P2X*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
     1    L22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    3*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((3*C2A2*L22*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    4*C3A2*L2*M2*P2X*RALPHA22 + C2A2*L22*P2Y*RALPHA22 - 
     1    2*C2A2*L2*P2Z*RALPHA22 - C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
     1    (3*L22*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    2*L2*M2*P2X*RALPHA22*S2 - L22*P2Y*RALPHA22*S2 + 
     1    2*L2*P2Z*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
     1    L22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((3*C2A2*L22*(M2*P2X - L2*P2Y))*(RALPHA22**2) - 
     1    (C2A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    4*C3A2*L2*N2*P2X*RALPHA22 + 2*C2A2*L2*P2Y*RALPHA22 - 
     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*L22*P2Z*RALPHA22 - 
     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*L22*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + P2Z*S2 + 
     1    (5*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    2*L2*N2*P2X*RALPHA22*S2 - 2*L2*P2Y*RALPHA22*S2 + 
     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
     1    L22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - L22*P2Z*RALPHA22*S2 - 
     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDAA

      DOUBLE PRECISION FUNCTION DDAB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DA, DB

      DDAB  
     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*P2Y + (3*C2A2*L2*M2*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*L2*M2*P2X*RALPHA22 - 2*C3A2*L2*M2*P2X*RALPHA22 - 
     1    2*C3A2*L22*P2Y*RALPHA22 + C2A2*L2*P2Z*RALPHA22 - 
     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*L2*M2*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    2*L2*M2*P2X*RALPHA22*S2 - L22*P2Y*RALPHA22*S2 - 
     1    L2*P2Z*RALPHA22*S2 + L2*M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(C3A2*P2X + (3*C2A2*L2*M2*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    2*C3A2*M22*P2X*RALPHA22 + C2A2*L2*M2*P2Y*RALPHA22 - 
     1    2*C3A2*L2*M2*P2Y*RALPHA22 - C2A2*M2*P2Z*RALPHA22 - 
     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*L2*M2*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    M22*P2X*RALPHA22*S2 - 2*L2*M2*P2Y*RALPHA22*S2 + 
     1    M2*P2Z*RALPHA22*S2 + L2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((3*C2A2*L2*M2*(M2*P2X - L2*P2Y))*(RALPHA22**2) - 
     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    C2A2*L2*P2X*RALPHA22 - 2*C3A2*M2*N2*P2X*RALPHA22 + 
     1    C2A2*M2*P2Y*RALPHA22 - 2*C3A2*L2*N2*P2Y*RALPHA22 + 
     1    C2A2*L2*M2*P2Z*RALPHA22 - 
     1    (3*L2*M2*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + 
     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) + 
     1    L2*P2X*RALPHA22*S2 - M2*N2*P2X*RALPHA22*S2 - M2*P2Y*RALPHA22*S2 - 
     1    L2*N2*P2Y*RALPHA22*S2 + L2*M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*M2*P2Z*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDAB

      DOUBLE PRECISION FUNCTION DDAC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DA, DC

      DDAC  
     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*P2Z + (3*C2A2*L2*N2*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*L2*N2*P2X*RALPHA22 - 2*C3A2*L2*N2*P2X*RALPHA22 - 
     1    C2A2*L2*P2Y*RALPHA22 - 2*C3A2*L22*P2Z*RALPHA22 - 
     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*L2*N2*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    2*L2*N2*P2X*RALPHA22*S2 + L2*P2Y*RALPHA22*S2 - 
     1    L22*P2Z*RALPHA22*S2 + L2*N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((3*C2A2*L2*N2*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*L2*P2X*RALPHA22 - 2*C3A2*M2*N2*P2X*RALPHA22 + 
     1    C2A2*L2*N2*P2Y*RALPHA22 - 2*C3A2*L2*M2*P2Z*RALPHA22 - 
     1    C2A2*N2*P2Z*RALPHA22 - 
     1    (3*L2*N2*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    L2*P2X*RALPHA22*S2 - M2*N2*P2X*RALPHA22*S2 - 
     1    L2*N2*P2Y*RALPHA22*S2 - L2*M2*P2Z*RALPHA22*S2 + 
     1    N2*P2Z*RALPHA22*S2 + L2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*(C3A2*P2X + (3*C2A2*L2*N2*(M2*P2X - L2*P2Y))*(RALPHA22**2) - 
     1    (C2A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    2*C3A2*N22*P2X*RALPHA22 + C2A2*N2*P2Y*RALPHA22 + 
     1    C2A2*L2*N2*P2Z*RALPHA22 - 2*C3A2*L2*N2*P2Z*RALPHA22 - 
     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*L2*N2*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + 
     1    (5*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    N22*P2X*RALPHA22*S2 - N2*P2Y*RALPHA22*S2 + 
     1    L2*N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 2*L2*N2*P2Z*RALPHA22*S2 - 
     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDAC

      DOUBLE PRECISION FUNCTION DDBB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DB

      DDBB  
     1 = (RDIST*(2*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1     2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1     P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1     L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1     C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1     2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1     M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1     M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1     2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1     M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1     M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*((3*C2A2*M22*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*M22*P2X*RALPHA22 - 4*C3A2*L2*M2*P2Y*RALPHA22 + 
     1    2*C2A2*M2*P2Z*RALPHA22 - C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
     1    (3*M22*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    M22*P2X*RALPHA22*S2 - 2*L2*M2*P2Y*RALPHA22*S2 - 
     1    2*M2*P2Z*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
     1    M22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(2*C3A2*P2Y + (3*C2A2*M22*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*M2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*M2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*M22*P2Y*RALPHA22 - 4*C3A2*M22*P2Y*RALPHA22 - 
     1    C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    6*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
     1    (3*M22*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*M2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    3*M22*P2Y*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
     1    M22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    3*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((3*C2A2*M22*(M2*P2X - L2*P2Y))*(RALPHA22**2) - 
     1    (C2A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    2*C2A2*M2*P2X*RALPHA22 - 4*C3A2*M2*N2*P2Y*RALPHA22 - 
     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*M22*P2Z*RALPHA22 - 
     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*M22*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + P2Z*S2 + 
     1    (5*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) + 
     1    2*M2*P2X*RALPHA22*S2 - 2*M2*N2*P2Y*RALPHA22*S2 + 
     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
     1    M22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - M22*P2Z*RALPHA22*S2 - 
     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDBB

      DOUBLE PRECISION FUNCTION DDBC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DB, DC

      DDBC  
     1 = (RDIST*(2*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
     1 2*((3*C2A2*M2*N2*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*M2*N2*P2X*RALPHA22 - C2A2*M2*P2Y*RALPHA22 - 
     1    2*C3A2*L2*N2*P2Y*RALPHA22 - 2*C3A2*L2*M2*P2Z*RALPHA22 + 
     1    C2A2*N2*P2Z*RALPHA22 - 
     1    (3*M2*N2*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    M2*N2*P2X*RALPHA22*S2 + M2*P2Y*RALPHA22*S2 - 
     1    L2*N2*P2Y*RALPHA22*S2 - L2*M2*P2Z*RALPHA22*S2 - 
     1    N2*P2Z*RALPHA22*S2 + M2*N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*(C3A2*P2Z + (3*C2A2*M2*N2*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*M2*P2X*RALPHA22 + C2A2*M2*N2*P2Y*RALPHA22 - 
     1    2*C3A2*M2*N2*P2Y*RALPHA22 - 2*C3A2*M22*P2Z*RALPHA22 - 
     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*M2*N2*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    M2*P2X*RALPHA22*S2 - 2*M2*N2*P2Y*RALPHA22*S2 - 
     1    M22*P2Z*RALPHA22*S2 + M2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*(C3A2*P2Y + (3*C2A2*M2*N2*(M2*P2X - L2*P2Y))*(RALPHA22**2) - 
     1    (C2A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    C2A2*N2*P2X*RALPHA22 - 2*C3A2*N22*P2Y*RALPHA22 + 
     1    C2A2*M2*N2*P2Z*RALPHA22 - 2*C3A2*M2*N2*P2Z*RALPHA22 - 
     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*M2*N2*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + 
     1    (5*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) + 
     1    N2*P2X*RALPHA22*S2 - N22*P2Y*RALPHA22*S2 + 
     1    M2*N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 2*M2*N2*P2Z*RALPHA22*S2 - 
     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1    C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDBC

      DOUBLE PRECISION FUNCTION DDCC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                               C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
       IMPLICIT NONE
       DOUBLE PRECISION C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22
       DOUBLE PRECISION P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST
       DOUBLE PRECISION DC

      DDCC 
     1 = (RDIST*(2*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1     2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
     1     P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1     L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1     2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
     1     N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1     M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
     1     C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
     1     2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
     1     N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
     1     N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
     1 2*((3*C2A2*N22*(N2*P2Y - M2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    C2A2*N22*P2X*RALPHA22 - 2*C2A2*N2*P2Y*RALPHA22 - 
     1    4*C3A2*L2*N2*P2Z*RALPHA22 - C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
     1    (3*N22*(N2*P2Y - M2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    N22*P2X*RALPHA22*S2 + 2*N2*P2Y*RALPHA22*S2 - 
     1    2*L2*N2*P2Z*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
     1    N22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
     1 2*((3*C2A2*N22*(-(N2*P2X) + L2*P2Z))*(RALPHA22**2) - 
     1    (C2A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    2*C2A2*N2*P2X*RALPHA22 + C2A2*N22*P2Y*RALPHA22 - 
     1    4*C3A2*M2*N2*P2Z*RALPHA22 - C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
     1    (3*N22*(-(N2*P2X) + L2*P2Z)*S2)*(RALPHA22**2) + 
     1    (5*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) - 
     1    2*N2*P2X*RALPHA22*S2 - N22*P2Y*RALPHA22*S2 - 
     1    2*M2*N2*P2Z*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
     1    N22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
     1 2*((3*C2A2*N22*(M2*P2X - L2*P2Y))*(RALPHA22**2) + 2*C3A2*P2Z - 
     1    (C2A2*N2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) + 
     1    (8*C3A2*N2**3*(L2*P2X + M2*P2Y + N2*P2Z))*(RALPHA22**2) - 
     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*N22*P2Z*RALPHA22 - 
     1    4*C3A2*N22*P2Z*RALPHA22 - 
     1    6*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
     1    (3*N22*(M2*P2X - L2*P2Y)*S2)*(RALPHA22**2) + P2Z*S2 + 
     1    (5*N2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)*(RALPHA22**2) + 
     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
     1    N22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 3*N22*P2Z*RALPHA22*S2 - 
     1    3*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
     1 -DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)*
     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1     C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)* RDIST

       RETURN
      END FUNCTION DDCC

! ****************************************************************************************************

! TRJ25 ANNOTATED DERIVATIVES OF INDIVIDUAL CARTESIAN COORDINATES FOR USE WITH ELECTRIC FIELDS
! SEE NOTEBOOK ENTRIES CIRCA 18/3/05

! ****************************************************************************************************

      FUNCTION DXDPX (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DXDPX
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DXDPX = PDOTX0*(1.0D0-COS_ALPHA)*INV_ALPHA2 - PX*X0*SIN_ALPHA*INV_ALPHA +
     &          PX*INV_ALPHA2*(X0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PX*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) +
     &          (PZ*Y0-PY*Z0)*PX*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)

        RETURN

      END FUNCTION DXDPX

! ****************************************************************************************************

      FUNCTION DXDPY (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DXDPY
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DXDPY = PX*INV_ALPHA2*(Y0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PY*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) -
     &          (PY*X0+Z0)*SIN_ALPHA*INV_ALPHA +
     &          (PZ*Y0-PY*Z0)*PY*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)
        
        RETURN

      END FUNCTION DXDPY

! ****************************************************************************************************

      FUNCTION DXDPZ (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DXDPZ
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DXDPZ = (Y0-PZ*X0)*SIN_ALPHA*INV_ALPHA +
     &          PX*INV_ALPHA2*(Z0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PZ*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) +
     &          (PZ*Y0-PY*Z0)*PZ*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)

        RETURN

      END FUNCTION DXDPZ

! ****************************************************************************************************

      FUNCTION DYDPX (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DYDPX
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DYDPX = (Z0-PX*Y0)*SIN_ALPHA*INV_ALPHA +
     &          PY*INV_ALPHA2*(X0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PX*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) +
     &          (PX*Z0-PZ*X0)*PX*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)

        RETURN

      END FUNCTION DYDPX

! ****************************************************************************************************

      FUNCTION DYDPY (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DYDPY
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DYDPY = PDOTX0*(1.0D0-COS_ALPHA)*INV_ALPHA2 - PY*Y0*SIN_ALPHA*INV_ALPHA +
     &          PY*INV_ALPHA2*(Y0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PY*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) +
     &          (PX*Z0-PZ*X0)*PY*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)

        RETURN

      END FUNCTION DYDPY

! ****************************************************************************************************

      FUNCTION DYDPZ (PX, PY, PZ, X0, Y0, Z0, 
     &                COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2, 
     &                PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DYDPZ
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, SIN_ALPHA, INV_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DYDPZ = PY*INV_ALPHA2*(Z0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PZ*INV_ALPHA*(SIN_ALPHA-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA)) -
     &          (PZ*Y0+X0)*SIN_ALPHA*INV_ALPHA +
     &          (PX*Z0-PZ*X0)*PZ*INV_ALPHA2*(COS_ALPHA-SIN_ALPHA*INV_ALPHA)

        RETURN

      END FUNCTION DYDPZ

! ****************************************************************************************************

! WRAPPER FUNCTION FOR DZDXRB

      FUNCTION DZDXRB (COORDNO,PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DZDXRB
        INTEGER, INTENT(IN) :: COORDNO
        DOUBLE PRECISION, INTENT(IN) :: PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0
        
! EXTERNAL FUNCTIONS

        DOUBLE PRECISION :: DZDPX,DZDPY,DZDPZ
        
        SELECT CASE (COORDNO)
           CASE (1:2)
              DZDXRB = 0.0D0
           CASE (3)
              DZDXRB = 1.0D0
           CASE (4)
              DZDXRB = DZDPX(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
           CASE (5)
              DZDXRB = DZDPY(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)              
           CASE (6)
              DZDXRB = DZDPZ(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
           CASE DEFAULT
              PRINT *, 'OUT OF RANGE COORDINATE INDEX PASSED TO DZDXRB'
              STOP
        END SELECT

        RETURN

      END FUNCTION DZDXRB


! ****************************************************************************************************

      FUNCTION DZDPX (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DZDPX
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DZDPX = PZ*INV_ALPHA2*(X0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PX*(SINA_A-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA2)) -
     &          SINA_A*(PX*Z0+Y0) + 
     &          (PY*X0-PX*Y0)*PX*INV_ALPHA2*(COS_ALPHA-SINA_A)
        
        RETURN
 
      END FUNCTION DZDPX

! ****************************************************************************************************

      FUNCTION DZDPY (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DZDPY
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DZDPY = SINA_A*(X0-Z0*PY) + PZ*INV_ALPHA2*(Y0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PY*(SINA_A-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA2)) +
     &          (PY*X0-PX*Y0)*PY*INV_ALPHA2*(COS_ALPHA-SINA_A)
        
        RETURN

      END FUNCTION DZDPY

! ****************************************************************************************************

      FUNCTION DZDPZ (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: DZDPZ
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        DZDPZ = PDOTX0*(1.0D0-COS_ALPHA)*INV_ALPHA2 - PZ*Z0*SINA_A +
     &          PZ*INV_ALPHA2*(Z0*(1.0D0-COS_ALPHA) + 
     &          PDOTX0*PZ*(SINA_A-2.0D0*(1.0D0-COS_ALPHA)*INV_ALPHA2)) +
     &          (PY*X0-PX*Y0)*PZ*INV_ALPHA2*(COS_ALPHA-SINA_A)

        RETURN

      END FUNCTION DZDPZ

! ****************************************************************************************************

! AND SELECTED SECOND DERIVATIVES

! ****************************************************************************************************

! WRAPPER FUNCTION FOR THE RIGID BODY SECOND DERIVATIVES
! COORDNO`S RUN FROM 1 TO 6, WITH 1 SPECIFYING DZ/DXCOM, 2 SPECIFYING DZ/DYCOM ETC

      FUNCTION D2ZDXRB1DXRB2(COORDNO1,COORDNO2,
     1                       PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

       IMPLICIT NONE

       DOUBLE PRECISION :: D2ZDXRB1DXRB2
       INTEGER :: COORDNO1,COORDNO2
       DOUBLE PRECISION :: PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0

! LOCAL VARIABLES

       INTEGER :: FIRSTCOORD, SECONDCOORD

! EXTERNAL FUNCTIONS

       DOUBLE PRECISION :: D2ZDPX2,D2ZDPXDPY,D2ZDPXDPZ,D2ZDPY2,D2ZDPYDPZ,D2ZDPZ2

! CHECK FOR RANGE

       IF (COORDNO1.LT.1 .OR. COORDNO1.GT.6) THEN
          PRINT *, 'OUT OF RANGE COORDNO1 PASSED TO D2ZDXRB1DXRB2:', COORDNO1
          STOP
       ENDIF
       IF (COORDNO2.LT.1 .OR. COORDNO2.GT.6) THEN
          PRINT *, 'OUT OF RANGE COORDNO1 PASSED TO D2ZDXRB1DXRB2:', COORDNO2
          STOP
       ENDIF

       IF (COORDNO1.GT.COORDNO2) THEN
          FIRSTCOORD = COORDNO2
          SECONDCOORD = COORDNO1
       ELSE
          FIRSTCOORD = COORDNO1
          SECONDCOORD = COORDNO2          
       END IF

       SELECT CASE (FIRSTCOORD)
       CASE (4)
          SELECT CASE (SECONDCOORD)
          CASE (4)   
             D2ZDXRB1DXRB2 = D2ZDPX2(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE (5)
             D2ZDXRB1DXRB2 = D2ZDPXDPY(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE (6)
             D2ZDXRB1DXRB2 = D2ZDPXDPZ(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE DEFAULT
             PRINT *, 'SHOULD NOT GET HERE'
             STOP
          END SELECT

       CASE (5)
          SELECT CASE (SECONDCOORD)
          CASE (5)
             D2ZDXRB1DXRB2 = D2ZDPY2(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE (6)
             D2ZDXRB1DXRB2 = D2ZDPYDPZ(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE DEFAULT
             PRINT *, 'SHOULD NOT GET HERE'
             STOP
          END SELECT

       CASE (6)
          SELECT CASE (SECONDCOORD)
          CASE (6)
             D2ZDXRB1DXRB2 = D2ZDPZ2(PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)
          CASE DEFAULT
             PRINT *, 'SHOULD NOT GET HERE'
             STOP
          END SELECT

       CASE DEFAULT
          D2ZDXRB1DXRB2 = 0.0D0

       END SELECT

       RETURN

      END FUNCTION D2ZDXRB1DXRB2

! ****************************************************************************************************

      FUNCTION D2ZDPX2 (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPX2
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPX2 = -2.0D0*PX*(Y0+PX*(PY*X0-PX*Y0)*INV_ALPHA2)*COS_ALPHA*INV_ALPHA2 +
     &            (8.0D0*(PX**2)*INV_ALPHA2-2.0D0)*PZ*(1.0D0-COS_ALPHA)*PDOTX0*(INV_ALPHA2**2) +
     &            (2.0D0*PX*Y0 + (3.0D0*(PX**2)*INV_ALPHA2-1.0D0)*(PY*X0-PX*Y0))*SINA_A*INV_ALPHA2 +
     &            (PY*X0-PX*Y0)*(COS_ALPHA*(1.0D0-(PX**2)*INV_ALPHA2)-(PX**2)*SINA_A)*INV_ALPHA2 +
     &            Z0*((PX**2)*INV_ALPHA2*(SINA_A-COS_ALPHA) - SINA_A) -
     &            4.0D0*PX*PZ*(X0*(1.0D0-COS_ALPHA) + PX*PDOTX0*SINA_A)*(INV_ALPHA2**2) +
     &            PZ*(2.0D0*PX*X0*SINA_A+PDOTX0*((PX**2)*INV_ALPHA2*(COS_ALPHA-SINA_A)+SINA_A))*INV_ALPHA2
        
        RETURN
 
      END FUNCTION D2ZDPX2

! ****************************************************************************************************

      FUNCTION D2ZDPXDPY (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPXDPY
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPXDPY = INV_ALPHA2*(COS_ALPHA*(PX*X0 - PY*Y0 - PX*PY*Z0) + 
     &                          SINA_A*(PY*PZ*X0+PY*Y0+PX*PZ*Y0+PX*PY*Z0-PX*PY*(PY*X0-PX*Y0)-PX*X0)) +
     &              (INV_ALPHA2**2)*(COS_ALPHA*PX*PY*(PZ*PDOTX0 - 3.0D0*(PY*X0 - PX*Y0)) +
     &                               SINA_A*PX*PY*(3.0D0*(PY*X0 - PX*Y0) - 5.0D0*PZ*PDOTX0) -
     &                               2.0D0*(1.0D0 - COS_ALPHA)*PZ*(PY*X0 + PX*Y0)) +
     &              (INV_ALPHA2**3)*8.0D0*PX*PY*PZ*(1.0D0 - COS_ALPHA)*PDOTX0 
 
        RETURN
 
      END FUNCTION D2ZDPXDPY

! ****************************************************************************************************

      FUNCTION D2ZDPXDPZ (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPXDPZ
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPXDPZ = INV_ALPHA2*(X0*(1.0D0-COS_ALPHA) - COS_ALPHA*PZ*(Y0+PX*Z0) + 
     &                          SINA_A*(PZ*(PZ*X0+Y0-PX*(PY*X0-PX*Y0)+2.0D0*PX*Z0)+PX*PDOTX0)) +
     &              (INV_ALPHA2**2)*(COS_ALPHA*PX*PZ*(PZ*PDOTX0-3.0D0*(PY*X0-PX*Y0)) + 
     &                               SINA_A*PX*PZ*(3.0D0*(PY*X0-PX*Y0)-5.0D0*PZ*PDOTX0) -
     &                               2.0D0*(1.0D0-COS_ALPHA)*((PZ**2)*X0+PX*PZ*Z0+PX*PDOTX0)) +
     &              (INV_ALPHA2**3)*8.0D0*PX*(PZ**2)*(1.0D0 - COS_ALPHA)*PDOTX0 

        RETURN
 
      END FUNCTION D2ZDPXDPZ

! ****************************************************************************************************

      FUNCTION D2ZDPY2 (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPY2
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPY2 = 2.0D0*PY*(X0-PY*(PY*X0-PX*Y0)*INV_ALPHA2)*COS_ALPHA*INV_ALPHA2 +
     &            (8.0D0*(PY**2)*INV_ALPHA2-2.0D0)*PZ*(1.0D0-COS_ALPHA)*PDOTX0*(INV_ALPHA2**2) +
     &            (-2.0D0*PY*X0 + (3.0D0*(PY**2)*INV_ALPHA2-1.0D0)*(PY*X0-PX*Y0))*SINA_A*INV_ALPHA2 +
     &            (PY*X0-PX*Y0)*(COS_ALPHA*(1.0D0-(PY**2)*INV_ALPHA2)-(PY**2)*SINA_A)*INV_ALPHA2 +
     &            Z0*((PY**2)*INV_ALPHA2*(SINA_A-COS_ALPHA) - SINA_A) -
     &            4.0D0*PY*PZ*(Y0*(1.0D0-COS_ALPHA) + PY*PDOTX0*SINA_A)*(INV_ALPHA2**2) +
     &            PZ*(2.0D0*PY*Y0*SINA_A+PDOTX0*((PY**2)*INV_ALPHA2*(COS_ALPHA-SINA_A)+SINA_A))*INV_ALPHA2
        
        RETURN
 
      END FUNCTION D2ZDPY2

! ****************************************************************************************************

      FUNCTION D2ZDPYDPZ (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPYDPZ
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPYDPZ = INV_ALPHA2*(Y0*(1.0D0-COS_ALPHA) + COS_ALPHA*PZ*(X0-PY*Z0) +
     &                          SINA_A*(PZ*(PZ*Y0+2.0D0*PY*Z0-X0-PY*(PY*X0 - PX*Y0)) + PY*PDOTX0)) +
     &              (INV_ALPHA2**2)*(COS_ALPHA*PY*PZ*(PZ*PDOTX0-3.0D0*(PY*X0-PX*Y0)) +
     &                               SINA_A*PY*PZ*(3.0D0*(PY*X0 - PX*Y0) - 5.0D0*PZ*PDOTX0) -
     &                               2.0D0*(1.0D0 - COS_ALPHA)*(PZ*(PZ*Y0+PY*Z0) + PY*PDOTX0)) +
     &              (INV_ALPHA2**3)*8.0D0*PY*(PZ**2)*(1.0D0 - COS_ALPHA)*PDOTX0 

        RETURN
 
      END FUNCTION D2ZDPYDPZ 

! ****************************************************************************************************

      FUNCTION D2ZDPZ2 (PX,PY,PZ,X0,Y0,Z0,COS_ALPHA,SINA_A,INV_ALPHA2,PDOTX0)

        IMPLICIT NONE

        DOUBLE PRECISION :: D2ZDPZ2
        DOUBLE PRECISION, INTENT(IN) :: PX, PY, PZ, X0, Y0, Z0
        DOUBLE PRECISION, INTENT(IN) :: COS_ALPHA, INV_ALPHA2
        DOUBLE PRECISION, INTENT(IN) :: SINA_A    ! SIN(ALPHA)/ALPHA
        DOUBLE PRECISION, INTENT(IN) :: PDOTX0

        D2ZDPZ2 = -2.0D0*(PZ**2)*(PY*X0-PX*Y0)*COS_ALPHA*(INV_ALPHA2**2) +
     &            PZ*(8.0D0*(PZ**2)*INV_ALPHA2 - 6.0D0)*(1.0D0-COS_ALPHA)*PDOTX0*(INV_ALPHA2**2) +
     &            (3.0D0*(PZ**2)*INV_ALPHA2 - 1.0D0)*(PY*X0 - PX*Y0)*SINA_A*INV_ALPHA2 +
     &            (PY*X0-PX*Y0)*(COS_ALPHA-(PZ**2)*(COS_ALPHA*INV_ALPHA2-SINA_A))*INV_ALPHA2 +
     &            Z0*((PZ**2)*INV_ALPHA2*(SINA_A-COS_ALPHA) - SINA_A) +
     &            2.0D0*INV_ALPHA2*(1.0D0-2.0D0*(PZ**2)*INV_ALPHA2)*(Z0*(1.0D0-COS_ALPHA)+PZ*PDOTX0*SINA_A) +
     &            PZ*(2.0D0*PZ*Z0*SINA_A+PDOTX0*((PZ**2)*INV_ALPHA2*(COS_ALPHA-SINA_A)+SINA_A))*INV_ALPHA2
        
        RETURN
 
      END FUNCTION D2ZDPZ2       

! ****************************************************************************************************






