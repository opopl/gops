!   OPTIM: A PROGRAM FOR OPTIMIZING GEOMETRIES AND CALCULATING REACTION PATHWAYS
!   COPYRIGHT (C) 1999-2006 DAVID J. WALES
!   THIS FILE IS PART OF OPTIM.
!   
!   OPTIM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
!   IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
!   THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
!   (AT YOUR OPTION) ANY LATER VERSION.
!   
!   OPTIM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
!   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
!   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE
!   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.
!   
!   YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
!   ALONG WITH THIS PROGRAM; IF NOT, WRITE TO THE FREE SOFTWARE
!   FOUNDATION, INC., 59 TEMPLE PLACE, SUITE 330, BOSTON, MA  02111-1307  USA
!
SUBROUTINE EIGENSORT_VAL_ASC(EVAL, EVEC, DOF1, DOF2)
      IMPLICIT NONE

      INTEGER,INTENT(IN)         :: DOF1, DOF2
      DOUBLE PRECISION,INTENT(INOUT)  :: EVAL(DOF1), EVEC(DOF1,DOF2)

      INTEGER :: I,J,K
      DOUBLE PRECISION :: TMP 

      DO I=1,DOF1-1
         K=I
         TMP=EVAL(I)
         DO J=I+1, DOF1
            IF (EVAL(J)>=TMP) THEN
               K=J
               TMP=EVAL(J)
            ENDIF
         ENDDO
         IF (.NOT.K==I) THEN
            EVAL(K)=EVAL(I)
            EVAL(I)=TMP
            DO J=1,DOF1
               TMP = EVEC(J,I)
               EVEC(J,I) = EVEC(J,K)
               EVEC(J,K) = TMP
            ENDDO
         ENDIF
      ENDDO
 END SUBROUTINE EIGENSORT_VAL_ASC
