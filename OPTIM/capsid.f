C   OPTIM: A PROGRAM FOR OPTIMIZING GEOMETRIES AND CALCULATING REACTION PATHWAYS
C   COPYRIGHT (C) 1999-2006 DAVID J. WALES
C   THIS FILE IS PART OF OPTIM.
C   OPTIM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C   IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C   THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C   (AT YOUR OPTION) ANY LATER VERSION.
C
C   OPTIM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
C   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE
C   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C   YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C   ALONG WITH THIS PROGRAM; IF NOT, WRITE TO THE FREE SOFTWARE
C   FOUNDATION, INC., 59 TEMPLE PLACE, SUITE 330, BOSTON, MA  02111-1307  USA
C
C

C
C  ENERGY AND GRADIENT FOR RIGID BODY MOLECULE - 6-SITE VIRUS PENTAMER.
C  VARIABLES HAVE BEEN REORDERED TO THE OPTIM CONVENTION.
C
      SUBROUTINE FCAPSID(NATOMS,X,V,ECAPSID,GTEST,SECT)
      USE MODHESS
      IMPLICIT NONE
      LOGICAL GTEST,SECT
      INTEGER J1, J2, K1, K2, NATOMS, NAT2
      DOUBLE PRECISION X(3*NATOMS), V(3*NATOMS), X1, X2, Y1, Y2, Z1, Z2, FATT, DFATT, FREP, DFREP,
     1                 ECAPSID, DUMMY, EPS2, RALPHA12, RALPHA22, RDIST, SITE(6,3), DDFATT, RHO,
     2                 M1, L1, N1, M2, L2, N2, ALPHA1, RAD, CA1, CA2, ALPHA2, S1, S2, C3A1, C3A2,
     3                 L12, M12, N12, L22, M22, N22, DDFREP, DUMMY3, 
     4                 GX1, GY1, GZ1, GL1, GM1, GN1, GL2, GM2, GN2, EPSEFF, C2A2, C2A1,
     5                 D1, D2, D3, D4, D5, D6, D7, D8, D9, DA, DB, DC, DIST, DUMMY2,
     6                 P1X, P1Y, P1Z, P2X, P2Y, P2Z, XDUMM, SIGMA, HEIGHT,
     1           D1S, D2S, D3S, D4S, D5S, D6S, D7S, D8S, D9S, DAS, DBS, DCS,
     7           DD11, DD12, DD13, DD14, DD15, DD16, DD17, DD18, DD19, DD1A, DD1B, DD1C,
     7           DD22, DD23, DD24, DD25, DD26, DD27, DD28, DD29, DD2A, DD2B, DD2C,
     7           DD33, DD34, DD35, DD36, DD37, DD38, DD39, DD3A, DD3B, DD3C,
     7           DD44, DD45, DD46, DD47, DD48, DD49, DD4A, DD4B, DD4C,
     7           DD55, DD56, DD57, DD58, DD59, DD5A, DD5B, DD5C,
     7           DD66, DD67, DD68, DD69, DD6A, DD6B, DD6C,
     7           DD77, DD78, DD79, DD7A, DD7B, DD7C,
     7           DD88, DD89, DD8A, DD8B, DD8C,
     7           DD99, DD9A, DD9B, DD9C,
     7           DDAA, DDAB, DDAC,
     7           DDBB, DDBC,
     7           DDCC,
     7           S11, S12, S13, S14, S15, S16, S17, S18, S19, S1A, S1B, S1C,
     7           S22, S23, S24, S25, S26, S27, S28, S29, S2A, S2B, S2C,
     7           S33, S34, S35, S36, S37, S38, S39, S3A, S3B, S3C,
     7           S44, S45, S46, S47, S48, S49, S4A, S4B, S4C,
     7           S55, S56, S57, S58, S59, S5A, S5B, S5C,
     7           S66, S67, S68, S69, S6A, S6B, S6C,
     7           S77, S78, S79, S7A, S7B, S7C,
     7           S88, S89, S8A, S8B, S8C,
     7           S99, S9A, S9B, S9C,
     7           SAA, SAB, SAC,
     7           SBB, SBC,
     7           SCC
      LOGICAL EVAP
      COMMON /EV/ EVAP
      COMMON /CAPS/ RHO, EPS2, RAD, HEIGHT
C
C  ATTRACTIVE AND REPULSIVE FUNCTION DEFINITIONS AND THEIR DERIVATIVES.
C
      FATT(RHO,XDUMM)=-1.0D0 + (1.0D0 - EXP(RHO*(1.0D0 - XDUMM)))**2
      DFATT(RHO,XDUMM)=2.0D0*(-EXP(2.0D0*RHO*(1.0D0-XDUMM)) + EXP(RHO*(1.0D0-XDUMM)))*RHO
      DDFATT(RHO,XDUMM)=-2.0D0*(-2.0D0*EXP(2.0D0*RHO*(1.0D0-XDUMM)) + EXP(RHO*(1.0D0-XDUMM)))*RHO**2
      FREP(SIGMA,XDUMM)=(SIGMA/XDUMM)**12
      DFREP(SIGMA,XDUMM)=-12.0D0*(SIGMA/XDUMM)**12/XDUMM
      DDFREP(SIGMA,XDUMM)=156.0D0*(SIGMA/XDUMM)**12/XDUMM**2
C
C DERIVATIVES OF R(I,J) WITH RESPECT TO RIGID BODY COORDINATES.
C P(I) = (P1X,P1Y,P1Z), P(J)=(P2X,P2Y,P2Z) ARE THE SITE CORDINATES IN
C THE REFERENCE GEOMETRY FOR THE MOLECULE AT THE ORIGIN.
C
C      D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1    RDIST*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + 
C     1    M2*P2Z*S2 + X1 - X2)

C      D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1    RDIST*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + N2*P2X*S2 - 
C     1    L2*P2Z*S2 + Y1 - Y2)

C      D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1    RDIST*(C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + 
C     1    L2*P2Y*S2 + Z1 - Z2)

C      D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1      RDIST*((C3A1*(2*L1*P1X*(-1 + L12*RALPHA12) + 
C     1            (M1*P1Y + N1*P1Z)*(-1 + 2*L12*RALPHA12)) + 
C     1         (L1*L12*P1X + L12*M1*P1Y - L1*N1*P1Y + L1*M1*P1Z + L12*N1*P1Z)*
C     1          RALPHA12*S1 + L1*(C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 - P1X*S1))*
C     1       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
C     1      (C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1         C3A1*M1*(-P1X + 2*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
C     1         (-(L1*P1Y) + P1Z + L1* (L1*M1*P1X + N1*P1X + M1**2*P1Y - L1*P1Z + M1*N1*P1Z)*RALPHA12)*
C     1          S1)*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
C     1      (-(C2A1*L1*(-(M1*P1X) + L1*P1Y)*RALPHA12) + 
C     1         C3A1*N1*(-P1X + 2*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
C     1         (-P1Y - L1*P1Z + L1*(-(M1*P1X) + L1*N1*P1X + L1*P1Y + M1*N1*P1Y + N1**2*P1Z)*RALPHA12)*S1)*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
C     1         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

C      D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*((-(C2A1*M1*(-(N1*P1Y) + M1*P1Z)*RALPHA12) + 
C     1         C3A1*L1*(-P1Y + 2*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
C     1         (-(M1*P1X) - P1Z + M1* (L1**2*P1X + L1*M1*P1Y - N1*P1Y + M1*P1Z + L1*N1*P1Z)*RALPHA12)*
C     1          S1)*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (-(C3A1*(L1*P1X + 2*M1*P1Y + N1*P1Z)) + 
C     1         C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1         (-(M1*P1Y) + (L1*M12*P1X + M1*N1*P1X + M1*M12*P1Y - L1*M1*P1Z + 
C     1               M12*N1*P1Z)*RALPHA12)*S1)*
C     1       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1         C3A1*N1*(-P1Y + 2*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
C     1         (P1X - M1*(M1 - L1*N1)*P1X*RALPHA12 + 
C     1            M1*((L1 + M1*N1)*P1Y*RALPHA12 + P1Z*(-1 + N1**2*RALPHA12)))*S1)*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
C     1         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

C      D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*((C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1         C3A1*L1*(-P1Z + 2*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + (-(N1*P1X) + P1Y + N1*
C     1             (L1**2*P1X + L1*M1*P1Y - N1*P1Y + M1*P1Z + L1*N1*P1Z)*RALPHA12)*
C     1          S1)*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
C     1      (-(C2A1*N1*(N1*P1X - L1*P1Z)*RALPHA12) + 
C     1         C3A1*M1*(-P1Z + 2*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12) + 
C     1         (-P1X - N1*P1Y + N1*(L1*M1*P1X + N1*P1X + M1**2*P1Y - L1*P1Z + 
C     1               M1*N1*P1Z)*RALPHA12)*S1)*
C     1       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
C     1      (-(C3A1*(L1*P1X + M1*P1Y + 2*N1*P1Z)) + 
C     1         C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1         2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1         (-(N1*P1Z) + (-(M1*N1*P1X) + L1*N12*P1X + L1*N1*P1Y + M1*N12*P1Y + 
C     1               N1*N12*P1Z)*RALPHA12)*S1)*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
C     1         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

C      D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1   -RDIST*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + 
C     1    M2*P2Z*S2 + X1 - X2)

C      D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1   -RDIST*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + N2*P2X*S2 - 
C     1    L2*P2Z*S2 + Y1 - Y2)

C      D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1   -RDIST*(C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + 
C     1    L2*P2Y*S2 + Z1 - Z2)

C      DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1         RDIST*((C3A2*(2*L2*P2X + M2*P2Y + N2*P2Z - 
C     1            2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - 
C     1         (L2*L22*P2X + L22*M2*P2Y - L2*N2*P2Y + L2*M2*P2Z + L22*N2*P2Z)*
C     1          RALPHA22*S2 + L2*(-(C2A2*N2*P2Y*RALPHA22) + C2A2*M2*P2Z*RALPHA22 + 
C     1            P2X*S2))*(C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - 
C     1         C2A2*P2X + C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + 
C     1         (N1*P1Y - M1*P1Z)*S1 - N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + 
C     1      (-(C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22) + 
C     1         C3A2*M2*(P2X - 2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - (-(L2*P2Y) + P2Z + L2*
C     1             (L2*M2*P2X + N2*P2X + M2**2*P2Y - L2*P2Z + M2*N2*P2Z)*RALPHA22)*
C     1          S2)*(C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + 
C     1      (C2A2*L2*(-(M2*P2X) + L2*P2Y)*RALPHA22 + 
C     1         C3A2*N2*(P2X - 2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1    (P2Y + L2*P2Z - L2*(-(M2*P2X) + L2*N2*P2X + L2*P2Y + M2*N2*P2Y + N2**2*P2Z)*RALPHA22)*S2)*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

C      DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*((C2A2*M2*(-(N2*P2Y) + M2*P2Z)*RALPHA22 + 
C     1         C3A2*L2*(P2Y - 2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1         (M2*P2X + P2Z - M2*(L2**2*P2X + L2*M2*P2Y - N2*P2Y + M2*P2Z + L2*N2*P2Z)*RALPHA22)*S2)*
C     1       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (C3A2*(L2*P2X + 2*M2*P2Y + N2*P2Z - 
C     1            2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) - 
C     1         (L2*M22*P2X + M2*N2*P2X + M2*M22*P2Y - L2*M2*P2Z + M22*N2*P2Z)*
C     1          RALPHA22*S2 + M2*(C2A2*(N2*P2X - L2*P2Z)*RALPHA22 + P2Y*S2))*
C     1       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (-(C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22) + 
C     1         C3A2*N2*(P2Y - 2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1         (-P2X + M2*P2Z - M2*(-(M2*P2X) + L2*N2*P2X + L2*P2Y + M2*N2*P2Y + 
C     1               N2**2*P2Z)*RALPHA22)*S2)*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
C     1         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))

C      DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*((-(C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22) + 
C     1         C3A2*L2*(P2Z - 2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1         (N2*P2X - P2Y - N2*(L2**2*P2X + L2*M2*P2Y - N2*P2Y + M2*P2Z + L2*N2*P2Z)*RALPHA22)*S2)*
C     1       (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1         C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1         N2*P2Y*S2 + M2*P2Z*S2 + X1 - X2) + (C2A2*N2*(N2*P2X - L2*P2Z)*RALPHA22 + 
C     1         C3A2*M2*(P2Z - 2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1         (P2X + N2*P2Y - N2*(L2*M2*P2X + N2*P2X + M2**2*P2Y - L2*P2Z + M2*N2*P2Z)*RALPHA22)*S2)*
C     1       (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1         C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) - N1*P1X*S1 + L1*P1Z*S1 + 
C     1         N2*P2X*S2 - L2*P2Z*S2 + Y1 - Y2) + (C3A2*(L2*P2X + M2*P2Y + 2*N2*P2Z - 
C     1            2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22) + 
C     1         (N2*(M2*P2X - L2*P2Y) - N22*(L2*P2X + M2*P2Y + N2*P2Z))*RALPHA22*
C     1          S2 + N2*(-(C2A2*M2*P2X*RALPHA22) + C2A2*L2*P2Y*RALPHA22 + P2Z*S2))*
C     1       (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1         C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + M1*P1X*S1 - L1*P1Y*S1 - 
C     1         M2*P2X*S2 + L2*P2Y*S2 + Z1 - Z2))
C 
C  SECOND DERIVATIVES OF R(I,J) WITH RESPECT TO RIGID BODY COORDINATES.
C 

C      DD11(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD12(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD13(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD14(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1  RDIST*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1 L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD15(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*(-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - P1Z*S1 - 
C     1 M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD16(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 RDIST*(-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + P1Y*S1 - 
C     1 N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD17(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = -RDIST
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD18(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD19(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD1A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1 L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD1B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + P2Z*S2 + 
C     1 M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD1C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - P2Y*S2 + 
C     1 N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD22(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD23(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD24(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + P1Z*S1 - 
C     1 L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD25(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1 M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD26(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - N1*P1Y*S1 - 
C     1 N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD27(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD28(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = -RDIST
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD29(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 0
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD2A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - P2Z*S2 + 
C     1 L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD2B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1 M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD2C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + N2*P2Y*S2 + 
C     1 N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD33(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD34(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - L1*P1Z*S1 - 
C     1 L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD35(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - M1*P1Z*S1 - 
C     1 M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD36(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1 N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD37(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD38(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD39(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = -RDIST
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD3A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + L2*P2Z*S2 + 
C     1 L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD3B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + M2*P2Z*S2 + 
C     1 M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD3C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = RDIST*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1 N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)
C     1 -D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD44(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1     C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1     2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1     L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1     L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1     2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1     P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1     L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1     2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1     L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1     L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-2*C3A1*P1X - (3*C2A1*L12*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*L12*P1X*RALPHA12 + 4*C3A1*L12*P1X*RALPHA12 + 
C     1    C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    6*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
C     1    (3*L12*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    3*L12*P1X*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
C     1    L12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    3*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((-3*C2A1*L12*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    4*C3A1*L1*M1*P1X*RALPHA12 - C2A1*L12*P1Y*RALPHA12 + 
C     1    2*C2A1*L1*P1Z*RALPHA12 + C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
C     1    (3*L12*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    2*L1*M1*P1X*RALPHA12*S1 + L12*P1Y*RALPHA12*S1 - 
C     1    2*L1*P1Z*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
C     1    L12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((-3*C2A1*L12*(M1*P1X - L1*P1Y))/ALPHA1**4 + 
C     1    (C2A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    4*C3A1*L1*N1*P1X*RALPHA12 - 2*C2A1*L1*P1Y*RALPHA12 + 
C     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*L12*P1Z*RALPHA12 + 
C     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*L12*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - P1Z*S1 - 
C     1    (5*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    2*L1*N1*P1X*RALPHA12*S1 + 2*L1*P1Y*RALPHA12*S1 - 
C     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
C     1    L12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + L12*P1Z*RALPHA12*S1 + 
C     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD45(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*P1Y) - (3*C2A1*L1*M1*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*L1*M1*P1X*RALPHA12 + 2*C3A1*L1*M1*P1X*RALPHA12 + 
C     1    2*C3A1*L12*P1Y*RALPHA12 - C2A1*L1*P1Z*RALPHA12 + 
C     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*L1*M1*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L12*M1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    2*L1*M1*P1X*RALPHA12*S1 + L12*P1Y*RALPHA12*S1 + 
C     1    L1*P1Z*RALPHA12*S1 - L1*M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(-(C3A1*P1X) - (3*C2A1*L1*M1*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    2*C3A1*M12*P1X*RALPHA12 - C2A1*L1*M1*P1Y*RALPHA12 + 
C     1    2*C3A1*L1*M1*P1Y*RALPHA12 + C2A1*M1*P1Z*RALPHA12 + 
C     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*L1*M1*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    M12*P1X*RALPHA12*S1 + 2*L1*M1*P1Y*RALPHA12*S1 - 
C     1    M1*P1Z*RALPHA12*S1 - L1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((-3*C2A1*L1*M1*(M1*P1X - L1*P1Y))/ALPHA1**4 + 
C     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    C2A1*L1*P1X*RALPHA12 + 2*C3A1*M1*N1*P1X*RALPHA12 - 
C     1    C2A1*M1*P1Y*RALPHA12 + 2*C3A1*L1*N1*P1Y*RALPHA12 - 
C     1    C2A1*L1*M1*P1Z*RALPHA12 + 
C     1    (3*L1*M1*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - 
C     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 - 
C     1    L1*P1X*RALPHA12*S1 + M1*N1*P1X*RALPHA12*S1 + M1*P1Y*RALPHA12*S1 + 
C     1    L1*N1*P1Y*RALPHA12*S1 - L1*M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*M1*P1Z*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*RDIST

C      DD46(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*P1Z) - (3*C2A1*L1*N1*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*L1*N1*P1X*RALPHA12 + 2*C3A1*L1*N1*P1X*RALPHA12 + 
C     1    C2A1*L1*P1Y*RALPHA12 + 2*C3A1*L12*P1Z*RALPHA12 + 
C     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*L1*N1*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    2*L1*N1*P1X*RALPHA12*S1 - L1*P1Y*RALPHA12*S1 + 
C     1    L12*P1Z*RALPHA12*S1 - L1*N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((-3*C2A1*L1*N1*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*L1*P1X*RALPHA12 + 2*C3A1*M1*N1*P1X*RALPHA12 - 
C     1    C2A1*L1*N1*P1Y*RALPHA12 + 2*C3A1*L1*M1*P1Z*RALPHA12 + 
C     1    C2A1*N1*P1Z*RALPHA12 + 
C     1    (3*L1*N1*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    L1*P1X*RALPHA12*S1 + M1*N1*P1X*RALPHA12*S1 + 
C     1    L1*N1*P1Y*RALPHA12*S1 + L1*M1*P1Z*RALPHA12*S1 - 
C     1    N1*P1Z*RALPHA12*S1 - L1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*(-(C3A1*P1X) - (3*C2A1*L1*N1*(M1*P1X - L1*P1Y))/ALPHA1**4 + 
C     1    (C2A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    2*C3A1*N12*P1X*RALPHA12 - C2A1*N1*P1Y*RALPHA12 - 
C     1    C2A1*L1*N1*P1Z*RALPHA12 + 2*C3A1*L1*N1*P1Z*RALPHA12 + 
C     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*L1*N1*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - 
C     1    (5*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    N12*P1X*RALPHA12*S1 + N1*P1Y*RALPHA12*S1 - 
C     1    L1*N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 2*L1*N1*P1Z*RALPHA12*S1 + 
C     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD47(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1 L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD48(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1 P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD49(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1 L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD4A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD4B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD4C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1X) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*L1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1X*S1 - 
C     1    L1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1X) + C2A1*L1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - L1*P1Y*S1 + 
C     1    P1Z*S1 - L1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1X) + C2A1*L1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 - 
C     1    L1*P1Z*S1 - L1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD55(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
C     1     C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1     2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1     P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1     L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1     C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1     2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1     M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1     M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1     2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1     M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1     M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*((-3*C2A1*M12*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*M12*P1X*RALPHA12 + 4*C3A1*L1*M1*P1Y*RALPHA12 - 
C     1    2*C2A1*M1*P1Z*RALPHA12 + C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
C     1    (3*M12*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    M12*P1X*RALPHA12*S1 + 2*L1*M1*P1Y*RALPHA12*S1 + 
C     1    2*M1*P1Z*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
C     1    M12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(-2*C3A1*P1Y - (3*C2A1*M12*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*M1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*M1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*M12*P1Y*RALPHA12 + 4*C3A1*M12*P1Y*RALPHA12 + 
C     1    C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    6*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
C     1    (3*M12*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*M1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    3*M12*P1Y*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
C     1    M12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    3*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((-3*C2A1*M12*(M1*P1X - L1*P1Y))/ALPHA1**4 + 
C     1    (C2A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    2*C2A1*M1*P1X*RALPHA12 + 4*C3A1*M1*N1*P1Y*RALPHA12 + 
C     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*M12*P1Z*RALPHA12 + 
C     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*M12*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - P1Z*S1 - 
C     1    (5*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 - 
C     1    2*M1*P1X*RALPHA12*S1 + 2*M1*N1*P1Y*RALPHA12*S1 - 
C     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
C     1    M12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + M12*P1Z*RALPHA12*S1 + 
C     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD56(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
C     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1) + 
C     1 2*((-3*C2A1*M1*N1*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*M1*N1*P1X*RALPHA12 + C2A1*M1*P1Y*RALPHA12 + 
C     1    2*C3A1*L1*N1*P1Y*RALPHA12 + 2*C3A1*L1*M1*P1Z*RALPHA12 - 
C     1    C2A1*N1*P1Z*RALPHA12 + 
C     1    (3*M1*N1*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    M1*N1*P1X*RALPHA12*S1 - M1*P1Y*RALPHA12*S1 + 
C     1    L1*N1*P1Y*RALPHA12*S1 + L1*M1*P1Z*RALPHA12*S1 + 
C     1    N1*P1Z*RALPHA12*S1 - M1*N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(-(C3A1*P1Z) - (3*C2A1*M1*N1*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*M1*P1X*RALPHA12 - C2A1*M1*N1*P1Y*RALPHA12 + 
C     1    2*C3A1*M1*N1*P1Y*RALPHA12 + 2*C3A1*M12*P1Z*RALPHA12 + 
C     1    2*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*M1*N1*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*M12*N1*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    M1*P1X*RALPHA12*S1 + 2*M1*N1*P1Y*RALPHA12*S1 + 
C     1    M12*P1Z*RALPHA12*S1 - M1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*(-(C3A1*P1Y) - (3*C2A1*M1*N1*(M1*P1X - L1*P1Y))/ALPHA1**4 + 
C     1    (C2A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    C2A1*N1*P1X*RALPHA12 + 2*C3A1*N12*P1Y*RALPHA12 - 
C     1    C2A1*M1*N1*P1Z*RALPHA12 + 2*C3A1*M1*N1*P1Z*RALPHA12 + 
C     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*M1*N1*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - 
C     1    (5*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 - 
C     1    N1*P1X*RALPHA12*S1 + N12*P1Y*RALPHA12*S1 - 
C     1    M1*N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 2*M1*N1*P1Z*RALPHA12*S1 + 
C     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD57(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*L1*P1Y) + C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1 P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD58(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1 M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD59(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1 M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD5A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
C     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD5B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
C     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD5C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Y) + 
C     1    C2A1*M1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1X*S1 - 
C     1    P1Z*S1 - M1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Y) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*M1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - M1*P1Y*S1 - 
C     1    M1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Y) + C2A1*M1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + P1X*S1 - 
C     1    M1*P1Z*S1 - M1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD66(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
C     1     C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1     2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1     P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1     L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1     2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1     N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1     M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1     C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1     2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1     N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1     N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)**2 + 
C     1 2*((-3*C2A1*N12*(N1*P1Y - M1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    C2A1*N12*P1X*RALPHA12 + 2*C2A1*N1*P1Y*RALPHA12 + 
C     1    4*C3A1*L1*N1*P1Z*RALPHA12 + C2A1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 + 
C     1    (3*N12*(N1*P1Y - M1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*L1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    N12*P1X*RALPHA12*S1 - 2*N1*P1Y*RALPHA12*S1 + 
C     1    2*L1*N1*P1Z*RALPHA12*S1 - (N1*P1Y - M1*P1Z)*RALPHA12*S1 - 
C     1    N12*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((-3*C2A1*N12*(-(N1*P1X) + L1*P1Z))/ALPHA1**4 + 
C     1    (C2A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    2*C2A1*N1*P1X*RALPHA12 - C2A1*N12*P1Y*RALPHA12 + 
C     1    4*C3A1*M1*N1*P1Z*RALPHA12 + C2A1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1Y*S1 + 
C     1    (3*N12*(-(N1*P1X) + L1*P1Z)*S1)/ALPHA1**4 - 
C     1    (5*M1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 + 
C     1    2*N1*P1X*RALPHA12*S1 + N12*P1Y*RALPHA12*S1 + 
C     1    2*M1*N1*P1Z*RALPHA12*S1 - (-(N1*P1X) + L1*P1Z)*RALPHA12*S1 - 
C     1    N12*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((-3*C2A1*N12*(M1*P1X - L1*P1Y))/ALPHA1**4 - 2*C3A1*P1Z + 
C     1    (C2A1*N1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 - 
C     1    (8*C3A1*N1**3*(L1*P1X + M1*P1Y + N1*P1Z))/ALPHA1**4 + 
C     1    C2A1*(M1*P1X - L1*P1Y)*RALPHA12 - C2A1*N12*P1Z*RALPHA12 + 
C     1    4*C3A1*N12*P1Z*RALPHA12 + 
C     1    6*C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 + 
C     1    (3*N12*(M1*P1X - L1*P1Y)*S1)/ALPHA1**4 - P1Z*S1 - 
C     1    (5*N1**3*(L1*P1X + M1*P1Y + N1*P1Z)*S1)/ALPHA1**4 - 
C     1    (M1*P1X - L1*P1Y)*RALPHA12*S1 - 
C     1    N12*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 3*N12*P1Z*RALPHA12*S1 + 
C     1    3*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD67(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*L1*P1Z) + C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1 2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1 P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1 L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD68(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1 2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1 N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1 M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD69(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1 C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1 2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1 N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1 N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1))
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD6A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
C     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD6B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
C     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD6C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(-(C3A1*L1*P1Z) + 
C     1    C2A1*N1*(N1*P1Y - M1*P1Z)*RALPHA12 + 
C     1    2*C3A1*L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1X*S1 + 
C     1    P1Y*S1 - N1*(N1*P1Y - M1*P1Z)*RALPHA12*S1 + 
C     1    L1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*M1*P1Z) + C2A1*N1*(-(N1*P1X) + L1*P1Z)*RALPHA12 + 
C     1    2*C3A1*M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - P1X*S1 - 
C     1    N1*P1Y*S1 - N1*(-(N1*P1X) + L1*P1Z)*RALPHA12*S1 + 
C     1    M1*N1*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(-(C3A1*N1*P1Z) - C3A1*(L1*P1X + M1*P1Y + N1*P1Z) + 
C     1    C2A1*N1*(M1*P1X - L1*P1Y)*RALPHA12 + 
C     1    2*C3A1*N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12 - N1*P1Z*S1 - 
C     1    N1*(M1*P1X - L1*P1Y)*RALPHA12*S1 + 
C     1    N12*(L1*P1X + M1*P1Y + N1*P1Z)*RALPHA12*S1)*
C     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)))/2.
C     1 -D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD77(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD78(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = 
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD79(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) =
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD7A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1 L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD7B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1 P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD7C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1 P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD88(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD89(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) =
C     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD8A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1 P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD8B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1 M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD8C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1 N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD99(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) = RDIST
C     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD9A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1 L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD9B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1 M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DD9C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = -(RDIST*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1 C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1 2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1 N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1 N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2))
C     1 -D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDAA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1     C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1     2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1     L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1     L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1     2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1     P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1     L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1     2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1     L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1     L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(2*C3A2*P2X + (3*C2A2*L22*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*L22*P2X*RALPHA22 - 4*C3A2*L22*P2X*RALPHA22 - 
C     1    C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    6*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
C     1    (3*L22*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    3*L22*P2X*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
C     1    L22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    3*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((3*C2A2*L22*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    4*C3A2*L2*M2*P2X*RALPHA22 + C2A2*L22*P2Y*RALPHA22 - 
C     1    2*C2A2*L2*P2Z*RALPHA22 - C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
C     1    (3*L22*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    2*L2*M2*P2X*RALPHA22*S2 - L22*P2Y*RALPHA22*S2 + 
C     1    2*L2*P2Z*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
C     1    L22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((3*C2A2*L22*(M2*P2X - L2*P2Y))/ALPHA2**4 - 
C     1    (C2A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    4*C3A2*L2*N2*P2X*RALPHA22 + 2*C2A2*L2*P2Y*RALPHA22 - 
C     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*L22*P2Z*RALPHA22 - 
C     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*L22*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + P2Z*S2 + 
C     1    (5*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    2*L2*N2*P2X*RALPHA22*S2 - 2*L2*P2Y*RALPHA22*S2 + 
C     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
C     1    L22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - L22*P2Z*RALPHA22*S2 - 
C     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDAB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*P2Y + (3*C2A2*L2*M2*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*L2*M2*P2X*RALPHA22 - 2*C3A2*L2*M2*P2X*RALPHA22 - 
C     1    2*C3A2*L22*P2Y*RALPHA22 + C2A2*L2*P2Z*RALPHA22 - 
C     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*L2*M2*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L22*M2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    2*L2*M2*P2X*RALPHA22*S2 - L22*P2Y*RALPHA22*S2 - 
C     1    L2*P2Z*RALPHA22*S2 + L2*M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(C3A2*P2X + (3*C2A2*L2*M2*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    2*C3A2*M22*P2X*RALPHA22 + C2A2*L2*M2*P2Y*RALPHA22 - 
C     1    2*C3A2*L2*M2*P2Y*RALPHA22 - C2A2*M2*P2Z*RALPHA22 - 
C     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*L2*M2*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    M22*P2X*RALPHA22*S2 - 2*L2*M2*P2Y*RALPHA22*S2 + 
C     1    M2*P2Z*RALPHA22*S2 + L2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((3*C2A2*L2*M2*(M2*P2X - L2*P2Y))/ALPHA2**4 - 
C     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    C2A2*L2*P2X*RALPHA22 - 2*C3A2*M2*N2*P2X*RALPHA22 + 
C     1    C2A2*M2*P2Y*RALPHA22 - 2*C3A2*L2*N2*P2Y*RALPHA22 + 
C     1    C2A2*L2*M2*P2Z*RALPHA22 - 
C     1    (3*L2*M2*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + 
C     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 + 
C     1    L2*P2X*RALPHA22*S2 - M2*N2*P2X*RALPHA22*S2 - M2*P2Y*RALPHA22*S2 - 
C     1    L2*N2*P2Y*RALPHA22*S2 + L2*M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*M2*P2Z*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDAC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2X + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*L2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2X*S2 + 
C     1    L2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*M2*P2X - C2A2*L2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + L2*P2Y*S2 - 
C     1    P2Z*S2 + L2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*N2*P2X - C2A2*L2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 + 
C     1    L2*P2Z*S2 + L2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*P2Z + (3*C2A2*L2*N2*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*L2*N2*P2X*RALPHA22 - 2*C3A2*L2*N2*P2X*RALPHA22 - 
C     1    C2A2*L2*P2Y*RALPHA22 - 2*C3A2*L22*P2Z*RALPHA22 - 
C     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*L2*N2*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    2*L2*N2*P2X*RALPHA22*S2 + L2*P2Y*RALPHA22*S2 - 
C     1    L22*P2Z*RALPHA22*S2 + L2*N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((3*C2A2*L2*N2*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*L2*P2X*RALPHA22 - 2*C3A2*M2*N2*P2X*RALPHA22 + 
C     1    C2A2*L2*N2*P2Y*RALPHA22 - 2*C3A2*L2*M2*P2Z*RALPHA22 - 
C     1    C2A2*N2*P2Z*RALPHA22 - 
C     1    (3*L2*N2*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    L2*P2X*RALPHA22*S2 - M2*N2*P2X*RALPHA22*S2 - 
C     1    L2*N2*P2Y*RALPHA22*S2 - L2*M2*P2Z*RALPHA22*S2 + 
C     1    N2*P2Z*RALPHA22*S2 + L2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*(C3A2*P2X + (3*C2A2*L2*N2*(M2*P2X - L2*P2Y))/ALPHA2**4 - 
C     1    (C2A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    2*C3A2*N22*P2X*RALPHA22 + C2A2*N2*P2Y*RALPHA22 + 
C     1    C2A2*L2*N2*P2Z*RALPHA22 - 2*C3A2*L2*N2*P2Z*RALPHA22 - 
C     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*L2*N2*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + 
C     1    (5*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    N22*P2X*RALPHA22*S2 - N2*P2Y*RALPHA22*S2 + 
C     1    L2*N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 2*L2*N2*P2Z*RALPHA22*S2 - 
C     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDBB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1     2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1     P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1     L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1     C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1     2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1     M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1     M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1     2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1     M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1     M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*((3*C2A2*M22*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*M22*P2X*RALPHA22 - 4*C3A2*L2*M2*P2Y*RALPHA22 + 
C     1    2*C2A2*M2*P2Z*RALPHA22 - C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
C     1    (3*M22*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    M22*P2X*RALPHA22*S2 - 2*L2*M2*P2Y*RALPHA22*S2 - 
C     1    2*M2*P2Z*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
C     1    M22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(2*C3A2*P2Y + (3*C2A2*M22*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*M2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*M2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*M22*P2Y*RALPHA22 - 4*C3A2*M22*P2Y*RALPHA22 - 
C     1    C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    6*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
C     1    (3*M22*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*M2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    3*M22*P2Y*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
C     1    M22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    3*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((3*C2A2*M22*(M2*P2X - L2*P2Y))/ALPHA2**4 - 
C     1    (C2A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    2*C2A2*M2*P2X*RALPHA22 - 4*C3A2*M2*N2*P2Y*RALPHA22 - 
C     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*M22*P2Z*RALPHA22 - 
C     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*M22*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + P2Z*S2 + 
C     1    (5*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 + 
C     1    2*M2*P2X*RALPHA22*S2 - 2*M2*N2*P2Y*RALPHA22*S2 + 
C     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
C     1    M22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - M22*P2Z*RALPHA22*S2 - 
C     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDBC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2Y - C2A2*M2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2X*S2 + 
C     1    P2Z*S2 + M2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1    P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*M2*P2Y + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*M2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + M2*P2Y*S2 + 
C     1    M2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1    N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*(C3A2*N2*P2Y - C2A2*M2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - P2X*S2 + 
C     1    M2*P2Z*S2 + M2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1    C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1    2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1    N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1    N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2) + 
C     1 2*((3*C2A2*M2*N2*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*M2*N2*P2X*RALPHA22 - C2A2*M2*P2Y*RALPHA22 - 
C     1    2*C3A2*L2*N2*P2Y*RALPHA22 - 2*C3A2*L2*M2*P2Z*RALPHA22 + 
C     1    C2A2*N2*P2Z*RALPHA22 - 
C     1    (3*M2*N2*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    M2*N2*P2X*RALPHA22*S2 + M2*P2Y*RALPHA22*S2 - 
C     1    L2*N2*P2Y*RALPHA22*S2 - L2*M2*P2Z*RALPHA22*S2 - 
C     1    N2*P2Z*RALPHA22*S2 + M2*N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*(C3A2*P2Z + (3*C2A2*M2*N2*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*M2*P2X*RALPHA22 + C2A2*M2*N2*P2Y*RALPHA22 - 
C     1    2*C3A2*M2*N2*P2Y*RALPHA22 - 2*C3A2*M22*P2Z*RALPHA22 - 
C     1    2*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*M2*N2*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*M22*N2*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    M2*P2X*RALPHA22*S2 - 2*M2*N2*P2Y*RALPHA22*S2 - 
C     1    M22*P2Z*RALPHA22*S2 + M2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*(C3A2*P2Y + (3*C2A2*M2*N2*(M2*P2X - L2*P2Y))/ALPHA2**4 - 
C     1    (C2A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    C2A2*N2*P2X*RALPHA22 - 2*C3A2*N22*P2Y*RALPHA22 + 
C     1    C2A2*M2*N2*P2Z*RALPHA22 - 2*C3A2*M2*N2*P2Z*RALPHA22 - 
C     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*M2*N2*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + 
C     1    (5*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 + 
C     1    N2*P2X*RALPHA22*S2 - N22*P2Y*RALPHA22*S2 + 
C     1    M2*N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 2*M2*N2*P2Z*RALPHA22*S2 - 
C     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1 DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST

C      DDCC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST) 
C     1 = (RDIST*(2*(C3A2*L2*P2Z - C2A2*N2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1     2*C3A2*L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2X*S2 - 
C     1     P2Y*S2 + N2*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1     L2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*M2*P2Z - C2A2*N2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1     2*C3A2*M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 + 
C     1     N2*P2Y*S2 + N2*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1     M2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*(C3A2*N2*P2Z + C3A2*(L2*P2X + M2*P2Y + N2*P2Z) - 
C     1     C2A2*N2*(M2*P2X - L2*P2Y)*RALPHA22 - 
C     1     2*C3A2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + N2*P2Z*S2 + 
C     1     N2*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 
C     1     N22*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)**2 + 
C     1 2*((3*C2A2*N22*(N2*P2Y - M2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    C2A2*N22*P2X*RALPHA22 - 2*C2A2*N2*P2Y*RALPHA22 - 
C     1    4*C3A2*L2*N2*P2Z*RALPHA22 - C2A2*(N2*P2Y - M2*P2Z)*RALPHA22 - 
C     1    2*C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2X*S2 - 
C     1    (3*N22*(N2*P2Y - M2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*L2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    N22*P2X*RALPHA22*S2 + 2*N2*P2Y*RALPHA22*S2 - 
C     1    2*L2*N2*P2Z*RALPHA22*S2 + (N2*P2Y - M2*P2Z)*RALPHA22*S2 + 
C     1    N22*(N2*P2Y - M2*P2Z)*RALPHA22*S2 - 
C     1    L2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1X - C3A1*L1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2X + 
C     1    C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z) + (N1*P1Y - M1*P1Z)*S1 - 
C     1    (N2*P2Y - M2*P2Z)*S2 + X1 - X2) + 
C     1 2*((3*C2A2*N22*(-(N2*P2X) + L2*P2Z))/ALPHA2**4 - 
C     1    (C2A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    2*C2A2*N2*P2X*RALPHA22 + C2A2*N22*P2Y*RALPHA22 - 
C     1    4*C3A2*M2*N2*P2Z*RALPHA22 - C2A2*(-(N2*P2X) + L2*P2Z)*RALPHA22 - 
C     1    2*C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 + P2Y*S2 - 
C     1    (3*N22*(-(N2*P2X) + L2*P2Z)*S2)/ALPHA2**4 + 
C     1    (5*M2*N22*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 - 
C     1    2*N2*P2X*RALPHA22*S2 - N22*P2Y*RALPHA22*S2 - 
C     1    2*M2*N2*P2Z*RALPHA22*S2 + (-(N2*P2X) + L2*P2Z)*RALPHA22*S2 + 
C     1    N22*(-(N2*P2X) + L2*P2Z)*RALPHA22*S2 - 
C     1    M2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y + 
C     1    C3A2*M2*(L2*P2X + M2*P2Y + N2*P2Z) + (-(N1*P1X) + L1*P1Z)*S1 - 
C     1    (-(N2*P2X) + L2*P2Z)*S2 + Y1 - Y2) + 
C     1 2*((3*C2A2*N22*(M2*P2X - L2*P2Y))/ALPHA2**4 + 2*C3A2*P2Z - 
C     1    (C2A2*N2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 + 
C     1    (8*C3A2*N2**3*(L2*P2X + M2*P2Y + N2*P2Z))/ALPHA2**4 - 
C     1    C2A2*(M2*P2X - L2*P2Y)*RALPHA22 + C2A2*N22*P2Z*RALPHA22 - 
C     1    4*C3A2*N22*P2Z*RALPHA22 - 
C     1    6*C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22 - 
C     1    (3*N22*(M2*P2X - L2*P2Y)*S2)/ALPHA2**4 + P2Z*S2 + 
C     1    (5*N2**3*(L2*P2X + M2*P2Y + N2*P2Z)*S2)/ALPHA2**4 + 
C     1    (M2*P2X - L2*P2Y)*RALPHA22*S2 + 
C     1    N22*(M2*P2X - L2*P2Y)*RALPHA22*S2 - 3*N22*P2Z*RALPHA22*S2 - 
C     1    3*N2*(L2*P2X + M2*P2Y + N2*P2Z)*RALPHA22*S2)*
C     1  (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z + 
C     1    C3A2*N2*(L2*P2X + M2*P2Y + N2*P2Z) + (M1*P1X - L1*P1Y)*S1 - 
C     1    (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)))/2.
C     1 -DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)*
C     1  DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST)* RDIST
C
C  THE SIX REFERENCE SITE POSITIONS PER CAPPED PENTAGON. THESE NEED TO
C  BE MULTIPLIED BY RAD.
C
      SITE(1,1)=1.0D0
      SITE(1,2)=0.0D0
      SITE(1,3)=0.0D0
      SITE(2,1)=((-1.0D0 + SQRT(5.0D0)))/4.0D0
      SITE(2,2)=(SQRT((5.0D0 + SQRT(5.0D0))/2.0D0))/2.0D0
      SITE(2,3)=0.0D0
      SITE(3,1)=((-1.0D0 - SQRT(5.0D0)))/4.0D0
      SITE(3,2)=(SQRT((5.0D0 - SQRT(5.0D0))/2.0D0))/2.0D0
      SITE(3,3)=0.0D0
      SITE(4,1)=((-1 - SQRT(5.0D0)))/4.0D0
      SITE(4,2)=-(SQRT((5.0D0 - SQRT(5.0D0))/2.))/2.0D0
      SITE(4,3)=0.0D0
      SITE(5,1)=((-1 + SQRT(5.0D0)))/4.0D0
      SITE(5,2)=-(SQRT((5.0D0 + SQRT(5.0D0))/2.))/2.0D0
      SITE(5,3)=0.0D0
      SITE(6,1)=0.0D0
      SITE(6,2)=0.0D0
      SITE(6,3)=HEIGHT

      NAT2=NATOMS/2
      EVAP=.FALSE.
      ECAPSID=0.0D0
      DO J1=1,3*NATOMS
         V(J1)=0.0D0
         IF (SECT) THEN
            DO J2=1,3*NATOMS
               HESS(J2,J1)=0.0D0
            ENDDO
         ENDIF
      ENDDO
      
C     EPSEFF=EPS2*(1.0D0+RAD*SQRT((5.0D0+SQRT(5.0D0))/2.0D0))**12
      SIGMA=(1.0D0+RAD*SQRT((5.0D0+SQRT(5.0D0))/2.0D0))
      EPSEFF=EPS2
C     WRITE(*,'(A,4G15.5)') 'RHO,RAD,EPS2,EPSEFF=',RHO,RAD,EPS2,EPSEFF
C
C  POTENTIAL ENERGY FIRST.
C
      DO J1=1,NAT2-1
         X1=X(3*(J1-1)+1)
         Y1=X(3*(J1-1)+2)
         Z1=X(3*(J1-1)+3)
         L1=X(3*(NAT2+J1-1)+1)
         M1=X(3*(NAT2+J1-1)+2)
         N1=X(3*(NAT2+J1-1)+3)
         L12=L1**2
         M12=M1**2
         N12=N1**2
         ALPHA1=SQRT(L12+M12+N12)
         RALPHA12=1.0D0/MAX(ALPHA1**2,1.0D-10)
         CA1=COS(ALPHA1)
         C2A1=CA1
         IF (ALPHA1.LT.0.0001D0) THEN
C           C3A1=-ALPHA1/2+ALPHA1**3/24 ! BUG SPOTTED BY TIM!
            C3A1=-0.5D0+ALPHA1**2/24.0D0
            S1=1.0D0-ALPHA1**2/6
         ELSE
            C3A1=(CA1-1.0D0)/ALPHA1**2
            S1=SIN(ALPHA1)/ALPHA1
         ENDIF
C        WRITE(*,'(A,6F15.5)') 'ALPHA1,RALPHA12,CA1,C2A1,C3A1,S1=',ALPHA1,RALPHA12,CA1,C2A1,C3A1,S1
         DO J2=J1+1,NAT2
            X2=X(3*(J2-1)+1)
            Y2=X(3*(J2-1)+2)
            Z2=X(3*(J2-1)+3)
            L2=X(3*(NAT2+J2-1)+1)
            M2=X(3*(NAT2+J2-1)+2)
            N2=X(3*(NAT2+J2-1)+3)
            L22=L2**2
            M22=M2**2
            N22=N2**2
            ALPHA2=SQRT(L22+M22+N22)
            RALPHA22=1.0D0/MAX(ALPHA2**2,1.0D-10)
            CA2=COS(ALPHA2)
            C2A2=CA2
            IF (ALPHA2.LT.0.0001D0) THEN
C              C3A2=-ALPHA2/2+ALPHA2**3/24 ! BUG SPOTTED BY TIM!
               C3A2=-0.5D0+ALPHA2**2/24.0D0 ! BUG SPOTTED BY TIM!
               S2=1.0D0-ALPHA2**2/6
            ELSE
               C3A2=(CA2-1.0D0)/ALPHA2**2
               S2=SIN(ALPHA2)/ALPHA2
            ENDIF
C
C  REPULSIVE SITE CONTRIBUTION.
C
            P1X=SITE(6,1)*RAD
            P1Y=SITE(6,2)*RAD
            P1Z=SITE(6,3)*RAD
            P2X=SITE(6,1)*RAD
            P2Y=SITE(6,2)*RAD
            P2Z=SITE(6,3)*RAD
            DIST= 
     1  SQRT((C2A1*P1X-C3A1*L1*(L1*P1X+M1*P1Y+N1*P1Z)-C2A2*P2X+C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)+ 
     1      (N1*P1Y - M1*P1Z)*S1 - (N2*P2Y - M2*P2Z)*S2 + X1 - X2)**2 + 
     1   (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y+C3A2*M2*(L2*P2X+M2*P2Y+N2*P2Z)+ 
     1      (-(N1*P1X) + L1*P1Z)*S1 - (-(N2*P2X) + L2*P2Z)*S2 + Y1-Y2)**2 + 
     1   (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z+C3A2*N2*(L2*P2X+M2*P2Y+N2*P2Z)+ 
     1      (M1*P1X - L1*P1Y)*S1 - (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)**2)
C           PRINT*,'COORDINATES OF PENTAMER PAIR:'
C           WRITE(*,'(3F20.10)') X1,Y1,Z1
C           WRITE(*,'(3F20.10)') L1,M1,N1
C           WRITE(*,'(3F20.10)') X2,Y2,Z2
C           WRITE(*,'(3F20.10)') L2,M2,N2
C           PRINT*,'EPSEFF,DISTANCE=',EPSEFF,DIST
            DUMMY=EPSEFF*FREP(SIGMA,DIST)
            IF (GTEST.OR.SECT) THEN
               DUMMY2=EPSEFF*DFREP(SIGMA,DIST)
               RDIST=1.0D0/DIST
               D1S=D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D2S=D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D3S=D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D4S=D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D5S=D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D6S=D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               D7S=-D1S
               D8S=-D2S
               D9S=-D3S
               DAS=DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               DBS=DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               DCS=DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
               GX1=DUMMY2*D1S
               GY1=DUMMY2*D2S
               GZ1=DUMMY2*D3S
               GL1=DUMMY2*D4S
               GM1=DUMMY2*D5S
               GN1=DUMMY2*D6S
               GL2=DUMMY2*DAS
               GM2=DUMMY2*DBS
               GN2=DUMMY2*DCS
            ENDIF
            IF (SECT) THEN
               DUMMY2=EPSEFF*DFREP(SIGMA,DIST)
               DUMMY3=EPSEFF*DDFREP(SIGMA,DIST)
               RDIST=1.0D0/DIST

               S11=DUMMY2*DD11(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D1S
               S12=DUMMY2*DD12(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D2S
               S13=DUMMY2*DD13(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D3S
               S14=DUMMY2*DD14(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D4S
               S15=DUMMY2*DD15(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D5S
               S16=DUMMY2*DD16(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D6S
               S17=DUMMY2*DD17(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D7S
               S18=DUMMY2*DD18(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D8S
               S19=DUMMY2*DD19(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D9S
               S1A=DUMMY2*DD1A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DAS
               S1B=DUMMY2*DD1B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DBS
               S1C=DUMMY2*DD1C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DCS
               S22=DUMMY2*DD22(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D2S
               S23=DUMMY2*DD23(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D3S
               S24=DUMMY2*DD24(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D4S
               S25=DUMMY2*DD25(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D5S
               S26=DUMMY2*DD26(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D6S
               S27=DUMMY2*DD27(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D7S
               S28=DUMMY2*DD28(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D8S
               S29=DUMMY2*DD29(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D9S
               S2A=DUMMY2*DD2A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DAS
               S2B=DUMMY2*DD2B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DBS
               S2C=DUMMY2*DD2C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DCS
               S33=DUMMY2*DD33(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D3S
               S34=DUMMY2*DD34(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D4S
               S35=DUMMY2*DD35(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D5S
               S36=DUMMY2*DD36(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D6S
               S37=DUMMY2*DD37(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D7S
               S38=DUMMY2*DD38(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D8S
               S39=DUMMY2*DD39(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D9S
               S3A=DUMMY2*DD3A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DAS
               S3B=DUMMY2*DD3B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DBS
               S3C=DUMMY2*DD3C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DCS
               S44=DUMMY2*DD44(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D4S
               S45=DUMMY2*DD45(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D5S
               S46=DUMMY2*DD46(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D6S
               S47=DUMMY2*DD47(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D7S
               S48=DUMMY2*DD48(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D8S
               S49=DUMMY2*DD49(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D9S
               S4A=DUMMY2*DD4A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DAS
               S4B=DUMMY2*DD4B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DBS
               S4C=DUMMY2*DD4C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DCS
               S55=DUMMY2*DD55(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D5S
               S56=DUMMY2*DD56(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D6S
               S57=DUMMY2*DD57(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D7S
               S58=DUMMY2*DD58(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D8S
               S59=DUMMY2*DD59(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D9S
               S5A=DUMMY2*DD5A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DAS
               S5B=DUMMY2*DD5B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DBS
               S5C=DUMMY2*DD5C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DCS
               S66=DUMMY2*DD66(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D6S
               S67=DUMMY2*DD67(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D7S
               S68=DUMMY2*DD68(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D8S
               S69=DUMMY2*DD69(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D9S
               S6A=DUMMY2*DD6A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DAS
               S6B=DUMMY2*DD6B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DBS
               S6C=DUMMY2*DD6C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DCS
               S77=DUMMY2*DD77(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D7S
               S78=DUMMY2*DD78(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D8S
               S79=DUMMY2*DD79(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D9S
               S7A=DUMMY2*DD7A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DAS
               S7B=DUMMY2*DD7B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DBS
               S7C=DUMMY2*DD7C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DCS
               S88=DUMMY2*DD88(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*D8S
               S89=DUMMY2*DD89(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*D9S
               S8A=DUMMY2*DD8A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DAS
               S8B=DUMMY2*DD8B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DBS
               S8C=DUMMY2*DD8C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DCS
               S99=DUMMY2*DD99(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*D9S
               S9A=DUMMY2*DD9A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DAS
               S9B=DUMMY2*DD9B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DBS
               S9C=DUMMY2*DD9C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DCS
               SAA=DUMMY2*DDAA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DAS
               SAB=DUMMY2*DDAB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DBS
               SAC=DUMMY2*DDAC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DCS
               SBB=DUMMY2*DDBB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DBS*DBS
               SBC=DUMMY2*DDBC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DBS*DCS
               SCC=DUMMY2*DDCC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DCS*DCS
            ENDIF
C
C  SUM OVER MORSE SITES.
C
            DO K1=1,5
               P1X=SITE(K1,1)*RAD
               P1Y=SITE(K1,2)*RAD
               P1Z=SITE(K1,3)*RAD
               DO K2=1,5
                  P2X=SITE(K2,1)*RAD
                  P2Y=SITE(K2,2)*RAD
                  P2Z=SITE(K2,3)*RAD
                  DIST=
     1  SQRT((C2A1*P1X-C3A1*L1*(L1*P1X+M1*P1Y+N1*P1Z)-C2A2*P2X+C3A2*L2*(L2*P2X + M2*P2Y + N2*P2Z)+ 
     1      (N1*P1Y - M1*P1Z)*S1 - (N2*P2Y - M2*P2Z)*S2 + X1 - X2)**2 + 
     1   (C2A1*P1Y - C3A1*M1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Y+C3A2*M2*(L2*P2X+M2*P2Y+N2*P2Z)+ 
     1      (-(N1*P1X) + L1*P1Z)*S1 - (-(N2*P2X) + L2*P2Z)*S2 + Y1-Y2)**2 + 
     1   (C2A1*P1Z - C3A1*N1*(L1*P1X + M1*P1Y + N1*P1Z) - C2A2*P2Z+C3A2*N2*(L2*P2X+M2*P2Y+N2*P2Z)+ 
     1      (M1*P1X - L1*P1Y)*S1 - (M2*P2X - L2*P2Y)*S2 + Z1 - Z2)**2)
                  DUMMY=DUMMY+FATT(RHO,DIST)
                  DUMMY2=DFATT(RHO,DIST)
                  IF (GTEST) THEN
                     RDIST=1.0D0/DIST
                     GX1=GX1+DUMMY2*D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GY1=GY1+DUMMY2*D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GZ1=GZ1+DUMMY2*D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GL1=GL1+DUMMY2*D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GM1=GM1+DUMMY2*D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GN1=GN1+DUMMY2*D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GL2=GL2+DUMMY2*DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GM2=GM2+DUMMY2*DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     GN2=GN2+DUMMY2*DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                  ENDIF
                  IF (SECT) THEN
                     DUMMY2=DFATT(RHO,DIST)
                     DUMMY3=DDFATT(RHO,DIST)
                     RDIST=1.0D0/DIST
                     D1S=D1(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D2S=D2(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D3S=D3(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D4S=D4(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D5S=D5(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D6S=D6(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D7S=D7(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D8S=D8(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     D9S=D9(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     DAS=DA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     DBS=DB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)
                     DCS=DC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)

                     S11=S11+DUMMY2*DD11(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D1S
                     S12=S12+DUMMY2*DD12(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D2S
                     S13=S13+DUMMY2*DD13(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D3S
                     S14=S14+DUMMY2*DD14(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D4S
                     S15=S15+DUMMY2*DD15(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D5S
                     S16=S16+DUMMY2*DD16(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D6S
                     S17=S17+DUMMY2*DD17(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D7S
                     S18=S18+DUMMY2*DD18(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D8S
                     S19=S19+DUMMY2*DD19(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*D9S
                     S1A=S1A+DUMMY2*DD1A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DAS
                     S1B=S1B+DUMMY2*DD1B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DBS
                     S1C=S1C+DUMMY2*DD1C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D1S*DCS
                     S22=S22+DUMMY2*DD22(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D2S
                     S23=S23+DUMMY2*DD23(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D3S
                     S24=S24+DUMMY2*DD24(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D4S
                     S25=S25+DUMMY2*DD25(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D5S
                     S26=S26+DUMMY2*DD26(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D6S
                     S27=S27+DUMMY2*DD27(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D7S
                     S28=S28+DUMMY2*DD28(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D8S
                     S29=S29+DUMMY2*DD29(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*D9S
                     S2A=S2A+DUMMY2*DD2A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DAS
                     S2B=S2B+DUMMY2*DD2B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DBS
                     S2C=S2C+DUMMY2*DD2C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D2S*DCS
                     S33=S33+DUMMY2*DD33(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D3S
                     S34=S34+DUMMY2*DD34(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D4S
                     S35=S35+DUMMY2*DD35(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D5S
                     S36=S36+DUMMY2*DD36(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D6S
                     S37=S37+DUMMY2*DD37(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D7S
                     S38=S38+DUMMY2*DD38(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D8S
                     S39=S39+DUMMY2*DD39(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*D9S
                     S3A=S3A+DUMMY2*DD3A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DAS
                     S3B=S3B+DUMMY2*DD3B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DBS
                     S3C=S3C+DUMMY2*DD3C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D3S*DCS
                     S44=S44+DUMMY2*DD44(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D4S
                     S45=S45+DUMMY2*DD45(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D5S
                     S46=S46+DUMMY2*DD46(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D6S
                     S47=S47+DUMMY2*DD47(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D7S
                     S48=S48+DUMMY2*DD48(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D8S
                     S49=S49+DUMMY2*DD49(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*D9S
                     S4A=S4A+DUMMY2*DD4A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DAS
                     S4B=S4B+DUMMY2*DD4B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DBS
                     S4C=S4C+DUMMY2*DD4C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D4S*DCS
                     S55=S55+DUMMY2*DD55(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D5S
                     S56=S56+DUMMY2*DD56(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D6S
                     S57=S57+DUMMY2*DD57(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D7S
                     S58=S58+DUMMY2*DD58(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D8S
                     S59=S59+DUMMY2*DD59(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*D9S
                     S5A=S5A+DUMMY2*DD5A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DAS
                     S5B=S5B+DUMMY2*DD5B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DBS
                     S5C=S5C+DUMMY2*DD5C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D5S*DCS
                     S66=S66+DUMMY2*DD66(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D6S
                     S67=S67+DUMMY2*DD67(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D7S
                     S68=S68+DUMMY2*DD68(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D8S
                     S69=S69+DUMMY2*DD69(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*D9S
                     S6A=S6A+DUMMY2*DD6A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DAS
                     S6B=S6B+DUMMY2*DD6B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DBS
                     S6C=S6C+DUMMY2*DD6C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D6S*DCS
                     S77=S77+DUMMY2*DD77(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D7S
                     S78=S78+DUMMY2*DD78(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D8S
                     S79=S79+DUMMY2*DD79(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*D9S
                     S7A=S7A+DUMMY2*DD7A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DAS
                     S7B=S7B+DUMMY2*DD7B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DBS
                     S7C=S7C+DUMMY2*DD7C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D7S*DCS
                     S88=S88+DUMMY2*DD88(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*D8S
                     S89=S89+DUMMY2*DD89(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*D9S
                     S8A=S8A+DUMMY2*DD8A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DAS
                     S8B=S8B+DUMMY2*DD8B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DBS
                     S8C=S8C+DUMMY2*DD8C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D8S*DCS
                     S99=S99+DUMMY2*DD99(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*D9S
                     S9A=S9A+DUMMY2*DD9A(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DAS
                     S9B=S9B+DUMMY2*DD9B(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DBS
                     S9C=S9C+DUMMY2*DD9C(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*D9S*DCS
                     SAA=SAA+DUMMY2*DDAA(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DAS
                     SAB=SAB+DUMMY2*DDAB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DBS
                     SAC=SAC+DUMMY2*DDAC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DAS*DCS
                     SBB=SBB+DUMMY2*DDBB(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DBS*DBS
                     SBC=SBC+DUMMY2*DDBC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DBS*DCS
                     SCC=SCC+DUMMY2*DDCC(P1X,P1Y,P1Z,P2X,P2Y,P2Z,X1,Y1,Z1,N1,L1,M1,X2,Y2,Z2,L2,M2,N2,RDIST,
     1                  C2A2,RALPHA12,RALPHA22,C3A2,S2,C2A1,C3A1,S1,N12,L12,M12,L22,M22,N22)+DUMMY3*DCS*DCS
                  ENDIF 
               ENDDO
            ENDDO
   
            ECAPSID=ECAPSID+DUMMY

            IF (GTEST) THEN
               V(3*(J1-1)+1)=V(3*(J1-1)+1)+GX1
               V(3*(J1-1)+2)=V(3*(J1-1)+2)+GY1
               V(3*(J1-1)+3)=V(3*(J1-1)+3)+GZ1
               V(3*(NAT2+J1-1)+1)=V(3*(NAT2+J1-1)+1)+GL1
               V(3*(NAT2+J1-1)+2)=V(3*(NAT2+J1-1)+2)+GM1
               V(3*(NAT2+J1-1)+3)=V(3*(NAT2+J1-1)+3)+GN1
               V(3*(J2-1)+1)=V(3*(J2-1)+1)-GX1
               V(3*(J2-1)+2)=V(3*(J2-1)+2)-GY1
               V(3*(J2-1)+3)=V(3*(J2-1)+3)-GZ1
               V(3*(NAT2+J2-1)+1)=V(3*(NAT2+J2-1)+1)+GL2
               V(3*(NAT2+J2-1)+2)=V(3*(NAT2+J2-1)+2)+GM2
               V(3*(NAT2+J2-1)+3)=V(3*(NAT2+J2-1)+3)+GN2
            ENDIF
            IF (SECT) THEN
               HESS(3*(J1-1)+1,3*(J1-1)+1)=HESS(3*(J1-1)+1,3*(J1-1)+1)+S11
               HESS(3*(J1-1)+1,3*(J1-1)+2)=HESS(3*(J1-1)+1,3*(J1-1)+2)+S12
               HESS(3*(J1-1)+1,3*(J1-1)+3)=HESS(3*(J1-1)+1,3*(J1-1)+3)+S13
               HESS(3*(J1-1)+1,3*(NAT2+J1-1)+1)=HESS(3*(J1-1)+1,3*(NAT2+J1-1)+1)+S14
               HESS(3*(J1-1)+1,3*(NAT2+J1-1)+2)=HESS(3*(J1-1)+1,3*(NAT2+J1-1)+2)+S15
               HESS(3*(J1-1)+1,3*(NAT2+J1-1)+3)=HESS(3*(J1-1)+1,3*(NAT2+J1-1)+3)+S16
               HESS(3*(J1-1)+1,3*(J2-1)+1)=HESS(3*(J1-1)+1,3*(J2-1)+1)+S17
               HESS(3*(J1-1)+1,3*(J2-1)+2)=HESS(3*(J1-1)+1,3*(J2-1)+2)+S18
               HESS(3*(J1-1)+1,3*(J2-1)+3)=HESS(3*(J1-1)+1,3*(J2-1)+3)+S19
               HESS(3*(J1-1)+1,3*(NAT2+J2-1)+1)=HESS(3*(J1-1)+1,3*(NAT2+J2-1)+1)+S1A
               HESS(3*(J1-1)+1,3*(NAT2+J2-1)+2)=HESS(3*(J1-1)+1,3*(NAT2+J2-1)+2)+S1B
               HESS(3*(J1-1)+1,3*(NAT2+J2-1)+3)=HESS(3*(J1-1)+1,3*(NAT2+J2-1)+3)+S1C

               HESS(3*(J1-1)+2,3*(J1-1)+2)=HESS(3*(J1-1)+2,3*(J1-1)+2)+S22
               HESS(3*(J1-1)+2,3*(J1-1)+3)=HESS(3*(J1-1)+2,3*(J1-1)+3)+S23
               HESS(3*(J1-1)+2,3*(NAT2+J1-1)+1)=HESS(3*(J1-1)+2,3*(NAT2+J1-1)+1)+S24
               HESS(3*(J1-1)+2,3*(NAT2+J1-1)+2)=HESS(3*(J1-1)+2,3*(NAT2+J1-1)+2)+S25
               HESS(3*(J1-1)+2,3*(NAT2+J1-1)+3)=HESS(3*(J1-1)+2,3*(NAT2+J1-1)+3)+S26
               HESS(3*(J1-1)+2,3*(J2-1)+1)=HESS(3*(J1-1)+2,3*(J2-1)+1)+S27
               HESS(3*(J1-1)+2,3*(J2-1)+2)=HESS(3*(J1-1)+2,3*(J2-1)+2)+S28
               HESS(3*(J1-1)+2,3*(J2-1)+3)=HESS(3*(J1-1)+2,3*(J2-1)+3)+S29
               HESS(3*(J1-1)+2,3*(NAT2+J2-1)+1)=HESS(3*(J1-1)+2,3*(NAT2+J2-1)+1)+S2A
               HESS(3*(J1-1)+2,3*(NAT2+J2-1)+2)=HESS(3*(J1-1)+2,3*(NAT2+J2-1)+2)+S2B
               HESS(3*(J1-1)+2,3*(NAT2+J2-1)+3)=HESS(3*(J1-1)+2,3*(NAT2+J2-1)+3)+S2C

               HESS(3*(J1-1)+3,3*(J1-1)+3)=HESS(3*(J1-1)+3,3*(J1-1)+3)+S33
               HESS(3*(J1-1)+3,3*(NAT2+J1-1)+1)=HESS(3*(J1-1)+3,3*(NAT2+J1-1)+1)+S34
               HESS(3*(J1-1)+3,3*(NAT2+J1-1)+2)=HESS(3*(J1-1)+3,3*(NAT2+J1-1)+2)+S35
               HESS(3*(J1-1)+3,3*(NAT2+J1-1)+3)=HESS(3*(J1-1)+3,3*(NAT2+J1-1)+3)+S36
               HESS(3*(J1-1)+3,3*(J2-1)+1)=HESS(3*(J1-1)+3,3*(J2-1)+1)+S37
               HESS(3*(J1-1)+3,3*(J2-1)+2)=HESS(3*(J1-1)+3,3*(J2-1)+2)+S38
               HESS(3*(J1-1)+3,3*(J2-1)+3)=HESS(3*(J1-1)+3,3*(J2-1)+3)+S39
               HESS(3*(J1-1)+3,3*(NAT2+J2-1)+1)=HESS(3*(J1-1)+3,3*(NAT2+J2-1)+1)+S3A
               HESS(3*(J1-1)+3,3*(NAT2+J2-1)+2)=HESS(3*(J1-1)+3,3*(NAT2+J2-1)+2)+S3B
               HESS(3*(J1-1)+3,3*(NAT2+J2-1)+3)=HESS(3*(J1-1)+3,3*(NAT2+J2-1)+3)+S3C

               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+1)+S44
               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+2)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+2)+S45
               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J1-1)+3)+S46
               HESS(3*(NAT2+J1-1)+1,3*(J2-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+1)+S47
               HESS(3*(NAT2+J1-1)+1,3*(J2-1)+2)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+2)+S48
               HESS(3*(NAT2+J1-1)+1,3*(J2-1)+3)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+3)+S49
               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+1)+S4A
               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+2)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+2)+S4B
               HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J1-1)+1,3*(NAT2+J2-1)+3)+S4C

               HESS(3*(NAT2+J1-1)+2,3*(NAT2+J1-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(NAT2+J1-1)+2)+S55
               HESS(3*(NAT2+J1-1)+2,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+2,3*(NAT2+J1-1)+3)+S56
               HESS(3*(NAT2+J1-1)+2,3*(J2-1)+1)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+1)+S57
               HESS(3*(NAT2+J1-1)+2,3*(J2-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+2)+S58
               HESS(3*(NAT2+J1-1)+2,3*(J2-1)+3)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+3)+S59
               HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+1)=HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+1)+S5A
               HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+2)+S5B
               HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J1-1)+2,3*(NAT2+J2-1)+3)+S5C

               HESS(3*(NAT2+J1-1)+3,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(NAT2+J1-1)+3)+S66
               HESS(3*(NAT2+J1-1)+3,3*(J2-1)+1)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+1)+S67
               HESS(3*(NAT2+J1-1)+3,3*(J2-1)+2)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+2)+S68
               HESS(3*(NAT2+J1-1)+3,3*(J2-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+3)+S69
               HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+1)=HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+1)+S6A
               HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+2)=HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+2)+S6B
               HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(NAT2+J2-1)+3)+S6C

               HESS(3*(J2-1)+1,3*(J2-1)+1)=HESS(3*(J2-1)+1,3*(J2-1)+1)+S77
               HESS(3*(J2-1)+1,3*(J2-1)+2)=HESS(3*(J2-1)+1,3*(J2-1)+2)+S78
               HESS(3*(J2-1)+1,3*(J2-1)+3)=HESS(3*(J2-1)+1,3*(J2-1)+3)+S79
               HESS(3*(J2-1)+1,3*(NAT2+J2-1)+1)=HESS(3*(J2-1)+1,3*(NAT2+J2-1)+1)+S7A
               HESS(3*(J2-1)+1,3*(NAT2+J2-1)+2)=HESS(3*(J2-1)+1,3*(NAT2+J2-1)+2)+S7B
               HESS(3*(J2-1)+1,3*(NAT2+J2-1)+3)=HESS(3*(J2-1)+1,3*(NAT2+J2-1)+3)+S7C

               HESS(3*(J2-1)+2,3*(J2-1)+2)=HESS(3*(J2-1)+2,3*(J2-1)+2)+S88
               HESS(3*(J2-1)+2,3*(J2-1)+3)=HESS(3*(J2-1)+2,3*(J2-1)+3)+S89
               HESS(3*(J2-1)+2,3*(NAT2+J2-1)+1)=HESS(3*(J2-1)+2,3*(NAT2+J2-1)+1)+S8A
               HESS(3*(J2-1)+2,3*(NAT2+J2-1)+2)=HESS(3*(J2-1)+2,3*(NAT2+J2-1)+2)+S8B
               HESS(3*(J2-1)+2,3*(NAT2+J2-1)+3)=HESS(3*(J2-1)+2,3*(NAT2+J2-1)+3)+S8C

               HESS(3*(J2-1)+3,3*(J2-1)+3)=HESS(3*(J2-1)+3,3*(J2-1)+3)+S99
               HESS(3*(J2-1)+3,3*(NAT2+J2-1)+1)=HESS(3*(J2-1)+3,3*(NAT2+J2-1)+1)+S9A
               HESS(3*(J2-1)+3,3*(NAT2+J2-1)+2)=HESS(3*(J2-1)+3,3*(NAT2+J2-1)+2)+S9B
               HESS(3*(J2-1)+3,3*(NAT2+J2-1)+3)=HESS(3*(J2-1)+3,3*(NAT2+J2-1)+3)+S9C

               HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+1)=HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+1)+SAA
               HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+2)=HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+2)+SAB
               HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J2-1)+1,3*(NAT2+J2-1)+3)+SAC

               HESS(3*(NAT2+J2-1)+2,3*(NAT2+J2-1)+2)=HESS(3*(NAT2+J2-1)+2,3*(NAT2+J2-1)+2)+SBB
               HESS(3*(NAT2+J2-1)+2,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J2-1)+2,3*(NAT2+J2-1)+3)+SBC

               HESS(3*(NAT2+J2-1)+3,3*(NAT2+J2-1)+3)=HESS(3*(NAT2+J2-1)+3,3*(NAT2+J2-1)+3)+SCC
            ENDIF
         ENDDO
      ENDDO

      IF (SECT) THEN
         DO J1=1,NATOMS/2
            DO J2=J1+1,NATOMS/2
               HESS(3*(J2-1)+1,3*(NAT2+J1-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+1)
               HESS(3*(J2-1)+2,3*(NAT2+J1-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+2)
               HESS(3*(J2-1)+3,3*(NAT2+J1-1)+1)=HESS(3*(NAT2+J1-1)+1,3*(J2-1)+3)
               HESS(3*(J2-1)+1,3*(NAT2+J1-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+1)
               HESS(3*(J2-1)+2,3*(NAT2+J1-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+2)
               HESS(3*(J2-1)+3,3*(NAT2+J1-1)+2)=HESS(3*(NAT2+J1-1)+2,3*(J2-1)+3)
               HESS(3*(J2-1)+1,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+1)
               HESS(3*(J2-1)+2,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+2)
               HESS(3*(J2-1)+3,3*(NAT2+J1-1)+3)=HESS(3*(NAT2+J1-1)+3,3*(J2-1)+3)
            ENDDO
         ENDDO
         DO J1=1,3*NATOMS
            DO J2=J1+1,3*NATOMS
               HESS(J2,J1)=HESS(J1,J2)
            ENDDO
         ENDDO
      ENDIF

C     WRITE(*,'(A,G20.10)') 'ENERGY=',ECAPSID
C     PRINT*,'COORDS:'
C     WRITE(*,'(I6,G20.10)') (J1,X(J1),J1=1,3*NATOMS)
C     PRINT*,'GRADIENT:'
C     WRITE(*,'(I6,G20.10)') (J1,V(J1),J1=1,3*NATOMS)
C     WRITE(*,'(A,2G20.10)') 'ALPHA1,ALPHA2=',ALPHA1,ALPHA2

      RETURN
      END
