!   NEB MODULE IS AN IMPLEMENTATION OF THE NUDGED ELASTIC BAND METHOD FOR PERFORMING DOUBLE-ENDED PATHWAY SEARCHES.
!   COPYRIGHT (C) 2003-2006 SEMEN A. TRYGUBENKO AND DAVID J. WALES
!   THIS FILE IS PART OF NEB MODULE. NEB MODULE IS PART OF OPTIM.
!
!   OPTIM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
!   IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
!   THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
!   (AT YOUR OPTION) ANY LATER VERSION.
!
!   OPTIM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL,
!   BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
!   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.  SEE THE
!   GNU GENERAL PUBLIC LICENSE FOR MORE DETAILS.
!
!   YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
!   ALONG WITH THIS PROGRAM; IF NOT, WRITE TO THE FREE SOFTWARE
!   FOUNDATION, INC., 59 TEMPLE PLACE, SUITE 330, BOSTON, MA  02111-1307  USA
!
MODULE CHARUTILS
     IMPLICIT NONE
     SAVE
     INTEGER,PARAMETER :: INTSTRLENGTH=10,REALSTRLENGTH=20
     CHARACTER(LEN=INTSTRLENGTH) :: INTSTR,INTSTR2
     CHARACTER(LEN=REALSTRLENGTH) :: REALSTR,REALSTR2
     CONTAINS

     FUNCTION WI(I)
          IMPLICIT NONE
          INTEGER,INTENT(IN) :: I
          CHARACTER(LEN=INTSTRLENGTH) :: WI
          
          CHARACTER(LEN=INTSTRLENGTH) :: STR

          WRITE(STR,'(I10)') I
          WI = ADJUSTL(STR)
     END FUNCTION WI

     FUNCTION WR(R,D)
          IMPLICIT NONE

          INTEGER,INTENT(IN) :: D !NUMBER OF DIGITS AFTER POINT TO WRITE; RANGE 1-9.
          DOUBLE PRECISION,INTENT(IN) :: R

          INTEGER :: I
          CHARACTER(LEN=REALSTRLENGTH) :: WR

          CHARACTER(LEN=REALSTRLENGTH) :: STR,FORMT
          WRITE(FORMT,'(A5,I1,A1)') '(F20.',D,')'
          WRITE(STR,FORMT) R
          WR = ADJUSTL(STR)
          IF (D==0) THEN
               DO I=20,1,-1
                    IF (WR(I:I)==".") THEN
                         WR(I:I)=" "; EXIT
                    ENDIF
               ENDDO
          ENDIF
     END FUNCTION WR

     FUNCTION RM0S(STR)
          IMPLICIT NONE

          CHARACTER(LEN=REALSTRLENGTH) :: STR,RM0S

          INTEGER :: I

          RM0S=ADJUSTR(STR)

          DO I=REALSTRLENGTH,2,-1
               IF (.NOT.RM0S(I:I)=="0") THEN
                    EXIT
               ENDIF
          ENDDO
          
          RM0S=ADJUSTL(RM0S(1:I))
     END FUNCTION RM0S
END MODULE CHARUTILS
